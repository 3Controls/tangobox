

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Running a device server without SQL database &mdash; Tango Controls 9.2.5 documentation</title>
  

  
  
    <link rel="shortcut icon" href="../../_static/favicon.png"/>
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="../../genindex.html"/>
        <link rel="search" title="Search" href="../../search.html"/>
    <link rel="top" title="Tango Controls 9.2.5 documentation" href="../../index.html"/>
        <link rel="up" title="Deployment" href="index.html"/>
        <link rel="next" title="The property file syntax" href="property-file.html"/>
        <link rel="prev" title="Starting a Tango control system" href="starting.html"/> 

  
  <script src="../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../contents.html" class="icon icon-home"> Tango Controls
          

          
            
            <img src="../../_static/logo_tangocontrols_white.png" class="logo" />
          
          </a>

          
            
            
              <div class="version">
                9.2
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../index.html">Welcome to Tango Controls documentation!</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../authors.html">Authors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../overview/index.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../installation/index.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../getting-started/index.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../development/index.html">Developer’s Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tools-and-extensions/index.html">Tools and Extensions</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Administration</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../overview.html">Overview</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html">Deployment</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="starting.html">Starting a Tango control system</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Running a device server without SQL database</a></li>
<li class="toctree-l3"><a class="reference internal" href="property-file.html">The property file syntax</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../services/index.html">Services</a></li>
<li class="toctree-l2"><a class="reference internal" href="../maintenance/index.html">Maintenance</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials-and-howtos/index.html">Tutorials and How-Tos</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../reference/index.html">Reference</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../contents.html">Tango Controls</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../contents.html">Docs</a> &raquo;</li>
        
          <li><a href="../index.html">Administration</a> &raquo;</li>
        
          <li><a href="index.html">Deployment</a> &raquo;</li>
        
      <li>Running a device server without SQL database</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/administration/deployment/without-sql-db.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="running-a-device-server-without-sql-database">
<span id="without-sql-db"></span><h1>Running a device server without SQL database<a class="headerlink" href="#running-a-device-server-without-sql-database" title="Permalink to this headline">¶</a></h1>
<div class="section" id="device-server-using-file-as-database">
<h2>Device server using file as database<a class="headerlink" href="#device-server-using-file-as-database" title="Permalink to this headline">¶</a></h2>
<p>For device servers not able to access the Tango database (most of the
time due to network route or security reason), it is possible to start
them using file instead of a real database. This is done via the device
server</p>
<p>-file=&lt;file name&gt;</p>
<p>command line option. In this case,</p>
<ul class="simple">
<li>Getting, setting and deleting class properties</li>
<li>Getting, setting and deleting device properties</li>
<li>Getting, setting and deleting class attribute properties</li>
<li>Getting, setting and deleting device attribute properties</li>
</ul>
<p>are handled using the specified file instead of the Tango database. The
file is an ASCII file and follows a well-defined syntax with predefined
keywords. The simplest way to generate the file for a specific device
server is to use the Jive application. See <a class="reference internal" href="../../reference/bibliography.html#jive" id="id1">[Jive]</a>
to get Jive documentation. The Tango database is not only used to store
device configuration parameters, it is also used to store device network
access parameter (the CORBA IOR). To allow an application to connect to
a device hosted by a device server using file instead of database, you
need to start it on a pre-defined port, and you must use one of the
underlying ORB option called <em>endPoint</em> like</p>
<p>myserver myinstance_name -file=/tmp/MyServerFile -ORBendPoint
giop:tcp::&lt;port number&gt;</p>
<p>to start your device server. The device name passed to the client
application must also be modified in order to refect the non-database
usage. See [DeviceNaming] to learn about Tango device name syntax.
Nevertheless, using this Tango feature prevents some other features to
be used :</p>
<ul class="simple">
<li>No check that the same device server is running twice.</li>
<li>No device or attribute alias name.</li>
<li>In case of several device servers running on the same host, the user
must manually manage a list of already used network port.</li>
</ul>
</div>
<div class="section" id="device-server-without-database">
<h2>Device server without database<a class="headerlink" href="#device-server-without-database" title="Permalink to this headline">¶</a></h2>
<p>In some very specific cases (Running a device server within a lab during
hardware development…), it could be very useful to have a device
server able to run even if there is no database in the control system.
Obviously, running a Tango device server without a database means
loosing Tango features. The lost features are :</p>
<ul class="simple">
<li>No check that the same device server is running twice.</li>
<li>No device configuration via properties.</li>
<li>No event generated by the server.</li>
<li>No memorized attributes</li>
<li>No device attribute configuration via the database.</li>
<li>No check that the same device name is used twice within the same
control system.</li>
<li>In case of several device servers running on the same host, the user
must manually manage a list of already used network port.</li>
</ul>
<p>To run a device server without a database, the <strong>-nodb</strong> command line
option must be used. One problem when running a device server without
the database is to pass device name(s) to the device server. Within
Tango, it is possible to define these device names at two different
levels :</p>
<ol class="arabic simple">
<li>At the command line with the <strong>-dlist</strong> option: In case of device
server with several device pattern implementation, the device name
list given at command line is only for the last device pattern
created in the <em>class_factory()</em> method. In the device name list,
the device name separator is the comma character.</li>
<li>At the device pattern implementation level: In the class inherited
from the Tango::DeviceClass class via the re-definition of a well
defined method called <em>device_name_factory()</em></li>
</ol>
<p>If none of these two possibilities is used, the tango core classes
defined one default device name for each device pattern implementation.
This default device name is <em>NoName</em>. Device definition at the command
line has the highest priority.</p>
<div class="section" id="example-of-device-server-started-without-database-usage">
<h3>Example of device server started without database usage<a class="headerlink" href="#example-of-device-server-started-without-database-usage" title="Permalink to this headline">¶</a></h3>
<p>Without database, you need to start a Tango device server on a
pre-defined port, and you must use one of the underlying ORB option
called <em>endPoint</em> like</p>
<p><strong class="command">myserver myinstance_name -ORBendPoint giop:tcp::&lt;port number&gt; -nodb
-dlist a/b/c</strong></p>
<p>The following is two examples of starting a device server not using the
database when the <em>device_name_factory()</em> method is not re-defined.</p>
<ul>
<li><div class="first line-block">
<div class="line">StepperMotor et -nodb -dlist id11/motor/1,id11/motor/2</div>
<div class="line">This command line starts the device server with two devices named
<em>id11/motor/1</em> and <em>id11/motor/2</em></div>
</div>
</li>
<li><div class="first line-block">
<div class="line">StepperMotor et -nodb</div>
<div class="line">This command line starts a device server with one device named
<em>NoName</em></div>
</div>
</li>
</ul>
<p>When the <em>device_name_factory()</em> method is re-defined within the
StepperMotorClass class.</p>
<pre class="code cpp literal-block">
<span class="ln">1 </span>  <span class="keyword type">void</span> <span class="name">StepperMotorClass</span><span class="operator">::</span><span class="name">device_name_factory</span><span class="punctuation">(</span><span class="name">vector</span><span class="operator">&lt;</span><span class="name">string</span><span class="operator">&gt;</span> <span class="operator">&amp;</span><span class="name">list</span><span class="punctuation">)</span>
<span class="ln">2 </span>  <span class="punctuation">{</span>
<span class="ln">3 </span>      <span class="name">list</span><span class="punctuation">.</span><span class="name">push_back</span><span class="punctuation">(</span><span class="literal string">&quot;sr/cav-tuner/1&quot;</span><span class="punctuation">);</span>
<span class="ln">4 </span>      <span class="name">list</span><span class="punctuation">.</span><span class="name">push_back</span><span class="punctuation">(</span><span class="literal string">&quot;sr/cav-tuner/2&quot;</span><span class="punctuation">);</span>
<span class="ln">5 </span>  <span class="punctuation">}</span>
</pre>
<ul>
<li><div class="first line-block">
<div class="line">StepperMotor et -nodb</div>
<div class="line">This commands starts a device server with two devices named
<em>sr/cav-tuner/1</em> and <em>sr/cav-tuner/2</em>.</div>
</div>
</li>
<li><div class="first line-block">
<div class="line">StepperMotor et -nodb -dlist id12/motor/1</div>
<div class="line">Starts a device server with only one device named id12/motor/1</div>
</div>
</li>
</ul>
</div>
<div class="section" id="connecting-client-to-device-within-a-device-server-started-without-database">
<h3>Connecting client to device within a device server started without database<a class="headerlink" href="#connecting-client-to-device-within-a-device-server-started-without-database" title="Permalink to this headline">¶</a></h3>
<p>In this case, the host and port on which the device server is running
are part of the device name. If the device name is <em>a/b/c</em>, the host is
<em>mycomputer</em> and the port <em>1234</em>, the device name to be used by client
is</p>
<p>mycomputer:1234/a/b/c#dbase=no</p>
<p>See appendix [DeviceNaming] for all details about Tango object naming.</p>
</div>
</div>
<div class="section" id="multiple-database-servers-within-a-tango-control-system">
<h2>Multiple database servers within a Tango control system<a class="headerlink" href="#multiple-database-servers-within-a-tango-control-system" title="Permalink to this headline">¶</a></h2>
<p>Tango uses MySQL as database and allows access to this database via a
specific Tango device server. It is possible for the same Tango control
system to have several Tango database servers. The host name and port
number of the database server is known via the TANGO_HOST environment
variable. If you want to start several database servers in order to
prevent server crash, use the following TANGO_HOST syntax</p>
<p>TANGO_HOST=&lt;host_1&gt;:&lt;port_1&gt;,&lt;host_2&gt;:&lt;port_2&gt;,&lt;host_3&gt;:&lt;port_3&gt;</p>
<p>All calls to the database server will automatically switch to a running
servers in the given list if the one used dies.</p>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="property-file.html" class="btn btn-neutral float-right" title="The property file syntax" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="starting.html" class="btn btn-neutral" title="Starting a Tango control system" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, Tango Community, Creative Commons Attribution 4.0 International (CC BY 4.0).

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../',
            VERSION:'9.2.5',
            LANGUAGE:'en',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>
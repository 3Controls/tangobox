

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>The Tango controlled access system &mdash; Tango Controls 9.2.5 documentation</title>
  

  
  
    <link rel="shortcut icon" href="../../_static/favicon.png"/>
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="../../genindex.html"/>
        <link rel="search" title="Search" href="../../search.html"/>
    <link rel="top" title="Tango Controls 9.2.5 documentation" href="../../index.html"/>
        <link rel="up" title="Services" href="index.html"/>
        <link rel="next" title="HDB++ - an archiving/historian service" href="hdbpp/index.html"/>
        <link rel="prev" title="The notifd2db utility" href="notifd2db.html"/> 

  
  <script src="../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../contents.html" class="icon icon-home"> Tango Controls
          

          
            
            <img src="../../_static/logo_tangocontrols_white.png" class="logo" />
          
          </a>

          
            
            
              <div class="version">
                9.2
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../index.html">Welcome to Tango Controls documentation!</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../authors.html">Authors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../overview/index.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../installation/index.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../getting-started/index.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../development/index.html">Developer’s Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tools-and-extensions/index.html">Tools and Extensions</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Administration</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../overview.html">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../deployment/index.html">Deployment</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html">Services</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="events.html">Event system</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">The Tango controlled access system</a></li>
<li class="toctree-l3"><a class="reference internal" href="hdbpp/index.html">HDB++ - an archiving/historian service</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../maintenance/index.html">Maintenance</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials-and-howtos/index.html">Tutorials and How-Tos</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../reference/index.html">Reference</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../contents.html">Tango Controls</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../contents.html">Docs</a> &raquo;</li>
        
          <li><a href="../index.html">Administration</a> &raquo;</li>
        
          <li><a href="index.html">Services</a> &raquo;</li>
        
      <li>The Tango controlled access system</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/administration/services/access-control.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="the-tango-controlled-access-system">
<span id="access-control"></span><h1>The Tango controlled access system<a class="headerlink" href="#the-tango-controlled-access-system" title="Permalink to this headline">¶</a></h1>
<div class="section" id="user-rights-definition">
<h2>User rights definition<a class="headerlink" href="#user-rights-definition" title="Permalink to this headline">¶</a></h2>
<p>Within the Tango controlled system, you give rights to a user. User is
the name of the user used to log-in the computer where the application
trying to access a device is running. Two kind of users are defined:</p>
<ol class="arabic simple">
<li>Users with defined rights</li>
<li>Users without any rights defined in the controlled system. These
users will have the rights associated with the pseudo-user called All
Users</li>
</ol>
<p>The controlled system manages two kind of rights:</p>
<ul class="simple">
<li>Write access meaning that all type of requests are allowed on the
device</li>
<li>Read access meaning that only read-like access are allowed
(write_attribute, write_read_attribute and set_attribute_config
network calls are forbidden). Executing a command is also forbidden
except for commands defined as <strong>Allowed commands</strong>. Getting a device
state or status using the command_inout call is always allowed. The
definition of the allowed commands is done at the device class level.
Therefore, all devices belonging to the same class will have the
allowed commands set.</li>
</ul>
<p>The rights given to a user is the check result splitted in two levels:</p>
<ol class="arabic simple">
<li>At the host level: You define from which hosts the user may have
write access to the control system by specifying the host name. If
the request comes from a host which is not defined, the right will be
Read access. If nothing is defined at this level for the user, the
rights of the All Users user will be used. It is also possible to
specify the host by its IP address. You can define a host family
using wide-card in the IP address (eg. 160.103.11.* meaning any host
with IP address starting with 160.103.11). Only IP V4 is supported.</li>
<li>At the device level: You define on which device(s) request are
allowed using device name. Device family can be used using widecard
in device name like domin/family/*</li>
</ol>
<p>Therefore, the controlled system is doing the following checks when a
client try to access a device:</p>
<ul class="simple">
<li>Get the user name</li>
<li>Get the host IP address</li>
<li>If rights defined at host level for this specific user and this IP
address, gives user temporary write acccess to the control system</li>
<li>If nothing is specified for this specific user on this host, gives to
the user a temporary access right equal to the host access rights of
the All User user.</li>
<li>If the temporary right given to the user is write access to the
control system<ul>
<li>If something defined at device level for this specific user<ul>
<li>If there is a right defined for the device to be accessed (or
for the device family), give user the defined right</li>
<li>Else<ul>
<li>If rights defined for the All Users user for this device,
give this right to the user</li>
<li>Else, give user the Read Access for this device</li>
</ul>
</li>
</ul>
</li>
<li>Else<ul>
<li>If there is a right defined for the device to be accessed (or
for the device family) for the All User user, give user this
right</li>
<li>Else, give user the Read Access right for this device</li>
</ul>
</li>
</ul>
</li>
<li>Else, access right will be Read Access</li>
</ul>
<p>Then, when the client tries to access the device, the following
algorithm is used:</p>
<ul class="simple">
<li>If right is Read Access<ul>
<li>If the call is a write type call, refuse the call</li>
<li>If the call is a command execution<ul>
<li>If the command is one of the command defined in the Allowed
commands for the device class, send the call</li>
<li>Else, refuse the call</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>All these checks are done during the DeviceProxy instance constructor
except those related to the device class allowed commands which are
checked during the command_inout call.</p>
<p>To simplify the rights management, give the All Users user host access
right to all hosts (.*.*.*) and read access to all devices (/*/*).
With such a set-up for this user, each new user without any rights
defined in the controlled access will have only Read Access to all
devices on the control system but from any hosts. Then, on request,
gives Write Access to specific user on specific host (or family) and on
specific device (or family).</p>
<p>The rights managements are done using the Tango
Astor <a class="reference internal" href="../../reference/bibliography.html#astor" id="id1">[ASTOR]</a> tool which has some graphical windows
allowing to grant/revoke user rights and to define device class allowed
commands set. The following window dump shows this Astor window.</p>
<p><img alt="image21" src="../../_images/control.png" /></p>
<p>In this example, the user taurel has Write Access to the device
sr/d-ct/1 and to all devices belonging to the domain fe but only from
the host pcantares He has read access to all other devices but always
only from the host pcantares. The user verdier has write access to the
device sys/dev/01 from any host on the network 160.103.5 and Read Access
to all the remaining devices from the same network. All the other users
has only Read Access but from any host.</p>
</div>
<div class="section" id="running-a-tango-control-system-with-the-controlled-access">
<h2>Running a Tango control system with the controlled access<a class="headerlink" href="#running-a-tango-control-system-with-the-controlled-access" title="Permalink to this headline">¶</a></h2>
<p>All the users rights are stored in two tables of the Tango database. A
dedicated device server called <strong>TangoAccessControl</strong> access these
tables without using the classical Tango database server. This
TangoAccessControl device server must be configured with only one
device. The property <strong>Services</strong> belonging to the free object
<strong>CtrlSystem</strong> is used to run a Tango control system with its controlled
access. This property is an array of string with each string describing
the service(s) running in the control system. For controlled access, the
service name is AccessControl. The service instance name has to be
defined as tango. The device name associated with this service must be
the name of the TangoAccessControl server device. For instance, if the
TangoAccessControl device server device is named
<em>sys/access_control/1</em>, one element of the Services property of the
CtrlSystem object has to be set to</p>
<p>AccessControl/tango:sys/access_control/1</p>
<p>If the service is defined but without a valid device name corresponding
to the TangoAccessControl device server, all users from any host will
have write access (simulating a Tango control system without controlled
access). Note that this device server connects to the MySQL database and
therefore may need the MySQL connection related environment variables
MYSQL_USER and MYSQL_PASSWORD described in [sub:Db-Env-Variables]</p>
<p>Even if a controlled access system is running, it is possible to by-pass
it if, in the environment of the client application, the environment
variable SUPER_TANGO is defined to true. If for one reason or another,
the controlled access server is defined but not accessible, the device
right checked at that time will be Read Access.</p>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="hdbpp/index.html" class="btn btn-neutral float-right" title="HDB++ - an archiving/historian service" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="notifd2db.html" class="btn btn-neutral" title="The notifd2db utility" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, Tango Community, Creative Commons Attribution 4.0 International (CC BY 4.0).

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../',
            VERSION:'9.2.5',
            LANGUAGE:'en',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>
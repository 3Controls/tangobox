

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Writing a TANGO client using TANGO C++ APIs &mdash; Tango Controls 9.2.5 documentation</title>
  

  
  
    <link rel="shortcut icon" href="../../_static/favicon.png"/>
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="../../genindex.html"/>
        <link rel="search" title="Search" href="../../search.html"/>
    <link rel="top" title="Tango Controls 9.2.5 documentation" href="../../index.html"/>
        <link rel="up" title="Tango Client" href="index.html"/>
        <link rel="next" title="TangoATK Programmer’s Guide" href="atk-programmers-guide.html"/>
        <link rel="prev" title="Tango Client" href="index.html"/> 

  
  <script src="../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../contents.html" class="icon icon-home"> Tango Controls
          

          
            
            <img src="../../_static/logo_tangocontrols_white.png" class="logo" />
          
          </a>

          
            
            
              <div class="version">
                9.2
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../index.html">Welcome to Tango Controls documentation!</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../authors.html">Authors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../overview/index.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../installation/index.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../getting-started/index.html">Getting Started</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Developer’s Guide</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../overview.html">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../general-guidelines/index.html">General guidelines</a></li>
<li class="toctree-l2"><a class="reference internal" href="../corba.html">10 things you should know about CORBA</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html">Tango Client</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">Writing a TANGO client using TANGO C++ APIs</a></li>
<li class="toctree-l3"><a class="reference internal" href="atk-programmers-guide.html">TangoATK Programmer’s Guide</a></li>
<li class="toctree-l3"><a class="reference internal" href="../device-api/python/index.html">PyTango - a Python binding to Tango</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../device-api/index.html">Device Servers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../debugging-and-testing/index.html">Debugging and Testing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../advanced/index.html">Advanced</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cpp-api/index.html">Tango Core C++ Classes Reference Documentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../contributing/index.html">Contributing</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../tools-and-extensions/index.html">Tools and Extensions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../administration/index.html">Administration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials-and-howtos/index.html">Tutorials and How-Tos</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../reference/index.html">Reference</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../contents.html">Tango Controls</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../contents.html">Docs</a> &raquo;</li>
        
          <li><a href="../index.html">Developer’s Guide</a> &raquo;</li>
        
          <li><a href="index.html">Tango Client</a> &raquo;</li>
        
      <li>Writing a TANGO client using TANGO C++ APIs</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/development/client-api/cpp-client-programmers-guide.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="writing-a-tango-client-using-tango-c-apis">
<span id="cpp-client-programmers-guide"></span><h1>Writing a TANGO client using TANGO C++ APIs<a class="headerlink" href="#writing-a-tango-client-using-tango-c-apis" title="Permalink to this headline">¶</a></h1>
<div class="section" id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>TANGO devices and database are implemented using the TANGO device server
model. To access them the user has the CORBA interface e.g.
command_inout(), write_attributes() etc. defined by the idl file.
These methods are very low-level and assume a good working knowledge of
CORBA. In order to simplify this access, high-level api has been
implemented which hides all CORBA aspects of TANGO. In addition the api
hides details like how to connect to a device via the database, how to
reconnect after a device has been restarted, how to correctly pack and
unpack attributes and so on by implementing these in a manner
transparent to the user. The api provides a unified error handling for
all TANGO and CORBA errors. Unlike the CORBA C++ bindings the TANGO api
supports native C++ data types e.g. strings and vectors.</p>
<p>This chapter describes how to use these API’s. It is not a reference
guide. Reference documentation is available as Web pages in the <a class="reference external" href="http://www.tango-controls.org">TANGO home page</a></p>
</div>
<div class="section" id="getting-started">
<h2>Getting Started<a class="headerlink" href="#getting-started" title="Permalink to this headline">¶</a></h2>
<p>Refer to the chapter Getting Started for an example on getting start
with the C++ or Java api.</p>
</div>
<div class="section" id="basic-philosophy">
<h2>Basic Philosophy<a class="headerlink" href="#basic-philosophy" title="Permalink to this headline">¶</a></h2>
<p>The basic philosophy is to have high level classes to deal with Tango
devices. To communicate with Tango device, uses the <strong>DeviceProxy</strong>
class. To send/receive data to/from Tango device, uses the <strong>DeviceData,
DeviceAttribute</strong> or <strong>DevicePipe</strong> classes. To communicate with a group
of devices, use the <strong>Group</strong> class. If you are interested only in some
attributes provided by a Tango device, uses the <strong>AttributeProxy</strong>
class. Even if the Tango database is implemented as any other devices
(and therefore accessible with one instance of a DeviceProxy class),
specific high level classes have been developped to query it. Uses the
<strong>Database</strong>, <strong>DbDevice</strong>, <strong>DbClass</strong>, <strong>DbServer</strong> or <strong>DbData</strong>
classes when interfacing the Tango database. Callback for asynchronous
requests or events are implemented via a <strong>CallBack</strong> class. An utility
class called <strong>ApiUtil</strong> is also available.</p>
</div>
<div class="section" id="data-types">
<h2>Data types<a class="headerlink" href="#data-types" title="Permalink to this headline">¶</a></h2>
<p>The definition of the basic data type you can transfert using Tango is:</p>
<table border="1" class="docutils">
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Tango type name</th>
<th class="head">C++ equivalent type</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>DevBoolean</td>
<td><code class="docutils literal"><span class="pre">boolean</span></code></td>
</tr>
<tr class="row-odd"><td>DevShort</td>
<td><code class="docutils literal"><span class="pre">short</span></code></td>
</tr>
<tr class="row-even"><td>DevEnum</td>
<td>enumeration (only for attribute / See chapter on advanced
features)</td>
</tr>
<tr class="row-odd"><td>DevLong</td>
<td><code class="docutils literal"><span class="pre">int</span></code> (always 32 bits data)</td>
</tr>
<tr class="row-even"><td>DevLong64</td>
<td><code class="docutils literal"><span class="pre">long</span> <span class="pre">long</span></code> on 32 bits chip or <code class="docutils literal"><span class="pre">long</span></code> on 64 bits chip
(always 64 bits data)</td>
</tr>
<tr class="row-odd"><td>DevFloat</td>
<td><code class="docutils literal"><span class="pre">float</span></code></td>
</tr>
<tr class="row-even"><td>DevDouble</td>
<td><code class="docutils literal"><span class="pre">double</span></code></td>
</tr>
<tr class="row-odd"><td>DevString</td>
<td><code class="docutils literal"><span class="pre">char</span> <span class="pre">\*</span></code></td>
</tr>
<tr class="row-even"><td>DevEncoded</td>
<td><code class="docutils literal"><span class="pre">structure</span></code> with 2 fields: a string and an array of unsigned char</td>
</tr>
<tr class="row-odd"><td>DevUChar</td>
<td><code class="docutils literal"><span class="pre">unsigned</span> <span class="pre">char</span></code></td>
</tr>
<tr class="row-even"><td>DevUShort</td>
<td><code class="docutils literal"><span class="pre">unsigned</span> <span class="pre">short</span></code></td>
</tr>
<tr class="row-odd"><td>DevULong</td>
<td><code class="docutils literal"><span class="pre">unsigned</span> <span class="pre">int</span></code> (always 32 bits data)</td>
</tr>
<tr class="row-even"><td>DevULong64</td>
<td><code class="docutils literal"><span class="pre">unsigned</span> <span class="pre">long</span> <span class="pre">long</span></code> on 32 bits chip or <code class="docutils literal"><span class="pre">unsigned</span> <span class="pre">long</span></code> on 64
bits chip (always 64 bits data)</td>
</tr>
<tr class="row-odd"><td>DevState</td>
<td>Tango specific data type</td>
</tr>
</tbody>
</table>
<p>Using commands, you are able to transfert all these data types, array of
these basic types and two other Tango specific data types called
DevVarLongStringArray and DevVarDoubleStringArray. See chapter [Data
exchange] to get details about them. You are also able to create
attributes using any of these basic data types to transfer data between
clients and servers.</p>
</div>
<div class="section" id="request-model">
<h2>Request model<a class="headerlink" href="#request-model" title="Permalink to this headline">¶</a></h2>
<p>For the most important API remote calls (command_inout,
read_attribute(s) and write_attribute(s)), Tango supports two kind of
requests which are the synchronous model and the asynchronous model.
Synchronous model means that the client wait (and is blocked) for the
server to send an answer. Asynchronous model means that the client does
not wait for the server to send an answer. The client sends the request
and immediately returns allowing the CPU to do anything else (like
updating a graphical user interface). Device pipe supports only the
synchronous model. Within Tango, there are two ways to retrieve the
server answer when using asynchronous model. They are:</p>
<ol class="arabic simple">
<li>The polling mode</li>
<li>The callback mode</li>
</ol>
<p>In polling mode, the client executes a specific call to check if the
answer is arrived. If this is not the case, an exception is thrown. If
the reply is there, it is returned to the caller and if the reply was an
exception, it is re-thrown. There are two calls to check if the reply is
arrived:</p>
<ul class="simple">
<li>Call which does not wait before the server answer is returned to the
caller.</li>
<li>Call which wait with timeout before returning the server answer to
the caller (or throw the exception) if the answer is not arrived.</li>
</ul>
<p>In callback model, the caller must supply a callback method which will
be executed when the command returns. They are two sub-modes:</p>
<ol class="arabic simple">
<li>The pull callback mode</li>
<li>The push callback mode</li>
</ol>
<p>In the pull callback mode, the callback is triggered if the server
answer is arrived when the client decide it by calling a
<em>synchronization</em> method (The client pull-out the answer). In push mode,
the callback is executed as soon as the reply arrives in a separate
thread (The server pushes the answer to the client).</p>
<div class="section" id="synchronous-model">
<h3>Synchronous model<a class="headerlink" href="#synchronous-model" title="Permalink to this headline">¶</a></h3>
<p>Synchronous access to Tango device are provided using the <em>DeviceProxy</em>
or <em>AttributeProxy</em> class. For the <em>DeviceProxy</em> class, the main
synchronous call methods are :</p>
<ul class="simple">
<li><em>command_inout()</em> to execute a Tango device command</li>
<li><em>read_attribute()</em> or <em>read_attributes()</em> to read a Tango device
attribute(s)</li>
<li><em>write_attribute()</em> or <em>write_attributes()</em> to write a Tango device
attribute(s)</li>
<li><em>write_read_attribute()</em> or <em>write_read_attributes()</em> to write
then read Tango device attribute(s)</li>
<li><em>read_pipe()</em> to read a Tango device pipe</li>
<li><em>write_pipe()</em> to write a Tango device pipe</li>
<li><em>write_read_pipe()</em> to write then read Tango device pipe</li>
</ul>
<p>For commands, data are send/received to/from device using the
<em>DeviceData</em> class. For attributes, data are send/received to/from
device attribute using the <em>DeviceAttribute</em> class. For pipes, data are
send/receive to/from device pipe using the <em>DevicePipe</em> and
<em>DevicePipeBlob</em> classes.</p>
<p>In some cases, only attributes provided by a Tango device are
interesting for the application. You can use the <em>AttributeProxy</em> class.
Its main synchronous methods are :</p>
<ul class="simple">
<li><em>read()</em> to read the attribute value</li>
<li><em>write()</em> to write the attribute value</li>
<li><em>write_read()</em> to write then read the attribute value</li>
</ul>
<p>Data are transmitted using the <em>DeviceAttribute</em> class.</p>
</div>
<div class="section" id="asynchronous-model">
<h3>Asynchronous model<a class="headerlink" href="#asynchronous-model" title="Permalink to this headline">¶</a></h3>
<p>Asynchronous access to Tango device are provided using <em>DeviceProxy</em> or
<em>AttributeProxy, CallBack</em> and <em>ApiUtil</em> classes methods. The main
asynchronous call methods and used classes are :</p>
<ul class="simple">
<li>To execute a command on a device<ul>
<li><em>DeviceProxy::command_inout_asynch()</em> and
<em>DeviceProxy::command_inout_reply()</em> in polling model.</li>
<li><em>DeviceProxy::command_inout_asynch()</em>,
<em>DeviceProxy::get_asynch_replies()</em> and <em>CallBack</em> class in
callback pull model</li>
<li><em>DeviceProxy::command_inout_asynch()</em>,
<em>ApiUtil::set_asynch_cb_sub_model()</em> and <em>CallBack</em> class in
callback push model</li>
</ul>
</li>
<li>To read a device attribute<ul>
<li><em>DeviceProxy::read_attribute_asynch()</em> and
<em>DeviceProxy::read_attribute_reply()</em> in polling model</li>
<li><em>DeviceProxy::read_attribute_asynch()</em>,
<em>DeviceProxy::get_asynch_replies()</em> and <em>CallBack</em> class in
callback pull model.</li>
<li><em>DeviceProxy::read_attribute_asynch()</em>,
<em>ApiUtil::set_asynch_cb_sub_model()</em> and <em>CallBack</em> class in
callback push model</li>
</ul>
</li>
<li>To write a device attribute<ul>
<li><em>DeviceProxy::write_attribute_asynch()</em> in polling model</li>
<li><em>DeviceProxy::write_attribute_asynch()</em> and <em>CallBack</em> class in
callback pull model</li>
<li><em>DeviceProxy::write_attribute_asynch()</em>,
<em>ApiUtil::set_asynch_cb_sub_model()</em> and <em>CallBack</em> class in
callback push model</li>
</ul>
</li>
</ul>
<p>For commands, data are send/received to/from device using the
<em>DeviceData</em> class. For attributes, data are send/received to/from
device attribute using the <em>DeviceAttribute</em> class. It is also possible
to generate asynchronous request(s) using the <em>AttributeProxy</em> class
following the same schema than above. Methods to use are :</p>
<ul class="simple">
<li><em>read_asynch(</em>) and <em>read_reply()</em> to asynchronously read the
attribute value</li>
<li><em>write_asynch()</em> and <em>write_reply()</em> to asynchronously write the
attribute value</li>
</ul>
</div>
</div>
<div class="section" id="events">
<span id="events-tangoclient"></span><h2>Events<a class="headerlink" href="#events" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id1">
<h3>Introduction<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<p>Events are a critical part of any distributed control system. Their aim
is to provide a communication mechanism which is fast and efficient.</p>
<p>The standard CORBA communication paradigm is a synchronous or
asynchronous two-way call. In this paradigm the call is initiated by the
client who contacts the server. The server handles the client’s request
and sends the answer to the client or throws an exception which the
client catches. This paradigm involves two calls to receive a single
answer and requires the client to be active in initiating the request.
If the client has a permanent interest in a value he is obliged to poll
the server for an update in a value every time. This is not efficient in
terms of network bandwidth nor in terms of client programming.</p>
<p>For clients who are permanently interested in values the event-driven
communication paradigm is a more efficient and natural way of
programming. In this paradigm the client registers her interest once in
an event (value). After that the server informs the client every time
the event has occurred. This paradigm avoids the client polling, frees
it for doing other things, is fast and makes efficient use of the
network.</p>
<p>The rest of this chapter explains how the TANGO events are implemented
and the application programmer’s interface.</p>
</div>
<div class="section" id="event-definition">
<h3>Event definition<a class="headerlink" href="#event-definition" title="Permalink to this headline">¶</a></h3>
<p>TANGO events represent an alternative channel for reading TANGO device
attributes. Device attributes values are sent to all subscribed clients
when an event occurs. Events can be an attribute value change, a change
in the data quality or a periodically send event. The clients continue
receiving events as long as they stay subscribed. Most of the time, the
device server polling thread detects the event and then pushes the
device attribute value to all clients. Nevertheless, in some cases, the
delay introduced by the polling thread in the event propagation is
detrimental. For such cases, some API calls directly push the event.
Until TANGO release 8, the omniNotify implementation of the CORBA
Notification service was used to dispatch events. Starting with TANGO 8,
this CORBA Notification service has been replaced by the ZMQ library
which implements a Publish/Subscribe communication model well adapted to
TANGO events communication.</p>
</div>
<div class="section" id="event-types">
<h3>Event types<a class="headerlink" href="#event-types" title="Permalink to this headline">¶</a></h3>
<p>The following eight event types have been implemented in TANGO :</p>
<ol class="arabic simple">
<li><strong>change</strong> - an event is triggered and the attribute value is sent
when the attribute value changes significantly. The exact meaning of
significant is device attribute dependent. For analog and digital
values this is a delta fixed per attribute, for string values this is
any non-zero change i.e. if the new attribute value is not equal to
the previous attribute value. The delta can either be specified as a
relative or absolute change. The delta is the same for all clients
unless a filter is specified (see below). To easily write
applications using the change event, it is also triggered in the
following case :<ol class="arabic">
<li>When a spectrum or image attribute size changes.</li>
<li>At event subscription time</li>
<li>When the polling thread receives an exception during attribute
reading</li>
<li>When the polling thread detects that the attribute quality factor
has changed.</li>
<li>The first good reading of the attribute after the polling thread
has received exception when trying to read the attribute</li>
<li>The first time the polling thread detects that the attribute
quality factor has changed from INVALID to something else</li>
<li>When a change event is pushed manually from the device server
code. (<em>DeviceImpl::push_change_event()</em>).</li>
<li>By the methods Attribute::set_quality() and
Attribute::set_value_date_quality() if a client has subscribed
to the change event on the attribute. This has been implemented
for cases where the delay introduced by the polling thread in the
event propagation is not authorized.</li>
</ol>
</li>
<li><strong>periodic</strong> - an event is sent at a fixed periodic interval. The
frequency of this event is determined by the <em>event_period</em> property
of the attribute and the polling frequency. The polling frequency
determines the highest frequency at which the attribute is read. The
event_period determines the highest frequency at which the periodic
event is sent. Note if the event_period is not an integral number of
the polling period there will be a beating of the two
frequencies <a class="footnote-reference" href="#id7" id="id2">[1]</a>. Clients can reduce the frequency at which they
receive periodic events by specifying a filter on the periodic event
counter.</li>
<li><strong>archive</strong> - an event is sent if one of the archiving conditions is
satisfied. Archiving conditions are defined via properties in the
database. These can be a mixture of delta_change and periodic.
Archive events can be send from the polling thread or can be manually
pushed from the device server code
(<em>DeviceImpl::push_archive_event()</em>).</li>
<li><strong>attribute configuration</strong> - an event is sent if the attribute
configuration is changed.</li>
<li><strong>data ready</strong> - This event is sent when coded by the device server
programmer who uses a specific method of one of the Tango device
server class to fire the event
(<em>DeviceImpl::push_data_ready_event()</em>). The rule of this event is
to inform a client that it is now possible to read an attribute. This
could be useful in case of attribute with many data.</li>
<li><strong>user</strong> - The criteria and configuration of these user events are
managed by the device server programmer who uses a specific method of
one of the Tango device server class to fire the event
(<em>DeviceImpl::push_event()</em>).</li>
<li><strong>device interface change</strong> - This event is sent when the device
interface changes. Using Tango, it is possible to dynamically
add/remove attribute/command to a device. This event is the way to
inform client(s) that attribute/command has been added/removed from a
device. Note that this type of event is attached to a device and not
to one attribute (like all other event types). This event is
triggered in the following case :<ol class="arabic">
<li>A dynamic attribute or command is added or removed. The event is
sent after a small delay (50 mS) in order to eliminate the risk of
events storm in case several attributes/commands are added/removed
in a loop</li>
<li>At the end of admin device RestartServer or DevRestart command</li>
<li>After a re-connection due to a device server restart. Because the
device interface is not memorized, the event is sent even if it is
highly possible that the device interface has not changed. A flag
in the data propagated with the event inform listening
applications that the device interface change is not guaranteed.</li>
<li>At event re-connection time. This case is similar to the previous
one (device interface change not guaranteed)</li>
</ol>
</li>
<li><strong>pipe</strong> - This is the kind of event which has to be used when the
user want to push data through a pipe. This kind of event is only
sent by the user code by using a specific method
(<em>DeviceImpl::push_pipe_event()</em>). There is no way to ask the Tango
kernel to automatically push this kind of event.</li>
</ol>
<p>The first three above events are automatically generated by the TANGO
library or fired by the user code. Events number 4 and 7 are only
automatically sent by the library and events 5, 6 and 8 are fired only
by the user code.</p>
</div>
<div class="section" id="event-filtering-removed-in-tango-release-8-and-above">
<h3>Event filtering (Removed in Tango release 8 and above)<a class="headerlink" href="#event-filtering-removed-in-tango-release-8-and-above" title="Permalink to this headline">¶</a></h3>
<p>Please, note that this feature is available only for Tango releases
older than Tango 8. The CORBA Notification Service allows event
filtering. This means that a client can ask the Notification Service to
send the event only if some filter is evaluated to true. Within the
Tango control system, some pre-defined fields can be used as filter.
These fields depend on the event type.</p>
<table border="1" class="docutils">
<colgroup>
<col width="14%" />
<col width="27%" />
<col width="49%" />
<col width="10%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Event type</th>
<th class="head">Filterable field name</th>
<th class="head">Filterable field value</th>
<th class="head">type</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td rowspan="4">change</td>
<td>delta_change_rel</td>
<td>Relative change (in %)
since last even</td>
<td>double</td>
</tr>
<tr class="row-odd"><td>delta_change_abs</td>
<td>Absolute change since
last event</td>
<td>double</td>
</tr>
<tr class="row-even"><td>quality</td>
<td>Is set to 1 when the attribute quality
factor has changed, otherwise it is 0</td>
<td>double</td>
</tr>
<tr class="row-odd"><td>forced_event</td>
<td>Is set to 1 when the event was fired
on exception or a quality factor set
to invalid</td>
<td>double</td>
</tr>
<tr class="row-even"><td>periodic</td>
<td>counter</td>
<td>Incremented each time the event is sent</td>
<td>long</td>
</tr>
<tr class="row-odd"><td rowspan="6">archive</td>
<td>delta_change_rel</td>
<td>Relative change (in %) since last event</td>
<td>double</td>
</tr>
<tr class="row-even"><td>delta_change_abs</td>
<td>Absolute change since last event</td>
<td>double</td>
</tr>
<tr class="row-odd"><td>quality</td>
<td><dl class="first last docutils">
<dt>Is set to 1 when the attribute quality</dt>
<dd>factor has changed, otherwise it is 0</dd>
</dl>
</td>
<td>double</td>
</tr>
<tr class="row-even"><td>counter</td>
<td>Incremented each time the event is sent
for periodic reason. Set to -1 if event
sent for change reason</td>
<td>long</td>
</tr>
<tr class="row-odd"><td>forced_event</td>
<td>Is set to 1 when the event was fired on
exception or a quality factor set to
invalid</td>
<td>double</td>
</tr>
<tr class="row-even"><td>delta_event</td>
<td>Number of milli-seconds since previous
event</td>
<td>double</td>
</tr>
</tbody>
</table>
<p>Filter are defined as a string following a grammar defined by CORBA. It
is defined in <a class="reference internal" href="../../reference/bibliography.html#notificationservice" id="id3">[NotificationService]</a>. The following example shows
you the most common use of these filters in the Tango world :</p>
<ul>
<li><p class="first">To receive periodic event one out of every three, the filter must be</p>
<p>$counter % 3 == 0</p>
</li>
<li><p class="first">To receive change event only if the relative change is greater than
% (positive and negative), the filter must be</p>
<p>$delta_change_rel &gt;= 20 or $delta_change_rel &lt;= -20</p>
</li>
<li><p class="first">To receive a change event only on quality change, the filter must be</p>
<p>$quality == 1</p>
</li>
</ul>
<p>For user events, the filter field name(s) and their value are defined by
the device server programmer.</p>
</div>
<div class="section" id="application-programmers-interface">
<h3>Application Programmer’s Interface<a class="headerlink" href="#application-programmers-interface" title="Permalink to this headline">¶</a></h3>
<p>How to setup and use the TANGO events ? The interfaces described here
are intended as user friendly interfaces to the underlying CORBA calls.
The interface is modeled after the asynchronous <em>command_inout()</em>
interface so as to maintain coherency. The event system supports <strong>push
callback model</strong> as well as the <strong>pull callback model.</strong></p>
<p>The two event reception modes are:</p>
<ul class="simple">
<li><strong>Push callback model</strong> : On event reception a callbacks method gets
immediately executed.</li>
<li><strong>Pull callback model</strong> : The event will be buffered the client until
the client is ready to receive the event data. The client triggers
the execution of the callback method.</li>
</ul>
<p>The event reception buffer in the <strong>pull callback model</strong>, is
implemented as a round robin buffer. The client can choose the size when
subscribing for the event. This way the client can set-up different ways
to receive events.</p>
<ul class="simple">
<li>Event reception buffer size = 1 : The client is interested only in
the value of the last event received. All other events that have been
received since the last reading are discarded.</li>
<li>Event reception buffer size &gt; 1 : The client has chosen to keep an
event history of a given size. When more events arrive since the last
reading, older events will be discarded.</li>
<li>Event reception buffer size = ALL_EVENTS : The client buffers all
received events. The buffer size is unlimited and only restricted by
the available memory for the client.</li>
</ul>
<div class="section" id="configuring-events">
<h4>Configuring events<a class="headerlink" href="#configuring-events" title="Permalink to this headline">¶</a></h4>
<p>The attribute configuration set is used to configure under what
conditions events are generated. A set of standard attribute properties
(part of the standard attribute configuration) are read from the
database at device startup time and used to configure the event engine.
If there are no properties defined then default values specified in the
code are used.</p>
<div class="section" id="change">
<h5>change<a class="headerlink" href="#change" title="Permalink to this headline">¶</a></h5>
<p>The attribute properties and their default values for the change event
are :</p>
<ol class="arabic simple">
<li><strong>rel_change</strong> - a property of maximum 2 values. It specifies the
positive and negative relative change of the attribute value w.r.t.
the value of the previous change event which will trigger the event.
If the attribute is a spectrum or an image then a change event is
generated if any one of the attribute value’s satisfies the above
criterium. If only one property is specified then it is used for the
positive and negative change. If no property is specified, no events
are generated.</li>
<li><strong>abs_change</strong> - a property of maximum 2 values.It specifies the
positive and negative absolute change of the attribute value w.r.t
the value of the previous change event which will trigger the event.
If the attribute is a spectrum or an image then a change event is
generated if any one of the attribute value’s satisfies the above
criterium. If only one property is specified then it is used for the
positive and negative change. If no properties are specified then the
relative change is used.</li>
</ol>
</div>
<div class="section" id="periodic">
<h5>periodic<a class="headerlink" href="#periodic" title="Permalink to this headline">¶</a></h5>
<p>The attribute properties and their default values for the periodic event
are :</p>
<ol class="arabic simple">
<li><strong>event_period</strong> - the minimum time between events (in
milliseconds). If no property is specified then a default value of 1
second is used.</li>
</ol>
</div>
<div class="section" id="archive">
<h5>archive<a class="headerlink" href="#archive" title="Permalink to this headline">¶</a></h5>
<p>The attribute properties and their default values for the archive event
are :</p>
<ol class="arabic simple">
<li><strong>archive_rel_change</strong> - a property of maximum 2 values which
specifies the positive and negative relative change w.r.t. the
previous attribute value which will trigger the event. If the
attribute is a spectrum or an image then an archive event is
generated if any one of the attribute value’s satisfies the above
criterium. If only one property is specified then it is used for the
positive and negative change. If no properties are specified then no
events are generate.</li>
<li><strong>archive_abs_change</strong> - a property of maximum 2 values which
specifies the positive and negative absolute change w.r.t the
previous attribute value which will trigger the event. If the
attribute is a spectrum or an image then an archive event is
generated if any one of the attribute value’s satisfies the above
criterium. If only one property is specified then it is used for the
positive and negative change. If no properties are specified then the
relative change is used.</li>
<li><strong>archive_period</strong> - the minimum time between archive events (in
milliseconds). If no property is specified, no periodic archiving
events are send.</li>
</ol>
</div>
</div>
<div class="section" id="c-clients">
<h4>C++ Clients<a class="headerlink" href="#c-clients" title="Permalink to this headline">¶</a></h4>
<p>This is the interface for clients who want to receive events. The main
action of the client is to subscribe and unsubscribe to events. Once the
client has subscribed to one or more events the events are received in a
separate thread by the client.</p>
<p>Two reception modes are possible:</p>
<ul class="simple">
<li>On event reception a callbacks method gets immediately executed.</li>
<li>The event will be buffered until the client until the client is ready
to receive the event data.</li>
</ul>
<p>The mode to be used has to be chosen when subscribing for the event.</p>
<div class="section" id="subscribing-to-events">
<h5>Subscribing to events<a class="headerlink" href="#subscribing-to-events" title="Permalink to this headline">¶</a></h5>
<p>The client call to subscribe to an event is named
<em>DeviceProxy::subscribe_event()</em> . During the event subscription the
client has to choose the event reception mode to use.</p>
<p><strong>Push model</strong>:</p>
<pre class="code cpp literal-block">
<span class="ln">1 </span>  <span class="keyword type">int</span> <span class="name">DeviceProxy</span><span class="operator">::</span><span class="name">subscribe_event</span><span class="punctuation">(</span>
<span class="ln">2 </span>               <span class="keyword">const</span> <span class="name">string</span> <span class="operator">&amp;</span><span class="name">attribute</span><span class="punctuation">,</span>
<span class="ln">3 </span>               <span class="name">Tango</span><span class="operator">::</span><span class="name">EventType</span> <span class="name">event</span><span class="punctuation">,</span>
<span class="ln">4 </span>               <span class="name">Tango</span><span class="operator">::</span><span class="name">CallBack</span> <span class="operator">*</span><span class="name">callback</span><span class="punctuation">,</span>
<span class="ln">5 </span>               <span class="keyword type">bool</span> <span class="name">stateless</span> <span class="operator">=</span> <span class="name builtin">false</span><span class="punctuation">);</span>
</pre>
<p>The client implements a callback method which is triggered when the
event is received. Note that this callback method will be executed by a
thread started by the underlying ORB. This thread is not the application
main thread. For Tango releases before 8, a similar call with one extra
parameter for event filtering is also available.</p>
<p><strong>Pull model</strong>:</p>
<pre class="code cpp literal-block">
<span class="ln">1 </span>  <span class="keyword type">int</span> <span class="name">DeviceProxy</span><span class="operator">::</span><span class="name">subscribe_event</span><span class="punctuation">(</span>
<span class="ln">2 </span>               <span class="keyword">const</span> <span class="name">string</span> <span class="operator">&amp;</span><span class="name">attribute</span><span class="punctuation">,</span>
<span class="ln">3 </span>               <span class="name">Tango</span><span class="operator">::</span><span class="name">EventType</span> <span class="name">event</span><span class="punctuation">,</span>
<span class="ln">4 </span>               <span class="keyword type">int</span> <span class="name">event_queue_size</span><span class="punctuation">,</span>
<span class="ln">5 </span>               <span class="keyword type">bool</span> <span class="name">stateless</span> <span class="operator">=</span> <span class="name builtin">false</span><span class="punctuation">);</span>
</pre>
<p>The client chooses the size of the round robin event reception buffer.
Arriving events will be buffered until the client uses
<em>DeviceProxy::get_events()</em> to extract the event data. For Tango
releases before 8, a similar call with one extra parameter for event
filtering is also available.</p>
<p>On top of the user filter defined by the <em>filters</em> parameter, basic
filtering is done based on the reason specified and the event type. For
example when reading the state and the reason specified is change the
event will be fired only when the state changes. Events consist of an
attribute name and the event reason. A standard set of reasons are
implemented by the system, additional device specific reasons can be
implemented by device servers programmers.</p>
<p>The stateless flag = false indicates that the event subscription will
only succeed when the given attribute is known and available in the
Tango system. Setting stateless = true will make the subscription
succeed, even if an attribute of this name was never known. The real
event subscription will happen when the given attribute will be
available in the Tango system.</p>
<p>Note that in this model, the callback method will be executed by the
thread doing the <em>DeviceProxy::get_events()</em> call.</p>
</div>
<div class="section" id="the-callback-class">
<h5>The CallBack class<a class="headerlink" href="#the-callback-class" title="Permalink to this headline">¶</a></h5>
<p>In C++, the client has to implement a class inheriting from the Tango
CallBack class and pass this to the <em>DeviceProxy::subscribe_event()</em>
method. The CallBack class is the same class as the one proposed for the
TANGO asynchronous call. This is as follows for events :</p>
<pre class="code cpp literal-block">
<span class="ln"> 1 </span>  <span class="keyword">class</span> <span class="name class">MyCallback</span> <span class="operator">:</span> <span class="keyword">public</span> <span class="name">Tango</span><span class="operator">::</span><span class="name">CallBack</span>
<span class="ln"> 2 </span>  <span class="punctuation">{</span>
<span class="ln"> 3 </span>     <span class="punctuation">.</span>
<span class="ln"> 4 </span>     <span class="punctuation">.</span>
<span class="ln"> 5 </span>     <span class="punctuation">.</span>
<span class="ln"> 6 </span>     <span class="keyword">virtual</span> <span class="name">push_event</span><span class="punctuation">(</span><span class="name">Tango</span><span class="operator">::</span><span class="name">EventData</span> <span class="operator">*</span><span class="punctuation">);</span>
<span class="ln"> 7 </span>     <span class="keyword">virtual</span> <span class="name function">push_event</span><span class="punctuation">(</span><span class="name">Tango</span><span class="operator">::</span><span class="name">AttrConfEventData</span> <span class="operator">*</span><span class="punctuation">);</span>
<span class="ln"> 8 </span>     <span class="keyword">virtual</span> <span class="name function">push_event</span><span class="punctuation">(</span><span class="name">Tango</span><span class="operator">::</span><span class="name">DataReadyEventData</span> <span class="operator">*</span><span class="punctuation">);</span>
<span class="ln"> 9 </span>     <span class="keyword">virtual</span> <span class="name function">push_event</span><span class="punctuation">(</span><span class="name">Tango</span><span class="operator">::</span><span class="name">DevIntrChangeEventData</span> <span class="operator">*</span><span class="punctuation">);</span>
<span class="ln">10 </span>     <span class="keyword">virtual</span> <span class="name function">push_event</span><span class="punctuation">(</span><span class="name">Tango</span><span class="operator">::</span><span class="name">PipeEventData</span> <span class="operator">*</span><span class="punctuation">);</span>
<span class="ln">11 </span>  <span class="punctuation">}</span>
</pre>
<p>where EventData is defined as follows :</p>
<pre class="code cpp literal-block">
<span class="ln"> 1 </span>  <span class="keyword">class</span> <span class="name class">EventData</span>
<span class="ln"> 2 </span>  <span class="punctuation">{</span>
<span class="ln"> 3 </span>     <span class="name">DeviceProxy</span>       <span class="operator">*</span><span class="name">device</span><span class="punctuation">;</span>
<span class="ln"> 4 </span>     <span class="name">string</span>            <span class="name">attr_name</span><span class="punctuation">;</span>
<span class="ln"> 5 </span>     <span class="name">string</span>            <span class="name">event</span><span class="punctuation">;</span>
<span class="ln"> 6 </span>     <span class="name">DeviceAttribute</span>   <span class="operator">*</span><span class="name">attr_value</span><span class="punctuation">;</span>
<span class="ln"> 7 </span>     <span class="keyword type">bool</span>              <span class="name">err</span><span class="punctuation">;</span>
<span class="ln"> 8 </span>     <span class="name">DevErrorList</span>      <span class="name">errors</span><span class="punctuation">;</span>
<span class="ln"> 9 </span>  <span class="punctuation">}</span>
</pre>
<p>AttrConfEventData is defined as follows :</p>
<pre class="code cpp literal-block">
<span class="ln"> 1 </span>  <span class="keyword">class</span> <span class="name class">AttrConfEventData</span>
<span class="ln"> 2 </span>  <span class="punctuation">{</span>
<span class="ln"> 3 </span>     <span class="name">DeviceProxy</span>       <span class="operator">*</span><span class="name">device</span><span class="punctuation">;</span>
<span class="ln"> 4 </span>     <span class="name">string</span>            <span class="name">attr_name</span><span class="punctuation">;</span>
<span class="ln"> 5 </span>     <span class="name">string</span>            <span class="name">event</span><span class="punctuation">;</span>
<span class="ln"> 6 </span>     <span class="name">AttributeInfoEx</span>   <span class="operator">*</span><span class="name">attr_conf</span><span class="punctuation">;</span>
<span class="ln"> 7 </span>     <span class="keyword type">bool</span>              <span class="name">err</span><span class="punctuation">;</span>
<span class="ln"> 8 </span>     <span class="name">DevErrorList</span>      <span class="name">errors</span><span class="punctuation">;</span>
<span class="ln"> 9 </span>  <span class="punctuation">}</span>
</pre>
<p>DataReadyEventData is defined as follows :</p>
<pre class="code cpp literal-block">
<span class="ln"> 1 </span>  <span class="keyword">class</span> <span class="name class">DataReadyEventData</span>
<span class="ln"> 2 </span>  <span class="punctuation">{</span>
<span class="ln"> 3 </span>     <span class="name">DeviceProxy</span>       <span class="operator">*</span><span class="name">device</span><span class="punctuation">;</span>
<span class="ln"> 4 </span>     <span class="name">string</span>            <span class="name">attr_name</span><span class="punctuation">;</span>
<span class="ln"> 5 </span>     <span class="name">string</span>            <span class="name">event</span><span class="punctuation">;</span>
<span class="ln"> 6 </span>     <span class="keyword type">int</span>               <span class="name">attr_data_type</span><span class="punctuation">;</span>
<span class="ln"> 7 </span>     <span class="keyword type">int</span>               <span class="name">ctr</span><span class="punctuation">;</span>
<span class="ln"> 8 </span>     <span class="keyword type">bool</span>              <span class="name">err</span><span class="punctuation">;</span>
<span class="ln"> 9 </span>     <span class="name">DevErrorList</span>      <span class="name">errors</span><span class="punctuation">;</span>
<span class="ln">10 </span>  <span class="punctuation">}</span>
</pre>
<p>DevIntrChangeEventData is defined as follows :</p>
<pre class="code cpp literal-block">
<span class="ln"> 1 </span>  <span class="keyword">class</span> <span class="name class">DevIntrChangeEventData</span>
<span class="ln"> 2 </span>  <span class="punctuation">{</span>
<span class="ln"> 3 </span>     <span class="name">DeviceProxy</span>            <span class="name">device</span><span class="punctuation">;</span>
<span class="ln"> 4 </span>     <span class="name">string</span>                 <span class="name">event</span><span class="punctuation">;</span>
<span class="ln"> 5 </span>     <span class="name">string</span>                 <span class="name">device_name</span><span class="punctuation">;</span>
<span class="ln"> 6 </span>     <span class="name">CommandInfoList</span>        <span class="name">cmd_list</span><span class="punctuation">;</span>
<span class="ln"> 7 </span>     <span class="name">AttributeInfoListEx</span>    <span class="name">att_list</span><span class="punctuation">;</span>
<span class="ln"> 8 </span>     <span class="keyword type">bool</span>                   <span class="name">dev_started</span><span class="punctuation">;</span>
<span class="ln"> 9 </span>     <span class="keyword type">bool</span>                   <span class="name">err</span><span class="punctuation">;</span>
<span class="ln">10 </span>     <span class="name">DevErrorList</span>           <span class="name">errors</span><span class="punctuation">;</span>
<span class="ln">11 </span>  <span class="punctuation">}</span>
</pre>
<p>and PipeEventData is defined as follows :</p>
<pre class="code cpp literal-block">
<span class="ln"> 1 </span>  <span class="keyword">class</span> <span class="name class">PipeEventData</span>
<span class="ln"> 2 </span>  <span class="punctuation">{</span>
<span class="ln"> 3 </span>     <span class="name">DeviceProxy</span>       <span class="operator">*</span><span class="name">device</span><span class="punctuation">;</span>
<span class="ln"> 4 </span>     <span class="name">string</span>            <span class="name">pipe_name</span><span class="punctuation">;</span>
<span class="ln"> 5 </span>     <span class="name">string</span>            <span class="name">event</span><span class="punctuation">;</span>
<span class="ln"> 6 </span>     <span class="name">DevicePipe</span>        <span class="operator">*</span><span class="name">pipe_value</span><span class="punctuation">;</span>
<span class="ln"> 7 </span>     <span class="keyword type">bool</span>              <span class="name">err</span><span class="punctuation">;</span>
<span class="ln"> 8 </span>     <span class="name">DevErrorList</span>      <span class="name">errors</span><span class="punctuation">;</span>
<span class="ln"> 9 </span>  <span class="punctuation">}</span>
</pre>
<p>In push model, there are some cases (same callback used for events
coming from different devices hosted in device server process running on
different hosts) where the callback method could be executed concurently
by different threads started by the ORB. The user has to code his
callback method in a <strong>thread</strong> <strong>safe</strong> manner.</p>
</div>
<div class="section" id="unsubscribing-from-an-event">
<h5>Unsubscribing from an event<a class="headerlink" href="#unsubscribing-from-an-event" title="Permalink to this headline">¶</a></h5>
<p>Unsubscribe a client from receiving the event specified by <em>event_id</em>
is done by calling the <em>DeviceProxy::unsubscribe_event()</em> method :</p>
<pre class="code cpp literal-block">
<span class="ln">1 </span>  <span class="keyword type">void</span> <span class="name">DeviceProxy</span><span class="operator">::</span><span class="name">unsubscribe_event</span><span class="punctuation">(</span><span class="keyword type">int</span> <span class="name">event_id</span><span class="punctuation">);</span>
</pre>
</div>
<div class="section" id="extract-buffered-event-data">
<h5>Extract buffered event data<a class="headerlink" href="#extract-buffered-event-data" title="Permalink to this headline">¶</a></h5>
<p>When the pull model was chosen during the event subscription, the
received event data can be extracted with <em>DeviceProxy::get_events().</em>
Two possibilities are available for data extraction. Either a callback
method can be executed for every event in the buffer when using</p>
<pre class="code cpp literal-block">
<span class="ln">1 </span>  <span class="keyword type">int</span> <span class="name">DeviceProxy</span><span class="operator">::</span><span class="name">get_events</span><span class="punctuation">(</span>
<span class="ln">2 </span>               <span class="keyword type">int</span> <span class="name">event_id</span><span class="punctuation">,</span>
<span class="ln">3 </span>               <span class="name">CallBack</span> <span class="operator">*</span><span class="name">cb</span><span class="punctuation">);</span>
</pre>
<p>Or all the event data can be directly extracted as EventDataList,
AttrConfEventDataList , DataReadyEventDataList,
DevIntrChangeEventDataList or PipeEventDataList when using</p>
<pre class="code cpp literal-block">
<span class="ln"> 1 </span>  <span class="keyword type">int</span> <span class="name">DeviceProxy</span><span class="operator">::</span><span class="name">get_events</span><span class="punctuation">(</span>
<span class="ln"> 2 </span>               <span class="keyword type">int</span> <span class="name">event_id</span><span class="punctuation">,</span>
<span class="ln"> 3 </span>               <span class="name">EventDataList</span> <span class="operator">&amp;</span><span class="name">event_list</span><span class="punctuation">);</span>
<span class="ln"> 4 </span>
<span class="ln"> 5 </span>  <span class="keyword type">int</span> <span class="name">DeviceProxy</span><span class="operator">::</span><span class="name">get_events</span><span class="punctuation">(</span>
<span class="ln"> 6 </span>               <span class="keyword type">int</span> <span class="name">event_id</span><span class="punctuation">,</span>
<span class="ln"> 7 </span>               <span class="name">AttrConfEventDataList</span> <span class="operator">&amp;</span><span class="name">event_list</span><span class="punctuation">);</span>
<span class="ln"> 8 </span>
<span class="ln"> 9 </span>  <span class="keyword type">int</span> <span class="name">DeviceProxy</span><span class="operator">::</span><span class="name">get_events</span><span class="punctuation">(</span>
<span class="ln">10 </span>               <span class="keyword type">int</span> <span class="name">event_id</span><span class="punctuation">,</span>
<span class="ln">11 </span>               <span class="name">DataReadyEventDataList</span> <span class="operator">&amp;</span><span class="name">event_list</span><span class="punctuation">);</span>
<span class="ln">12 </span>
<span class="ln">13 </span>  <span class="keyword type">int</span> <span class="name">DeviceProxy</span><span class="operator">::</span><span class="name">get_events</span><span class="punctuation">(</span>
<span class="ln">14 </span>               <span class="keyword type">int</span> <span class="name">event_id</span><span class="punctuation">,</span>
<span class="ln">15 </span>               <span class="name">DevIntrChangeEventDataList</span> <span class="operator">&amp;</span><span class="name">event_list</span><span class="punctuation">);</span>
<span class="ln">16 </span>
<span class="ln">17 </span>  <span class="keyword type">int</span> <span class="name">DeviceProxy</span><span class="operator">::</span><span class="name">get_events</span><span class="punctuation">(</span>
<span class="ln">18 </span>               <span class="keyword type">int</span> <span class="name">event_id</span><span class="punctuation">,</span>
<span class="ln">19 </span>               <span class="name">PipeEventDataList</span> <span class="operator">&amp;</span><span class="name">event_list</span><span class="punctuation">);</span>
</pre>
<p>The event data lists are vectors of EventData, AttrConfEventData,
DataReadyEventData or PipeEventData pointers with special destructor and
clean-up methods to ease the memory handling.</p>
<pre class="code cpp literal-block">
<span class="ln">1 </span>  <span class="keyword">class</span> <span class="name class">EventDataList</span><span class="operator">:</span><span class="keyword">public</span> <span class="name">vector</span><span class="operator">&lt;</span><span class="name">EventData</span> <span class="operator">*&gt;</span>
<span class="ln">2 </span>  <span class="keyword">class</span> <span class="name class">AttrConfEventDataList</span><span class="operator">:</span><span class="keyword">public</span> <span class="name">vector</span><span class="operator">&lt;</span><span class="name">AttrConfEventData</span> <span class="operator">*&gt;</span>
<span class="ln">3 </span>  <span class="keyword">class</span> <span class="name class">DataReadyEventDataList</span><span class="operator">:</span><span class="keyword">public</span> <span class="name">vector</span><span class="operator">&lt;</span><span class="name">DataReadyEventData</span> <span class="operator">*&gt;</span>
<span class="ln">4 </span>  <span class="keyword">class</span> <span class="name class">DevIntrChangeEventDataList</span><span class="operator">:</span><span class="keyword">public</span> <span class="name">vector</span><span class="operator">&lt;</span><span class="name">DevIntrChangeEventData</span> <span class="operator">*&gt;</span>
<span class="ln">5 </span>  <span class="keyword">class</span> <span class="name class">PipeEventDataList</span><span class="operator">:</span><span class="keyword">public</span> <span class="name">vector</span><span class="operator">&lt;</span><span class="name">PipeEventData</span> <span class="operator">*&gt;</span>
</pre>
</div>
<div class="section" id="example">
<h5>Example<a class="headerlink" href="#example" title="Permalink to this headline">¶</a></h5>
<p>Here is a typical code example of a client to register and receive
events. First, you have to define a callback method as follows:</p>
<pre class="code cpp literal-block">
<span class="ln"> 1 </span>  <span class="keyword">class</span> <span class="name class">DoubleEventCallBack</span> <span class="operator">:</span> <span class="keyword">public</span> <span class="name">Tango</span><span class="operator">::</span><span class="name">CallBack</span>
<span class="ln"> 2 </span>  <span class="punctuation">{</span>
<span class="ln"> 3 </span>     <span class="keyword type">void</span> <span class="name">push_event</span><span class="punctuation">(</span><span class="name">Tango</span><span class="operator">::</span><span class="name">EventData</span><span class="operator">*</span><span class="punctuation">);</span>
<span class="ln"> 4 </span>  <span class="punctuation">};</span>
<span class="ln"> 5 </span>
<span class="ln"> 6 </span>
<span class="ln"> 7 </span>  <span class="keyword type">void</span> <span class="name">DoubleEventCallBack</span><span class="operator">::</span><span class="name">push_event</span><span class="punctuation">(</span><span class="name">Tango</span><span class="operator">::</span><span class="name">EventData</span> <span class="operator">*</span><span class="name">myevent</span><span class="punctuation">)</span>
<span class="ln"> 8 </span>  <span class="punctuation">{</span>
<span class="ln"> 9 </span>      <span class="name">Tango</span><span class="operator">::</span><span class="name">DevVarDoubleArray</span> <span class="operator">*</span><span class="name">double_value</span><span class="punctuation">;</span>
<span class="ln">10 </span>      <span class="keyword">try</span>
<span class="ln">11 </span>      <span class="punctuation">{</span>
<span class="ln">12 </span>          <span class="name">cout</span> <span class="operator">&lt;&lt;</span> <span class="literal string">&quot;DoubleEventCallBack::push_event(): called attribute &quot;</span>
<span class="ln">13 </span>               <span class="operator">&lt;&lt;</span> <span class="name">myevent</span><span class="operator">-&gt;</span><span class="name">attr_name</span>
<span class="ln">14 </span>               <span class="operator">&lt;&lt;</span> <span class="literal string">&quot; event &quot;</span>
<span class="ln">15 </span>               <span class="operator">&lt;&lt;</span> <span class="name">myevent</span><span class="operator">-&gt;</span><span class="name">event</span>
<span class="ln">16 </span>               <span class="operator">&lt;&lt;</span> <span class="literal string">&quot; (err=&quot;</span>
<span class="ln">17 </span>               <span class="operator">&lt;&lt;</span> <span class="name">myevent</span><span class="operator">-&gt;</span><span class="name">err</span>
<span class="ln">18 </span>               <span class="operator">&lt;&lt;</span> <span class="literal string">&quot;)&quot;</span> <span class="operator">&lt;&lt;</span> <span class="name">endl</span><span class="punctuation">;</span>
<span class="ln">19 </span>
<span class="ln">20 </span>
<span class="ln">21 </span>           <span class="keyword">if</span> <span class="punctuation">(</span><span class="operator">!</span><span class="name">myevent</span><span class="operator">-&gt;</span><span class="name">err</span><span class="punctuation">)</span>
<span class="ln">22 </span>           <span class="punctuation">{</span>
<span class="ln">23 </span>               <span class="operator">*</span><span class="punctuation">(</span><span class="name">myevent</span><span class="operator">-&gt;</span><span class="name">attr_value</span><span class="punctuation">)</span> <span class="operator">&gt;&gt;</span> <span class="name">double_value</span><span class="punctuation">;</span>
<span class="ln">24 </span>               <span class="name">cout</span> <span class="operator">&lt;&lt;</span> <span class="literal string">&quot;double value &quot;</span>
<span class="ln">25 </span>                    <span class="operator">&lt;&lt;</span> <span class="punctuation">(</span><span class="operator">*</span><span class="name">double_value</span><span class="punctuation">)[</span><span class="literal number integer">0</span><span class="punctuation">]</span>
<span class="ln">26 </span>                    <span class="operator">&lt;&lt;</span> <span class="name">endl</span><span class="punctuation">;</span>
<span class="ln">27 </span>               <span class="keyword">delete</span> <span class="name">double_value</span><span class="punctuation">;</span>
<span class="ln">28 </span>           <span class="punctuation">}</span>
<span class="ln">29 </span>      <span class="punctuation">}</span>
<span class="ln">30 </span>      <span class="keyword">catch</span> <span class="punctuation">(...)</span>
<span class="ln">31 </span>      <span class="punctuation">{</span>
<span class="ln">32 </span>           <span class="name">cout</span> <span class="operator">&lt;&lt;</span> <span class="literal string">&quot;DoubleEventCallBack::push_event(): could not extract data !</span><span class="literal string escape">\n</span><span class="literal string">&quot;</span><span class="punctuation">;</span>
<span class="ln">33 </span>      <span class="punctuation">}</span>
<span class="ln">34 </span>  <span class="punctuation">}</span>
</pre>
<p>Then the main code must subscribe to the event and choose the push or
the pull model for event reception.</p>
<p><strong>Push model</strong>:</p>
<pre class="code cpp literal-block">
<span class="ln"> 1 </span>  <span class="name">DoubleEventCallBack</span> <span class="operator">*</span><span class="name">double_callback</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="name">DoubleEventCallBack</span><span class="punctuation">;</span>
<span class="ln"> 2 </span>
<span class="ln"> 3 </span>  <span class="name">Tango</span><span class="operator">::</span><span class="name">DeviceProxy</span> <span class="operator">*</span><span class="name">mydevice</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="name">Tango</span><span class="operator">::</span><span class="name">DeviceProxy</span><span class="punctuation">(</span><span class="literal string">&quot;my/device/1&quot;</span><span class="punctuation">);</span>
<span class="ln"> 4 </span>
<span class="ln"> 5 </span>  <span class="keyword type">int</span> <span class="name">event_id</span><span class="punctuation">;</span>
<span class="ln"> 6 </span>  <span class="keyword">const</span> <span class="name">string</span> <span class="name function">attr_name</span><span class="punctuation">(</span><span class="literal string">&quot;current&quot;</span><span class="punctuation">);</span>
<span class="ln"> 7 </span>  <span class="name">event_id</span> <span class="operator">=</span> <span class="name">mydevice</span><span class="operator">-&gt;</span><span class="name">subscribe_event</span><span class="punctuation">(</span><span class="name">attr_name</span><span class="punctuation">,</span>
<span class="ln"> 8 </span>                           <span class="name">Tango</span><span class="operator">::</span><span class="name">CHANGE_EVENT</span><span class="punctuation">,</span>
<span class="ln"> 9 </span>                           <span class="name">double_callback</span><span class="punctuation">);</span>
<span class="ln">10 </span>  <span class="name">cout</span> <span class="operator">&lt;&lt;</span> <span class="literal string">&quot;event_client() id = &quot;</span> <span class="operator">&lt;&lt;</span> <span class="name">event_id</span> <span class="operator">&lt;&lt;</span> <span class="name">endl</span><span class="punctuation">;</span>
<span class="ln">11 </span>
<span class="ln">12 </span>  <span class="comment single">// The callback methods are executed by the Tango event reception thread.
</span><span class="ln">13 </span><span class="comment single"></span>  <span class="comment single">// The main thread is not concerned of event reception.
</span><span class="ln">14 </span><span class="comment single"></span>  <span class="comment single">// Whatch out with synchronisation and data access in a multi threaded environment!
</span><span class="ln">15 </span><span class="comment single"></span>
<span class="ln">16 </span>  <span class="name">sleep</span><span class="punctuation">(</span><span class="literal number integer">1000</span><span class="punctuation">);</span> <span class="comment single">// wait for events
</span><span class="ln">17 </span><span class="comment single"></span>
<span class="ln">18 </span>  <span class="name">mydevice</span><span class="operator">-&gt;</span><span class="name">unsubscribe_event</span><span class="punctuation">(</span><span class="name">event_id</span><span class="punctuation">);</span>
</pre>
<p><strong>Pull model</strong>:</p>
<pre class="code cpp literal-block">
<span class="ln"> 1 </span>  <span class="name">DoubleEventCallBack</span> <span class="operator">*</span><span class="name">double_callback</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="name">DoubleEventCallBack</span><span class="punctuation">;</span>
<span class="ln"> 2 </span>  <span class="keyword type">int</span> <span class="name">event_queue_size</span> <span class="operator">=</span> <span class="literal number integer">100</span><span class="punctuation">;</span> <span class="comment single">// keep the last 100 events
</span><span class="ln"> 3 </span><span class="comment single"></span>
<span class="ln"> 4 </span>  <span class="name">Tango</span><span class="operator">::</span><span class="name">DeviceProxy</span> <span class="operator">*</span><span class="name">mydevice</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="name">Tango</span><span class="operator">::</span><span class="name">DeviceProxy</span><span class="punctuation">(</span><span class="literal string">&quot;my/device/1&quot;</span><span class="punctuation">);</span>
<span class="ln"> 5 </span>
<span class="ln"> 6 </span>  <span class="keyword type">int</span> <span class="name">event_id</span><span class="punctuation">;</span>
<span class="ln"> 7 </span>  <span class="keyword">const</span> <span class="name">string</span> <span class="name function">attr_name</span><span class="punctuation">(</span><span class="literal string">&quot;current&quot;</span><span class="punctuation">);</span>
<span class="ln"> 8 </span>  <span class="name">event_id</span> <span class="operator">=</span> <span class="name">mydevice</span><span class="operator">-&gt;</span><span class="name">subscribe_event</span><span class="punctuation">(</span><span class="name">attr_name</span><span class="punctuation">,</span>
<span class="ln"> 9 </span>                           <span class="name">Tango</span><span class="operator">::</span><span class="name">CHANGE_EVENT</span><span class="punctuation">,</span>
<span class="ln">10 </span>                           <span class="name">event_queue_size</span><span class="punctuation">);</span>
<span class="ln">11 </span>  <span class="name">cout</span> <span class="operator">&lt;&lt;</span> <span class="literal string">&quot;event_client() id = &quot;</span> <span class="operator">&lt;&lt;</span> <span class="name">event_id</span> <span class="operator">&lt;&lt;</span> <span class="name">endl</span><span class="punctuation">;</span>
<span class="ln">12 </span>
<span class="ln">13 </span>  <span class="comment single">// Check every 3 seconds whether new events have arrived and trigger the callback method
</span><span class="ln">14 </span><span class="comment single"></span>  <span class="comment single">// for the new events.
</span><span class="ln">15 </span><span class="comment single"></span>
<span class="ln">16 </span>  <span class="keyword">for</span> <span class="punctuation">(</span><span class="keyword type">int</span> <span class="name">i</span><span class="operator">=</span><span class="literal number integer">0</span><span class="punctuation">;</span> <span class="name">i</span> <span class="operator">&lt;</span> <span class="literal number integer">100</span><span class="punctuation">;</span> <span class="name">i</span><span class="operator">++</span><span class="punctuation">)</span>
<span class="ln">17 </span>  <span class="punctuation">{</span>
<span class="ln">18 </span>      <span class="name">sleep</span> <span class="punctuation">(</span><span class="literal number integer">3</span><span class="punctuation">);</span>
<span class="ln">19 </span>
<span class="ln">20 </span>      <span class="comment single">// Read the stored event data from the queue and call the callback method for every event.
</span><span class="ln">21 </span><span class="comment single"></span>      <span class="name">mydevice</span><span class="operator">-&gt;</span><span class="name">get_events</span><span class="punctuation">(</span><span class="name">event_id</span><span class="punctuation">,</span> <span class="name">double_callback</span><span class="punctuation">);</span>
<span class="ln">22 </span>  <span class="punctuation">}</span>
<span class="ln">23 </span>
<span class="ln">24 </span>  <span class="name">event_test</span><span class="operator">-&gt;</span><span class="name">unsubscribe_event</span><span class="punctuation">(</span><span class="name">event_id</span><span class="punctuation">);</span>
</pre>
</div>
</div>
</div>
</div>
<div class="section" id="group">
<h2>Group<a class="headerlink" href="#group" title="Permalink to this headline">¶</a></h2>
<p>A Tango Group provides the user with a single point of control for a
collection of devices. By analogy, one could see a Tango Group as a
proxy for a collection of devices. For instance, the Tango Group API
supplies a <em>command_inout()</em> method to execute the same command on all
the elements of a group.</p>
<p>A Tango Group is also a hierarchical object. In other words, it is
possible to build a group of both groups and individual devices. This
feature allows creating logical views of the control system - each view
representing a hierarchical family of devices or a sub-system.</p>
<p>In this chapter, we will use the term <em>hierarchy</em> to refer to a group
and its sub-groups. The term <em>Group</em> designates to the local set of
devices attached to a specific Group.</p>
<div class="section" id="getting-started-with-tango-group">
<h3>Getting started with Tango group<a class="headerlink" href="#getting-started-with-tango-group" title="Permalink to this headline">¶</a></h3>
<p>The quickest way of getting started is to study an example…</p>
<p>Imagine we are vacuum engineers who need to monitor and control hundreds
of gauges distributed over the 16 cells of a large-scale instrument.
Each cell contains several penning and pirani gauges. It also contains
one strange gauge. Our main requirement is to be able to control the
whole set of gauges, a family of gauges located into a particular cell
(e.g. all the penning gauges of the 6th cell) or a single gauge (e.g.
the strange gauge of the 7th cell). Using a Tango Group, such features
are quite straightforward to obtain.</p>
<p>Reading the description of the problem, the device hierarchy becomes
obvious. Our gauges group will have the following structure:</p>
<pre class="code cpp literal-block">
<span class="ln"> 1 </span>  <span class="operator">-&gt;</span> <span class="name">gauges</span>
<span class="ln"> 2 </span>    <span class="operator">|</span>  <span class="operator">-&gt;</span> <span class="name">cell</span><span class="operator">-</span><span class="literal number oct">01</span>
<span class="ln"> 3 </span>    <span class="operator">|</span>     <span class="operator">|-&gt;</span> <span class="name">inst</span><span class="operator">-</span><span class="name">c01</span><span class="operator">/</span><span class="name">vac</span><span class="operator">-</span><span class="name">gauge</span><span class="operator">/</span><span class="name">strange</span>
<span class="ln"> 4 </span>    <span class="operator">|</span>     <span class="operator">|-&gt;</span> <span class="name">penning</span>
<span class="ln"> 5 </span>    <span class="operator">|</span>     <span class="operator">|</span>   <span class="operator">|-&gt;</span> <span class="name">inst</span><span class="operator">-</span><span class="name">c01</span><span class="operator">/</span><span class="name">vac</span><span class="operator">-</span><span class="name">gauge</span><span class="operator">/</span><span class="name">penning</span><span class="operator">-</span><span class="literal number oct">01</span>
<span class="ln"> 6 </span>    <span class="operator">|</span>     <span class="operator">|</span>   <span class="operator">|-&gt;</span> <span class="name">inst</span><span class="operator">-</span><span class="name">c01</span><span class="operator">/</span><span class="name">vac</span><span class="operator">-</span><span class="name">gauge</span><span class="operator">/</span><span class="name">penning</span><span class="operator">-</span><span class="literal number oct">02</span>
<span class="ln"> 7 </span>    <span class="operator">|</span>     <span class="operator">|</span>   <span class="operator">|-</span> <span class="punctuation">...</span>
<span class="ln"> 8 </span>    <span class="operator">|</span>     <span class="operator">|</span>   <span class="operator">|-&gt;</span> <span class="name">inst</span><span class="operator">-</span><span class="name">c01</span><span class="operator">/</span><span class="name">vac</span><span class="operator">-</span><span class="name">gauge</span><span class="operator">/</span><span class="name">penning</span><span class="operator">-</span><span class="name">xx</span>
<span class="ln"> 9 </span>    <span class="operator">|</span>     <span class="operator">|-&gt;</span> <span class="name">pirani</span>
<span class="ln">10 </span>    <span class="operator">|</span>         <span class="operator">|-&gt;</span> <span class="name">inst</span><span class="operator">-</span><span class="name">c01</span><span class="operator">/</span><span class="name">vac</span><span class="operator">-</span><span class="name">gauge</span><span class="operator">/</span><span class="name">pirani</span><span class="operator">-</span><span class="literal number oct">01</span>
<span class="ln">11 </span>    <span class="operator">|</span>         <span class="operator">|-&gt;</span> <span class="punctuation">...</span>
<span class="ln">12 </span>    <span class="operator">|</span>         <span class="operator">|-&gt;</span> <span class="name">inst</span><span class="operator">-</span><span class="name">c01</span><span class="operator">/</span><span class="name">vac</span><span class="operator">-</span><span class="name">gauge</span><span class="operator">/</span><span class="name">pirani</span><span class="operator">-</span><span class="name">xx</span>
<span class="ln">13 </span>    <span class="operator">|</span>  <span class="operator">-&gt;</span> <span class="name">cell</span><span class="operator">-</span><span class="literal number oct">02</span>
<span class="ln">14 </span>    <span class="operator">|</span>     <span class="operator">|-&gt;</span> <span class="name">inst</span><span class="operator">-</span><span class="name">c02</span><span class="operator">/</span><span class="name">vac</span><span class="operator">-</span><span class="name">gauge</span><span class="operator">/</span><span class="name">strange</span>
<span class="ln">15 </span>    <span class="operator">|</span>     <span class="operator">|-&gt;</span> <span class="name">penning</span>
<span class="ln">16 </span>    <span class="operator">|</span>     <span class="operator">|</span>   <span class="operator">|-&gt;</span> <span class="name">inst</span><span class="operator">-</span><span class="name">c02</span><span class="operator">/</span><span class="name">vac</span><span class="operator">-</span><span class="name">gauge</span><span class="operator">/</span><span class="name">penning</span><span class="operator">-</span><span class="literal number oct">01</span>
<span class="ln">17 </span>    <span class="operator">|</span>     <span class="operator">|</span>   <span class="operator">|-&gt;</span> <span class="punctuation">...</span>
<span class="ln">18 </span>    <span class="operator">|</span>     <span class="operator">|</span>
<span class="ln">19 </span>    <span class="operator">|</span>     <span class="operator">|-&gt;</span> <span class="name">pirani</span>
<span class="ln">20 </span>    <span class="operator">|</span>     <span class="operator">|</span>   <span class="operator">|-&gt;</span> <span class="punctuation">...</span>
<span class="ln">21 </span>    <span class="operator">|</span>  <span class="operator">-&gt;</span> <span class="name">cell</span><span class="operator">-</span><span class="literal number oct">03</span>
<span class="ln">22 </span>    <span class="operator">|</span>     <span class="operator">|-&gt;</span> <span class="punctuation">...</span>
<span class="ln">23 </span>    <span class="operator">|</span>         <span class="operator">|</span> <span class="operator">-&gt;</span> <span class="punctuation">...</span>
</pre>
<p>In the C++, such a hierarchy can be build as follows (basic version):</p>
<pre class="code cpp literal-block">
<span class="ln"> 1 </span>  <span class="comment single">//- step0: create the root group
</span><span class="ln"> 2 </span><span class="comment single"></span>  <span class="name">Tango</span><span class="operator">::</span><span class="name">Group</span> <span class="operator">*</span><span class="name">gauges</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="name">Tango</span><span class="operator">::</span><span class="name">Group</span><span class="punctuation">(</span><span class="literal string">&quot;gauges&quot;</span><span class="punctuation">);</span>
<span class="ln"> 3 </span>
<span class="ln"> 4 </span>
<span class="ln"> 5 </span>  <span class="comment single">//- step1: create a group for the n-th cell
</span><span class="ln"> 6 </span><span class="comment single"></span>  <span class="name">Tango</span><span class="operator">::</span><span class="name">Group</span> <span class="operator">*</span><span class="name">cell</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="name">Tango</span><span class="operator">::</span><span class="name">Group</span><span class="punctuation">(</span><span class="literal string">&quot;cell-01&quot;</span><span class="punctuation">);</span>
<span class="ln"> 7 </span>
<span class="ln"> 8 </span>
<span class="ln"> 9 </span>  <span class="comment single">//- step2: make the cell a sub-group of the root group
</span><span class="ln">10 </span><span class="comment single"></span>  <span class="name">gauges</span><span class="operator">-&gt;</span><span class="name">add</span><span class="punctuation">(</span><span class="name">cell</span><span class="punctuation">);</span>
<span class="ln">11 </span>
<span class="ln">12 </span>
<span class="ln">13 </span>  <span class="comment single">//- step3: create a &quot;penning&quot; group
</span><span class="ln">14 </span><span class="comment single"></span>  <span class="name">Tango</span><span class="operator">::</span><span class="name">Group</span> <span class="operator">*</span><span class="name">gauge_family</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="name">Tango</span><span class="operator">::</span><span class="name">Group</span><span class="punctuation">(</span><span class="literal string">&quot;penning&quot;</span><span class="punctuation">);</span>
<span class="ln">15 </span>
<span class="ln">16 </span>
<span class="ln">17 </span>  <span class="comment single">//- step4: add all penning gauges located into the cell (note the wildcard)
</span><span class="ln">18 </span><span class="comment single"></span>  <span class="name">gauge_family</span><span class="operator">-&gt;</span><span class="name">add</span><span class="punctuation">(</span><span class="literal string">&quot;inst-c01/vac-gauge/penning*&quot;</span><span class="punctuation">);</span>
<span class="ln">19 </span>
<span class="ln">20 </span>
<span class="ln">21 </span>  <span class="comment single">//- step5: add the penning gauges to the cell
</span><span class="ln">22 </span><span class="comment single"></span>  <span class="name">cell</span><span class="operator">-&gt;</span><span class="name">add</span><span class="punctuation">(</span><span class="name">gauge_family</span><span class="punctuation">);</span>
<span class="ln">23 </span>
<span class="ln">24 </span>
<span class="ln">25 </span>  <span class="comment single">//- step6: create a &quot;pirani&quot; group
</span><span class="ln">26 </span><span class="comment single"></span>  <span class="name">gauge_family</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="name">Tango</span><span class="operator">::</span><span class="name">Group</span><span class="punctuation">(</span><span class="literal string">&quot;pirani&quot;</span><span class="punctuation">);</span>
<span class="ln">27 </span>
<span class="ln">28 </span>
<span class="ln">29 </span>  <span class="comment single">//- step7: add all pirani gauges located into the cell (note the wildcard)
</span><span class="ln">30 </span><span class="comment single"></span>  <span class="name">gauge_family</span><span class="operator">-&gt;</span><span class="name">add</span><span class="punctuation">(</span><span class="literal string">&quot;inst-c01/vac-gauge/pirani*&quot;</span><span class="punctuation">);</span>
<span class="ln">31 </span>
<span class="ln">32 </span>
<span class="ln">33 </span>  <span class="comment single">//- step8: add the pirani gauges to the cell
</span><span class="ln">34 </span><span class="comment single"></span>  <span class="name">cell</span><span class="operator">-&gt;</span><span class="name">add</span><span class="punctuation">(</span><span class="name">gauge_family</span><span class="punctuation">);</span>
<span class="ln">35 </span>
<span class="ln">36 </span>
<span class="ln">37 </span>  <span class="comment single">//- step9: add the &quot;strange&quot; gauge to the cell
</span><span class="ln">38 </span><span class="comment single"></span>  <span class="name">cell</span><span class="operator">-&gt;</span><span class="name">add</span><span class="punctuation">(</span><span class="literal string">&quot;inst-c01/vac-gauge/strange&quot;</span><span class="punctuation">);</span>
<span class="ln">39 </span>
<span class="ln">40 </span>
<span class="ln">41 </span>  <span class="comment single">//- repeat step 1 to 9 for the remaining cells
</span><span class="ln">42 </span><span class="comment single"></span>  <span class="name">cell</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="name">Tango</span><span class="operator">::</span><span class="name">Group</span><span class="punctuation">(</span><span class="literal string">&quot;cell-02&quot;</span><span class="punctuation">);</span>
<span class="ln">43 </span>  <span class="punctuation">...</span>
</pre>
<p><strong>Important note</strong>: There is no particular order to create the
hierarchy. However, the insertion order of the devices is conserved
throughout the lifecycle of the Group and cannot be changed. That way,
the Group implementation can guarantee the order in which results are
returned (see below).</p>
<p>Keeping a reference to the root group is enough to manage the whole
hierarchy (i.e. there no need to keep trace of the sub-groups or
individual devices). The Group interface provides methods to retrieve a
sub-group or an individual device.</p>
<p>Be aware that a C++ group allways gets the ownership of its children and
deletes them when it is itself deleted. Therefore, never try to delete a
Group (respectively a DeviceProxy) returned by a call to
<em>Tango::Group::get_group()</em> (respectively to
<em>Tango::Group::get_device()</em>). Use the <em>Tango::Group::remove()</em> method
instead (see the Tango Group class API documentation for details).</p>
<p>We can now perform any action on any element of our gauges group. For
instance, let’s ping the whole hierarchy to be sure that all devices are
alive.</p>
<pre class="code cpp literal-block">
<span class="ln"> 1 </span>  <span class="comment single">//- ping the whole hierarchy
</span><span class="ln"> 2 </span><span class="comment single"></span>  <span class="keyword">if</span> <span class="punctuation">(</span><span class="name">gauges</span><span class="operator">-&gt;</span><span class="name">ping</span><span class="punctuation">()</span> <span class="operator">==</span> <span class="name builtin">true</span><span class="punctuation">)</span>
<span class="ln"> 3 </span>  <span class="punctuation">{</span>
<span class="ln"> 4 </span>      <span class="name">std</span><span class="operator">::</span><span class="name">cout</span> <span class="operator">&lt;&lt;</span> <span class="literal string">&quot;all devices alive&quot;</span> <span class="operator">&lt;&lt;</span> <span class="name">std</span><span class="operator">::</span><span class="name">endl</span><span class="punctuation">;</span>
<span class="ln"> 5 </span>  <span class="punctuation">}</span>
<span class="ln"> 6 </span>  <span class="keyword">else</span>
<span class="ln"> 7 </span>  <span class="punctuation">{</span>
<span class="ln"> 8 </span>      <span class="name">std</span><span class="operator">::</span><span class="name">cout</span> <span class="operator">&lt;&lt;</span> <span class="literal string">&quot;at least one dead/busy/locked/... device&quot;</span> <span class="operator">&lt;&lt;</span> <span class="name">std</span><span class="operator">::</span><span class="name">endl</span><span class="punctuation">;</span>
<span class="ln"> 9 </span>  <span class="punctuation">}</span>
</pre>
</div>
<div class="section" id="forward-or-not-forward">
<h3>Forward or not forward?<a class="headerlink" href="#forward-or-not-forward" title="Permalink to this headline">¶</a></h3>
<p>Since a Tango Group is a hierarchical object, any action performed on a
group can be forwarded to its sub-groups. Most of the methods in the
Group interface have a so-called <em>forward</em> option controlling this
propagation. When set to <em>false</em>, the action is only performed on the
local set of devices. Otherwise, the action is also forwarded to the
sub-groups, in other words, propagated along the hierarchy. In C++ , the
forward option defaults to true (thanks to the C++ default argument
value). There is no such mechanism in Java and the forward option must
be systematically specified.</p>
</div>
<div class="section" id="executing-a-command">
<h3>Executing a command<a class="headerlink" href="#executing-a-command" title="Permalink to this headline">¶</a></h3>
<p>As a proxy for a collection of devices, the Tango Group provides an
interface similar to the DeviceProxy’s. For the execution of a command,
the Group interface contains several implementations of the
<em>command_inout</em> method. Both synchronous and asynchronous forms are
supported.</p>
<div class="section" id="obtaining-command-results">
<h4>Obtaining command results<a class="headerlink" href="#obtaining-command-results" title="Permalink to this headline">¶</a></h4>
<p>Command results are returned using a Tango::GroupCmdReplyList. This is
nothing but a vector containing a Tango::GroupCmdReply for each device
in the group. The Tango::GroupCmdReply contains the actual data (i.e.
the Tango::DeviceData). By inheritance, it may also contain any error
occurred during the execution of the command (in which case the data is
invalid).</p>
<p>We previously indicated that the Tango Group implementation guarantees
that the command results are returned in the order in which its elements
were attached to the group. For instance, if g1 is a group containing
three devices attached in the following order:</p>
<pre class="code cpp literal-block">
<span class="ln">1 </span>  <span class="name">g1</span><span class="operator">-&gt;</span><span class="name">add</span><span class="punctuation">(</span><span class="literal string">&quot;my/device/01&quot;</span><span class="punctuation">);</span>
<span class="ln">2 </span>  <span class="name">g1</span><span class="operator">-&gt;</span><span class="name">add</span><span class="punctuation">(</span><span class="literal string">&quot;my/device/03&quot;</span><span class="punctuation">);</span>
<span class="ln">3 </span>  <span class="name">g1</span><span class="operator">-&gt;</span><span class="name">add</span><span class="punctuation">(</span><span class="literal string">&quot;my/device/02&quot;</span><span class="punctuation">);</span>
</pre>
<p>the results of</p>
<pre class="code cpp literal-block">
<span class="ln">1 </span>  <span class="name">Tango</span><span class="operator">::</span><span class="name">GroupCmdReplyList</span> <span class="name">crl</span> <span class="operator">=</span> <span class="name">g1</span><span class="operator">-&gt;</span><span class="name">command_inout</span><span class="punctuation">(</span><span class="literal string">&quot;Status&quot;</span><span class="punctuation">);</span>
</pre>
<p>will be organized as follows:</p>
<div class="line-block">
<div class="line"><em>crl[0]</em> contains the status of my/device/01</div>
<div class="line"><em>crl[1]</em> contains the status of my/device/03</div>
<div class="line"><em>crl[2]</em> contains the status of my/device/02</div>
</div>
<p>Things get more complicated if sub-groups are added between devices.</p>
<pre class="code cpp literal-block">
<span class="ln"> 1 </span>  <span class="name">g2</span><span class="operator">-&gt;</span><span class="name">add</span><span class="punctuation">(</span><span class="literal string">&quot;my/device/04&quot;</span><span class="punctuation">);</span>
<span class="ln"> 2 </span>  <span class="name">g2</span><span class="operator">-&gt;</span><span class="name">add</span><span class="punctuation">(</span><span class="literal string">&quot;my/device/05&quot;</span><span class="punctuation">);</span>
<span class="ln"> 3 </span>
<span class="ln"> 4 </span>
<span class="ln"> 5 </span>  <span class="name">g4</span><span class="operator">-&gt;</span><span class="name">add</span><span class="punctuation">(</span><span class="literal string">&quot;my/device/08&quot;</span><span class="punctuation">);</span>
<span class="ln"> 6 </span>  <span class="name">g4</span><span class="operator">-&gt;</span><span class="name">add</span><span class="punctuation">(</span><span class="literal string">&quot;my/device/09&quot;</span><span class="punctuation">);</span>
<span class="ln"> 7 </span>
<span class="ln"> 8 </span>
<span class="ln"> 9 </span>  <span class="name">g3</span><span class="operator">-&gt;</span><span class="name">add</span><span class="punctuation">(</span><span class="literal string">&quot;my/device/06&quot;</span><span class="punctuation">);</span>
<span class="ln">10 </span>  <span class="name">g3</span><span class="operator">-&gt;</span><span class="name">add</span><span class="punctuation">(</span><span class="name">g4</span><span class="punctuation">);</span>
<span class="ln">11 </span>  <span class="name">g3</span><span class="operator">-&gt;</span><span class="name">add</span><span class="punctuation">(</span><span class="literal string">&quot;my/device/07&quot;</span><span class="punctuation">);</span>
<span class="ln">12 </span>
<span class="ln">13 </span>
<span class="ln">14 </span>  <span class="name">g1</span><span class="operator">-&gt;</span><span class="name">add</span><span class="punctuation">(</span><span class="literal string">&quot;my/device/01&quot;</span><span class="punctuation">);</span>
<span class="ln">15 </span>  <span class="name">g1</span><span class="operator">-&gt;</span><span class="name">add</span><span class="punctuation">(</span><span class="name">g2</span><span class="punctuation">);</span>
<span class="ln">16 </span>  <span class="name">g1</span><span class="operator">-&gt;</span><span class="name">add</span><span class="punctuation">(</span><span class="literal string">&quot;my/device/03&quot;</span><span class="punctuation">);</span>
<span class="ln">17 </span>  <span class="name">g1</span><span class="operator">-&gt;</span><span class="name">add</span><span class="punctuation">(</span><span class="name">g3</span><span class="punctuation">);</span>
<span class="ln">18 </span>  <span class="name">g1</span><span class="operator">-&gt;</span><span class="name">add</span><span class="punctuation">(</span><span class="literal string">&quot;my/device/02&quot;</span><span class="punctuation">);</span>
</pre>
<p>The result order in the Tango::GroupCmdReplyList depends on the value of
the forward option. If set to <em>true</em>, the results will be organized as
follows:</p>
<pre class="code cpp literal-block">
<span class="ln">1 </span>  <span class="name">Tango</span><span class="operator">::</span><span class="name">GroupCmdReplyList</span> <span class="name">crl</span> <span class="operator">=</span> <span class="name">g1</span><span class="operator">-&gt;</span><span class="name">command_inout</span><span class="punctuation">(</span><span class="literal string">&quot;Status&quot;</span><span class="punctuation">,</span> <span class="name builtin">true</span><span class="punctuation">);</span>
</pre>
<div class="line-block">
<div class="line"><em>crl[0]</em> contains the status of my/device/01 which belongs to g1</div>
<div class="line"><em>crl[1]</em> contains the status of my/device/04 which belongs to g1.g2</div>
<div class="line"><em>crl[2]</em> contains the status of my/device/05 which belongs to g1.g2</div>
<div class="line"><em>crl[3]</em> contains the status of my/device/03 which belongs to g1</div>
<div class="line"><em>crl[4]</em> contains the status of my/device/06 which belongs to g1.g3</div>
<div class="line"><em>crl[5]</em> contains the status of my/device/08 which belongs to g1.g3.g4</div>
<div class="line"><em>crl[6]</em> contains the status of my/device/09 which belongs to g1.g3.g</div>
<div class="line"><em>crl[7]</em> contains the status of my/device/07 which belongs to g1.g3</div>
<div class="line"><em>crl[8]</em> contains the status of my/device/02 which belongs to g1</div>
</div>
<p>If the forward option is set to <em>false</em>, the results are:</p>
<pre class="code cpp literal-block">
<span class="ln">1 </span>  <span class="name">Tango</span><span class="operator">::</span><span class="name">GroupCmdReplyList</span> <span class="name">crl</span> <span class="operator">=</span> <span class="name">g1</span><span class="operator">-&gt;</span><span class="name">command_inout</span><span class="punctuation">(</span><span class="literal string">&quot;Status&quot;</span><span class="punctuation">,</span> <span class="name builtin">false</span><span class="punctuation">);</span>
</pre>
<div class="line-block">
<div class="line"><em>crl[0]</em> contains the status of my/device/01 which belongs to g</div>
<div class="line"><em>crl[1]</em> contains the status of my/device/03 which belongs to g1</div>
<div class="line"><em>crl[2]</em> contains the status of my/device/02 which belongs to g1</div>
</div>
<p>The Tango::GroupCmdReply contains some public members allowing the
identification of both the device (Tango::GroupCmdReply::dev_name) and
the command (Tango::GroupCmdReply::obj_name). It means that, depending
of your application, you can associate a response with its source using
its position in the response list or using the
Tango::GroupCmdReply::dev_name member.</p>
</div>
<div class="section" id="case-1-a-command-no-argument">
<h4>Case 1: a command, no argument<a class="headerlink" href="#case-1-a-command-no-argument" title="Permalink to this headline">¶</a></h4>
<p>As an example, we execute the Status command on the whole hierarchy
synchronously.</p>
<pre class="code cpp literal-block">
<span class="ln">1 </span>  <span class="name">Tango</span><span class="operator">::</span><span class="name">GroupCmdReplyList</span> <span class="name">crl</span> <span class="operator">=</span> <span class="name">gauges</span><span class="operator">-&gt;</span><span class="name">command_inout</span><span class="punctuation">(</span><span class="literal string">&quot;Status&quot;</span><span class="punctuation">);</span>
</pre>
<p>As a first step in the results processing, it could be interesting to
check value returned by the <em>has_failed()</em> method of the
GroupCmdReplyList. If it is set to true, it means that at least one
error occurred during the execution of the command (i.e. at least one
device gave error).</p>
<pre class="code cpp literal-block">
<span class="ln">1 </span>  <span class="keyword">if</span> <span class="punctuation">(</span><span class="name">crl</span><span class="punctuation">.</span><span class="name">has_failed</span><span class="punctuation">())</span>
<span class="ln">2 </span>  <span class="punctuation">{</span>
<span class="ln">3 </span>      <span class="name">cout</span> <span class="operator">&lt;&lt;</span> <span class="literal string">&quot;at least one error occurred&quot;</span> <span class="operator">&lt;&lt;</span> <span class="name">endl</span><span class="punctuation">;</span>
<span class="ln">4 </span>  <span class="punctuation">}</span>
<span class="ln">5 </span>  <span class="keyword">else</span>
<span class="ln">6 </span>  <span class="punctuation">{</span>
<span class="ln">7 </span>      <span class="name">cout</span> <span class="operator">&lt;&lt;</span> <span class="literal string">&quot;no error &quot;</span> <span class="operator">&lt;&lt;</span> <span class="name">endl</span><span class="punctuation">;</span>
<span class="ln">8 </span>  <span class="punctuation">}</span>
</pre>
<p>Now, we have to process each individual response in the list.</p>
</div>
<div class="section" id="a-few-words-on-error-handling-and-data-extraction">
<h4>A few words on error handling and data extraction<a class="headerlink" href="#a-few-words-on-error-handling-and-data-extraction" title="Permalink to this headline">¶</a></h4>
<p>Depending of the application and/or the developer’s programming habits,
each individual error can be handle by the C++ (or Java) exception
mechanism or using the dedicated <em>has_failed()</em> method. The GroupReply
class - which is the mother class of both GroupCmdReply and
GroupAttrReply - contains a static method to enable (or disable)
exceptions called <em>enable_exception()</em>. By default, exceptions are
disabled. The following example is proposed with both exceptions enable
and disable.</p>
<p>In C++, data can be extracted directly from an individual reply. The
GroupCmdReply interface contains a template operator &gt;&gt; allowing the
extraction of any supported Tango type (in fact the actual data
extraction is delegated to DeviceData::operator &gt;&gt;). One dedicated
extract method is also provided in order to extract
DevVarLongStringArray and DevVarDoubleStringArray types to std::vectors.</p>
<p>Error and data handling C++ example:</p>
<pre class="code cpp literal-block">
<span class="ln"> 1 </span>  <span class="comment single">//-------------------------------------------------------
</span><span class="ln"> 2 </span><span class="comment single"></span>  <span class="comment single">//- synch. group command example with exception enabled
</span><span class="ln"> 3 </span><span class="comment single"></span>  <span class="comment single">//-------------------------------------------------------
</span><span class="ln"> 4 </span><span class="comment single"></span>  <span class="comment single">//- enable exceptions and save current mode
</span><span class="ln"> 5 </span><span class="comment single"></span>  <span class="keyword type">bool</span> <span class="name">last_mode</span> <span class="operator">=</span> <span class="name">GroupReply</span><span class="operator">::</span><span class="name">enable_exception</span><span class="punctuation">(</span><span class="name builtin">true</span><span class="punctuation">);</span>
<span class="ln"> 6 </span>  <span class="comment single">//- process each response in the list ...
</span><span class="ln"> 7 </span><span class="comment single"></span>  <span class="keyword">for</span> <span class="punctuation">(</span><span class="keyword type">int</span> <span class="name">r</span> <span class="operator">=</span> <span class="literal number integer">0</span><span class="punctuation">;</span> <span class="name">r</span> <span class="operator">&lt;</span> <span class="name">crl</span><span class="punctuation">.</span><span class="name">size</span><span class="punctuation">();</span> <span class="name">r</span><span class="operator">++</span><span class="punctuation">)</span>
<span class="ln"> 8 </span>  <span class="punctuation">{</span>
<span class="ln"> 9 </span>  <span class="comment single">//- enter a try/catch block
</span><span class="ln">10 </span><span class="comment single"></span>     <span class="keyword">try</span>
<span class="ln">11 </span>     <span class="punctuation">{</span>
<span class="ln">12 </span>  <span class="comment single">//- try to extract the data from the r-th reply
</span><span class="ln">13 </span><span class="comment single"></span>  <span class="comment single">//- suppose data contains a double
</span><span class="ln">14 </span><span class="comment single"></span>         <span class="keyword type">double</span> <span class="name">ans</span><span class="punctuation">;</span>
<span class="ln">15 </span>         <span class="name">crl</span><span class="punctuation">[</span><span class="name">r</span><span class="punctuation">]</span> <span class="operator">&gt;&gt;</span> <span class="name">ans</span><span class="punctuation">;</span>
<span class="ln">16 </span>         <span class="name">cout</span> <span class="operator">&lt;&lt;</span> <span class="name">crl</span><span class="punctuation">[</span><span class="name">r</span><span class="punctuation">].</span><span class="name">dev_name</span><span class="punctuation">()</span>
<span class="ln">17 </span>              <span class="operator">&lt;&lt;</span> <span class="literal string">&quot;::&quot;</span>
<span class="ln">18 </span>              <span class="operator">&lt;&lt;</span> <span class="name">crl</span><span class="punctuation">[</span><span class="name">r</span><span class="punctuation">].</span><span class="name">obj_name</span><span class="punctuation">()</span>
<span class="ln">19 </span>              <span class="operator">&lt;&lt;</span> <span class="literal string">&quot; returned &quot;</span>
<span class="ln">20 </span>              <span class="operator">&lt;&lt;</span> <span class="name">ans</span>
<span class="ln">21 </span>              <span class="operator">&lt;&lt;</span> <span class="name">endl</span><span class="punctuation">;</span>
<span class="ln">22 </span>      <span class="punctuation">}</span>
<span class="ln">23 </span>      <span class="keyword">catch</span> <span class="punctuation">(</span><span class="keyword">const</span> <span class="name">DevFailed</span><span class="operator">&amp;</span> <span class="name">df</span><span class="punctuation">)</span>
<span class="ln">24 </span>      <span class="punctuation">{</span>
<span class="ln">25 </span>  <span class="comment single">//- DevFailed caught while trying to extract the data from reply
</span><span class="ln">26 </span><span class="comment single"></span>        <span class="keyword">for</span> <span class="punctuation">(</span><span class="keyword type">int</span> <span class="name">err</span> <span class="operator">=</span> <span class="literal number integer">0</span><span class="punctuation">;</span> <span class="name">err</span> <span class="operator">&lt;</span> <span class="name">df</span><span class="punctuation">.</span><span class="name">errors</span><span class="punctuation">.</span><span class="name">length</span><span class="punctuation">();</span> <span class="name">err</span><span class="operator">++</span><span class="punctuation">)</span>
<span class="ln">27 </span>        <span class="punctuation">{</span>
<span class="ln">28 </span>             <span class="name">cout</span> <span class="operator">&lt;&lt;</span> <span class="literal string">&quot;error: &quot;</span> <span class="operator">&lt;&lt;</span> <span class="name">df</span><span class="punctuation">.</span><span class="name">errors</span><span class="punctuation">[</span><span class="name">err</span><span class="punctuation">].</span><span class="name">desc</span><span class="punctuation">.</span><span class="name">in</span><span class="punctuation">()</span> <span class="operator">&lt;&lt;</span> <span class="name">endl</span><span class="punctuation">;</span>
<span class="ln">29 </span>        <span class="punctuation">}</span>
<span class="ln">30 </span>  <span class="comment single">//- alternatively, one can use crl[r].get_err_stack() see below
</span><span class="ln">31 </span><span class="comment single"></span>      <span class="punctuation">}</span>
<span class="ln">32 </span>      <span class="keyword">catch</span> <span class="punctuation">(...)</span>
<span class="ln">33 </span>      <span class="punctuation">{</span>
<span class="ln">34 </span>         <span class="name">cout</span> <span class="operator">&lt;&lt;</span> <span class="literal string">&quot;unknown exception caught&quot;</span><span class="punctuation">;</span>
<span class="ln">35 </span>      <span class="punctuation">}</span>
<span class="ln">36 </span>  <span class="punctuation">}</span>
<span class="ln">37 </span>  <span class="comment single">//- restore last exception mode (if needed)
</span><span class="ln">38 </span><span class="comment single"></span>  <span class="name">GroupReply</span><span class="operator">::</span><span class="name">enable_exception</span><span class="punctuation">(</span><span class="name">last_mode</span><span class="punctuation">);</span>
<span class="ln">39 </span>  <span class="comment single">//- Clear the response list (if reused later in the code)
</span><span class="ln">40 </span><span class="comment single"></span>  <span class="name">crl</span><span class="punctuation">.</span><span class="name">reset</span><span class="punctuation">();</span>
<span class="ln">41 </span>
<span class="ln">42 </span>
<span class="ln">43 </span>  <span class="comment single">//-------------------------------------------------------
</span><span class="ln">44 </span><span class="comment single"></span>  <span class="comment single">//- synch. group command example with exception disabled
</span><span class="ln">45 </span><span class="comment single"></span>  <span class="comment single">//-------------------------------------------------------
</span><span class="ln">46 </span><span class="comment single"></span>  <span class="comment single">//- disable exceptions and save current mode bool
</span><span class="ln">47 </span><span class="comment single"></span>  <span class="name">last_mode</span> <span class="operator">=</span> <span class="name">GroupReply</span><span class="operator">::</span><span class="name">enable_exception</span><span class="punctuation">(</span><span class="name builtin">false</span><span class="punctuation">);</span>
<span class="ln">48 </span>  <span class="comment single">//- process each response in the list ...
</span><span class="ln">49 </span><span class="comment single"></span>  <span class="keyword">for</span> <span class="punctuation">(</span><span class="keyword type">int</span> <span class="name">r</span> <span class="operator">=</span> <span class="literal number integer">0</span><span class="punctuation">;</span> <span class="name">r</span> <span class="operator">&lt;</span> <span class="name">crl</span><span class="punctuation">.</span><span class="name">size</span><span class="punctuation">();</span> <span class="name">r</span><span class="operator">++</span><span class="punctuation">)</span>
<span class="ln">50 </span>  <span class="punctuation">{</span>
<span class="ln">51 </span>  <span class="comment single">//- did the r-th device give error?
</span><span class="ln">52 </span><span class="comment single"></span>      <span class="keyword">if</span> <span class="punctuation">(</span><span class="name">crl</span><span class="punctuation">[</span><span class="name">r</span><span class="punctuation">].</span><span class="name">has_failed</span><span class="punctuation">()</span> <span class="operator">==</span> <span class="name builtin">true</span><span class="punctuation">)</span>
<span class="ln">53 </span>      <span class="punctuation">{</span>
<span class="ln">54 </span>  <span class="comment single">//- printout error description
</span><span class="ln">55 </span><span class="comment single"></span>         <span class="name">cout</span> <span class="operator">&lt;&lt;</span> <span class="literal string">&quot;an error occurred while executing &quot;</span>
<span class="ln">56 </span>              <span class="operator">&lt;&lt;</span> <span class="name">crl</span><span class="punctuation">[</span><span class="name">r</span><span class="punctuation">].</span><span class="name">obj_name</span><span class="punctuation">()</span>
<span class="ln">57 </span>              <span class="operator">&lt;&lt;</span> <span class="literal string">&quot; on &quot;</span>
<span class="ln">58 </span>              <span class="operator">&lt;&lt;</span> <span class="name">crl</span><span class="punctuation">[</span><span class="name">r</span><span class="punctuation">].</span><span class="name">dev_name</span><span class="punctuation">()</span> <span class="operator">&lt;&lt;</span> <span class="name">endl</span><span class="punctuation">;</span>
<span class="ln">59 </span>  <span class="comment single">//- dump error stack
</span><span class="ln">60 </span><span class="comment single"></span>         <span class="keyword">const</span> <span class="name">DevErrorList</span><span class="operator">&amp;</span> <span class="name">el</span> <span class="operator">=</span> <span class="name">crl</span><span class="punctuation">[</span><span class="name">r</span><span class="punctuation">].</span><span class="name">get_err_stack</span><span class="punctuation">();</span>
<span class="ln">61 </span>         <span class="keyword">for</span> <span class="punctuation">(</span><span class="keyword type">int</span> <span class="name">err</span> <span class="operator">=</span> <span class="literal number integer">0</span><span class="punctuation">;</span> <span class="name">err</span> <span class="operator">&lt;</span> <span class="name">el</span><span class="punctuation">.</span><span class="name">size</span><span class="punctuation">();</span> <span class="name">err</span><span class="operator">++</span><span class="punctuation">)</span>
<span class="ln">62 </span>         <span class="punctuation">{</span>
<span class="ln">63 </span>             <span class="name">cout</span> <span class="operator">&lt;&lt;</span> <span class="name">el</span><span class="punctuation">[</span><span class="name">err</span><span class="punctuation">].</span><span class="name">desc</span><span class="punctuation">.</span><span class="name">in</span><span class="punctuation">();</span>
<span class="ln">64 </span>         <span class="punctuation">}</span>
<span class="ln">65 </span>      <span class="punctuation">}</span>
<span class="ln">66 </span>      <span class="keyword">else</span>
<span class="ln">67 </span>      <span class="punctuation">{</span>
<span class="ln">68 </span>  <span class="comment single">//- no error (suppose data contains a double)
</span><span class="ln">69 </span><span class="comment single"></span>         <span class="keyword type">double</span> <span class="name">ans</span><span class="punctuation">;</span>
<span class="ln">70 </span>         <span class="keyword type">bool</span> <span class="name">result</span> <span class="operator">=</span> <span class="name">crl</span><span class="punctuation">[</span><span class="name">r</span><span class="punctuation">]</span> <span class="operator">&gt;&gt;</span> <span class="name">ans</span><span class="punctuation">;</span>
<span class="ln">71 </span>         <span class="keyword">if</span> <span class="punctuation">(</span><span class="name">result</span> <span class="operator">==</span> <span class="name builtin">false</span><span class="punctuation">)</span>
<span class="ln">72 </span>         <span class="punctuation">{</span>
<span class="ln">73 </span>             <span class="name">cout</span> <span class="operator">&lt;&lt;</span> <span class="literal string">&quot;could not extract double from &quot;</span>
<span class="ln">74 </span>                  <span class="operator">&lt;&lt;</span> <span class="name">crl</span><span class="punctuation">[</span><span class="name">r</span><span class="punctuation">].</span><span class="name">dev_name</span><span class="punctuation">()</span>
<span class="ln">75 </span>                  <span class="operator">&lt;&lt;</span> <span class="literal string">&quot; reply&quot;</span>
<span class="ln">76 </span>                  <span class="operator">&lt;&lt;</span> <span class="name">endl</span><span class="punctuation">;</span>
<span class="ln">77 </span>         <span class="punctuation">}</span>
<span class="ln">78 </span>         <span class="keyword">else</span>
<span class="ln">79 </span>         <span class="punctuation">{</span>
<span class="ln">80 </span>             <span class="name">cout</span> <span class="operator">&lt;&lt;</span> <span class="name">crl</span><span class="punctuation">[</span><span class="name">r</span><span class="punctuation">].</span><span class="name">dev_name</span><span class="punctuation">()</span>
<span class="ln">81 </span>                  <span class="operator">&lt;&lt;</span> <span class="literal string">&quot;::&quot;</span>
<span class="ln">82 </span>                  <span class="operator">&lt;&lt;</span> <span class="name">crl</span><span class="punctuation">[</span><span class="name">r</span><span class="punctuation">].</span><span class="name">obj_name</span><span class="punctuation">()</span>
<span class="ln">83 </span>                  <span class="operator">&lt;&lt;</span> <span class="literal string">&quot; returned &quot;</span>
<span class="ln">84 </span>                  <span class="operator">&lt;&lt;</span> <span class="name">ans</span>
<span class="ln">85 </span>                  <span class="operator">&lt;&lt;</span> <span class="name">endl</span><span class="punctuation">;</span>
<span class="ln">86 </span>         <span class="punctuation">}</span>
<span class="ln">87 </span>      <span class="punctuation">}</span>
<span class="ln">88 </span>  <span class="punctuation">}</span>
<span class="ln">89 </span>  <span class="comment single">//- restore last exception mode (if needed)
</span><span class="ln">90 </span><span class="comment single"></span>  <span class="name">GroupReply</span><span class="operator">::</span><span class="name">enable_exception</span><span class="punctuation">(</span><span class="name">last_mode</span><span class="punctuation">);</span>
<span class="ln">91 </span>  <span class="comment single">//- Clear the response list (if reused later in the code)
</span><span class="ln">92 </span><span class="comment single"></span>  <span class="name">crl</span><span class="punctuation">.</span><span class="name">reset</span><span class="punctuation">();</span>
</pre>
<p>Now execute the same command asynchronously. C++ example:</p>
<pre class="code cpp literal-block">
<span class="ln"> 1 </span>  <span class="comment single">//-------------------------------------------------------
</span><span class="ln"> 2 </span><span class="comment single"></span>  <span class="comment single">//- asynch. group command example (C++ example)
</span><span class="ln"> 3 </span><span class="comment single"></span>  <span class="comment single">//-------------------------------------------------------
</span><span class="ln"> 4 </span><span class="comment single"></span>  <span class="keyword type">long</span> <span class="name">request_id</span> <span class="operator">=</span> <span class="name">gauges</span><span class="operator">-&gt;</span><span class="name">command_inout_asynch</span><span class="punctuation">(</span><span class="literal string">&quot;Status&quot;</span><span class="punctuation">);</span>
<span class="ln"> 5 </span>  <span class="comment single">//- do some work
</span><span class="ln"> 6 </span><span class="comment single"></span>  <span class="name">do_some_work</span><span class="punctuation">();</span>
<span class="ln"> 7 </span>
<span class="ln"> 8 </span>
<span class="ln"> 9 </span>  <span class="comment single">//- get results
</span><span class="ln">10 </span><span class="comment single"></span>  <span class="name">crl</span> <span class="operator">=</span> <span class="name">gauges</span><span class="operator">-&gt;</span><span class="name">command_inout_reply</span><span class="punctuation">(</span><span class="name">request_id</span><span class="punctuation">);</span>
<span class="ln">11 </span>  <span class="comment single">//- process responses as previously describe in the synch. implementation
</span><span class="ln">12 </span><span class="comment single"></span>  <span class="keyword">for</span> <span class="punctuation">(</span><span class="keyword type">int</span> <span class="name">r</span> <span class="operator">=</span> <span class="literal number integer">0</span><span class="punctuation">;</span> <span class="name">r</span> <span class="operator">&lt;</span> <span class="name">crl</span><span class="punctuation">.</span><span class="name">size</span><span class="punctuation">();</span> <span class="name">r</span><span class="operator">++</span><span class="punctuation">)</span>
<span class="ln">13 </span>  <span class="punctuation">{</span>
<span class="ln">14 </span>  <span class="comment single">//- data processing and error handling goes here
</span><span class="ln">15 </span><span class="comment single"></span>  <span class="comment single">//- copy/paste code from previous example
</span><span class="ln">16 </span><span class="comment single"></span>  <span class="punctuation">.</span> <span class="punctuation">.</span> <span class="punctuation">.</span>
<span class="ln">17 </span>  <span class="punctuation">}</span>
<span class="ln">18 </span>  <span class="comment single">//- clear the response list (if reused later in the code)
</span><span class="ln">19 </span><span class="comment single"></span>  <span class="name">crl</span><span class="punctuation">.</span><span class="name">reset</span><span class="punctuation">();</span>
</pre>
</div>
<div class="section" id="case-2-a-command-one-argument">
<h4>Case 2: a command, one argument<a class="headerlink" href="#case-2-a-command-one-argument" title="Permalink to this headline">¶</a></h4>
<p>Here, we give an example in which the same input argument is applied to
all devices in the group (or its sub-groups).</p>
<p>In C++:</p>
<pre class="code cpp literal-block">
<span class="ln">1 </span>  <span class="comment single">//- the argument value
</span><span class="ln">2 </span><span class="comment single"></span>  <span class="keyword type">double</span> <span class="name">d</span> <span class="operator">=</span> <span class="literal number float">0.1</span><span class="punctuation">;</span>
<span class="ln">3 </span>  <span class="comment single">//- insert it into the TANGO generic container for command: DeviceData
</span><span class="ln">4 </span><span class="comment single"></span>  <span class="name">Tango</span><span class="operator">::</span><span class="name">DeviceData</span> <span class="name">dd</span><span class="punctuation">;</span>
<span class="ln">5 </span>  <span class="name">dd</span> <span class="operator">&lt;&lt;</span> <span class="name">d</span><span class="punctuation">;</span>
<span class="ln">6 </span>  <span class="comment single">//- execute the command: Dev_Void SetDummyFactor (Dev_Double)
</span><span class="ln">7 </span><span class="comment single"></span>  <span class="name">Tango</span><span class="operator">::</span><span class="name">GroupCmdReplyList</span> <span class="name">crl</span> <span class="operator">=</span> <span class="name">gauges</span><span class="operator">-&gt;</span><span class="name">command_inout</span><span class="punctuation">(</span><span class="literal string">&quot;SetDummyFactor&quot;</span><span class="punctuation">,</span> <span class="name">dd</span><span class="punctuation">);</span>
</pre>
<p>Since the SetDummyFactor command does not return any value, the
individual replies (i.e. the GroupCmdReply) do not contain any data.
However, we have to check their <em>has_failed()</em> method returned value to
be sure that the command completed successfully on each device
(acknowledgement). Note that in such a case, exceptions are useless
since we never try to extract data from the replies.</p>
<p>In C++ we should have something like:</p>
<pre class="code cpp literal-block">
<span class="ln"> 1 </span>  <span class="comment single">//- no need to process the results if no error occurred (Dev_Void command)
</span><span class="ln"> 2 </span><span class="comment single"></span>  <span class="keyword">if</span> <span class="punctuation">(</span><span class="name">crl</span><span class="punctuation">.</span><span class="name">has_failed</span><span class="punctuation">())</span>
<span class="ln"> 3 </span>  <span class="punctuation">{</span>
<span class="ln"> 4 </span>  <span class="comment single">//- at least one error occurred
</span><span class="ln"> 5 </span><span class="comment single"></span>      <span class="keyword">for</span> <span class="punctuation">(</span><span class="keyword type">int</span> <span class="name">r</span> <span class="operator">=</span> <span class="literal number integer">0</span><span class="punctuation">;</span> <span class="name">r</span> <span class="operator">&lt;</span> <span class="name">crl</span><span class="punctuation">.</span><span class="name">size</span><span class="punctuation">();</span> <span class="name">r</span><span class="operator">++</span><span class="punctuation">)</span>
<span class="ln"> 6 </span>      <span class="punctuation">{</span>
<span class="ln"> 7 </span>  <span class="comment single">//- handle errors here (see previous C++ examples)
</span><span class="ln"> 8 </span><span class="comment single"></span>      <span class="punctuation">}</span>
<span class="ln"> 9 </span>  <span class="punctuation">}</span>
<span class="ln">10 </span>  <span class="comment single">//- clear the response list (if reused later in the code)
</span><span class="ln">11 </span><span class="comment single"></span>  <span class="name">crl</span><span class="punctuation">.</span><span class="name">reset</span><span class="punctuation">();</span>
</pre>
<p>See case 1 for an example of asynchronous command.</p>
</div>
<div class="section" id="case-3-a-command-several-arguments">
<h4>Case 3: a command, several arguments<a class="headerlink" href="#case-3-a-command-several-arguments" title="Permalink to this headline">¶</a></h4>
<p>Here, we give an example in which a <strong>specific</strong> input argument is
applied to each device in the hierarchy. In order to use this form of
command_inout, the user must have an a priori and perfect knowledge of
the devices order in the hierarchy. In such a case, command arguments
are passed in an array (with one entry for each device in the
hierarchy).</p>
<p>The C++ implementation provides a template method which accepts a
std::vector of C++ type for command argument. This allows passing any
kind of data using a single method.</p>
<p>The size of this vector must equal the number of device in the hierarchy
(respectively the number of device in the group) if the forward option
is set to true (respectively set to false). Otherwise, an exception is
thrown.</p>
<p>The first item in the vector is applied to the first device in the
hierarchy, the second to the second device in the hierarchy, and so
on…That’s why the user must have a perfect knowledge of the devices
order in the hierarchy.</p>
<p>Assuming that gauges are ordered by name, the SetDummyFactor command can
be executed on group cell-01 (and its sub-groups) as follows:</p>
<p>Remember, cell-01 has the following internal structure:</p>
<pre class="code cpp literal-block">
<span class="ln"> 1 </span>  <span class="operator">-&gt;</span> <span class="name">gauges</span>
<span class="ln"> 2 </span>     <span class="operator">|</span> <span class="operator">-&gt;</span> <span class="name">cell</span><span class="operator">-</span><span class="literal number oct">01</span>
<span class="ln"> 3 </span>     <span class="operator">|</span>    <span class="operator">|-&gt;</span> <span class="name">inst</span><span class="operator">-</span><span class="name">c01</span><span class="operator">/</span><span class="name">vac</span><span class="operator">-</span><span class="name">gauge</span><span class="operator">/</span><span class="name">strange</span>
<span class="ln"> 4 </span>     <span class="operator">|</span>    <span class="operator">|-&gt;</span> <span class="name">penning</span>
<span class="ln"> 5 </span>     <span class="operator">|</span>    <span class="operator">|</span>   <span class="operator">|-&gt;</span> <span class="name">inst</span><span class="operator">-</span><span class="name">c01</span><span class="operator">/</span><span class="name">vac</span><span class="operator">-</span><span class="name">gauge</span><span class="operator">/</span><span class="name">penning</span><span class="operator">-</span><span class="literal number oct">01</span>
<span class="ln"> 6 </span>     <span class="operator">|</span>    <span class="operator">|</span>   <span class="operator">|-&gt;</span> <span class="name">inst</span><span class="operator">-</span><span class="name">c01</span><span class="operator">/</span><span class="name">vac</span><span class="operator">-</span><span class="name">gauge</span><span class="operator">/</span><span class="name">penning</span><span class="operator">-</span><span class="literal number oct">02</span>
<span class="ln"> 7 </span>     <span class="operator">|</span>    <span class="operator">|</span>   <span class="operator">|-&gt;</span> <span class="punctuation">...</span>
<span class="ln"> 8 </span>     <span class="operator">|</span>    <span class="operator">|</span>   <span class="operator">|-&gt;</span> <span class="name">inst</span><span class="operator">-</span><span class="name">c01</span><span class="operator">/</span><span class="name">vac</span><span class="operator">-</span><span class="name">gauge</span><span class="operator">/</span><span class="name">penning</span><span class="operator">-</span><span class="name">xx</span>
<span class="ln"> 9 </span>     <span class="operator">|</span>    <span class="operator">|-&gt;</span> <span class="name">pirani</span>
<span class="ln">10 </span>     <span class="operator">|</span>        <span class="operator">|-&gt;</span> <span class="name">inst</span><span class="operator">-</span><span class="name">c01</span><span class="operator">/</span><span class="name">vac</span><span class="operator">-</span><span class="name">gauge</span><span class="operator">/</span><span class="name">pirani</span><span class="operator">-</span><span class="literal number oct">01</span>
<span class="ln">11 </span>     <span class="operator">|</span>        <span class="operator">|-&gt;</span> <span class="punctuation">...</span>
<span class="ln">12 </span>     <span class="operator">|</span>        <span class="operator">|-&gt;</span> <span class="name">inst</span><span class="operator">-</span><span class="name">c01</span><span class="operator">/</span><span class="name">vac</span><span class="operator">-</span><span class="name">gauge</span><span class="operator">/</span><span class="name">pirani</span><span class="operator">-</span><span class="name">xx</span>
</pre>
<p>Passing a specific argument to each device in C++:</p>
<pre class="code cpp literal-block">
<span class="ln"> 1 </span>  <span class="comment single">//- get a reference to the target group
</span><span class="ln"> 2 </span><span class="comment single"></span>  <span class="name">Tango</span><span class="operator">::</span><span class="name">Group</span> <span class="operator">*</span><span class="name">g</span> <span class="operator">=</span> <span class="name">gauges</span><span class="operator">-&gt;</span><span class="name">get_group</span><span class="punctuation">(</span><span class="literal string">&quot;cell-01&quot;</span><span class="punctuation">);</span>
<span class="ln"> 3 </span>  <span class="comment single">//- get number of device in the hierarchy (starting at cell-01)
</span><span class="ln"> 4 </span><span class="comment single"></span>  <span class="keyword type">long</span> <span class="name">n_dev</span> <span class="operator">=</span> <span class="name">g</span><span class="operator">-&gt;</span><span class="name">get_size</span><span class="punctuation">(</span><span class="name builtin">true</span><span class="punctuation">);</span>
<span class="ln"> 5 </span>  <span class="comment single">//- Build argin list
</span><span class="ln"> 6 </span><span class="comment single"></span>  <span class="name">std</span><span class="operator">::</span><span class="name">vector</span><span class="operator">&lt;</span><span class="keyword type">double</span><span class="operator">&gt;</span> <span class="name">argins</span><span class="punctuation">(</span><span class="name">n_dev</span><span class="punctuation">);</span>
<span class="ln"> 7 </span>  <span class="comment single">//- argument for inst-c01/vac-gauge/strange
</span><span class="ln"> 8 </span><span class="comment single"></span>  <span class="name">argins</span><span class="punctuation">[</span><span class="literal number integer">0</span><span class="punctuation">]</span> <span class="operator">=</span> <span class="literal number float">0.0</span><span class="punctuation">;</span>
<span class="ln"> 9 </span>  <span class="comment single">//- argument for inst-c01/vac-gauge/penning-01
</span><span class="ln">10 </span><span class="comment single"></span>  <span class="name">argins</span><span class="punctuation">[</span><span class="literal number integer">1</span><span class="punctuation">]</span> <span class="operator">=</span> <span class="literal number float">0.1</span><span class="punctuation">;</span>
<span class="ln">11 </span>  <span class="comment single">//- argument for inst-c01/vac-gauge/penning-02
</span><span class="ln">12 </span><span class="comment single"></span>  <span class="name">argins</span><span class="punctuation">[</span><span class="literal number integer">2</span><span class="punctuation">]</span> <span class="operator">=</span> <span class="literal number float">0.2</span><span class="punctuation">;</span>
<span class="ln">13 </span>  <span class="comment single">//- argument for remaining devices in cell-01.penning
</span><span class="ln">14 </span><span class="comment single"></span>  <span class="punctuation">.</span> <span class="punctuation">.</span> <span class="punctuation">.</span>
<span class="ln">15 </span>  <span class="comment single">//- argument for devices in cell-01.pirani
</span><span class="ln">16 </span><span class="comment single"></span>  <span class="punctuation">.</span> <span class="punctuation">.</span> <span class="punctuation">.</span>
<span class="ln">17 </span>  <span class="comment single">//- the reply list
</span><span class="ln">18 </span><span class="comment single"></span>  <span class="name">Tango</span><span class="operator">::</span><span class="name">GroupCmdReplyList</span> <span class="name">crl</span><span class="punctuation">;</span>
<span class="ln">19 </span>  <span class="comment single">//- enter a try/catch block (see below)
</span><span class="ln">20 </span><span class="comment single"></span>  <span class="keyword">try</span>
<span class="ln">21 </span>  <span class="punctuation">{</span>
<span class="ln">22 </span>  <span class="comment single">//- execute the command
</span><span class="ln">23 </span><span class="comment single"></span>      <span class="name">crl</span> <span class="operator">=</span> <span class="name">g</span><span class="operator">-&gt;</span><span class="name">command_inout</span><span class="punctuation">(</span><span class="literal string">&quot;SetDummyFactor&quot;</span><span class="punctuation">,</span> <span class="name">argins</span><span class="punctuation">,</span> <span class="name builtin">true</span><span class="punctuation">);</span>
<span class="ln">24 </span>      <span class="keyword">if</span> <span class="punctuation">(</span><span class="name">crl</span><span class="punctuation">.</span><span class="name">has_failed</span><span class="punctuation">())</span>
<span class="ln">25 </span>      <span class="punctuation">{</span>
<span class="ln">26 </span>  <span class="comment single">//- error handling goes here (see case 1)
</span><span class="ln">27 </span><span class="comment single"></span>      <span class="punctuation">}</span>
<span class="ln">28 </span>  <span class="punctuation">}</span>
<span class="ln">29 </span>  <span class="keyword">catch</span> <span class="punctuation">(</span><span class="keyword">const</span> <span class="name">DevFailed</span><span class="operator">&amp;</span> <span class="name">df</span><span class="punctuation">)</span>
<span class="ln">30 </span>  <span class="punctuation">{</span>
<span class="ln">31 </span>  <span class="comment single">//- see below
</span><span class="ln">32 </span><span class="comment single"></span>  <span class="punctuation">}</span>
<span class="ln">33 </span>  <span class="name">crl</span><span class="punctuation">.</span><span class="name">reset</span><span class="punctuation">();</span>
</pre>
<p>If we want to execute the command locally on cell-01 (i.e. not on its
sub-groups), we should write the following C++ code:</p>
<pre class="code cpp literal-block">
<span class="ln"> 1 </span>  <span class="comment single">//- get a reference to the target group
</span><span class="ln"> 2 </span><span class="comment single"></span>  <span class="name">Tango</span><span class="operator">::</span><span class="name">Group</span> <span class="operator">*</span><span class="name">g</span> <span class="operator">=</span> <span class="name">gauges</span><span class="operator">-&gt;</span><span class="name">get_group</span><span class="punctuation">(</span><span class="literal string">&quot;cell-01&quot;</span><span class="punctuation">);</span>
<span class="ln"> 3 </span>  <span class="comment single">//- get number of device in the group (starting at cell-01)
</span><span class="ln"> 4 </span><span class="comment single"></span>  <span class="keyword type">long</span> <span class="name">n_dev</span> <span class="operator">=</span> <span class="name">g</span><span class="operator">-&gt;</span><span class="name">get_size</span><span class="punctuation">(</span><span class="name builtin">false</span><span class="punctuation">);</span>
<span class="ln"> 5 </span>  <span class="comment single">//- Build argin list
</span><span class="ln"> 6 </span><span class="comment single"></span>  <span class="name">std</span><span class="operator">::</span><span class="name">vector</span><span class="operator">&lt;</span><span class="keyword type">double</span><span class="operator">&gt;</span> <span class="name">argins</span><span class="punctuation">(</span><span class="name">n_dev</span><span class="punctuation">);</span>
<span class="ln"> 7 </span>  <span class="comment single">//- argins for inst-c01/vac-gauge/penning-01
</span><span class="ln"> 8 </span><span class="comment single"></span>  <span class="name">argins</span><span class="punctuation">[</span><span class="literal number integer">0</span><span class="punctuation">]</span> <span class="operator">=</span> <span class="literal number float">0.1</span><span class="punctuation">;</span>
<span class="ln"> 9 </span>  <span class="comment single">//- argins for inst-c01/vac-gauge/penning-02
</span><span class="ln">10 </span><span class="comment single"></span>  <span class="name">argins</span><span class="punctuation">[</span><span class="literal number integer">1</span><span class="punctuation">]</span> <span class="operator">=</span> <span class="literal number float">0.2</span><span class="punctuation">;</span>
<span class="ln">11 </span>  <span class="comment single">//- argins for remaining devices in cell-01.penning
</span><span class="ln">12 </span><span class="comment single"></span>  <span class="punctuation">.</span> <span class="punctuation">.</span> <span class="punctuation">.</span>
<span class="ln">13 </span>  <span class="comment single">//- the reply list
</span><span class="ln">14 </span><span class="comment single"></span>  <span class="name">Tango</span><span class="operator">::</span><span class="name">GroupCmdReplyList</span> <span class="name">crl</span><span class="punctuation">;</span>
<span class="ln">15 </span>  <span class="comment single">//- enter a try/catch block (see below)
</span><span class="ln">16 </span><span class="comment single"></span>  <span class="keyword">try</span>
<span class="ln">17 </span>  <span class="punctuation">{</span>
<span class="ln">18 </span>  <span class="comment single">//- execute the command
</span><span class="ln">19 </span><span class="comment single"></span>      <span class="name">crl</span> <span class="operator">=</span> <span class="name">g</span><span class="operator">-&gt;</span><span class="name">command_inout</span><span class="punctuation">(</span><span class="literal string">&quot;SetDummyFactor&quot;</span><span class="punctuation">,</span> <span class="name">argins</span><span class="punctuation">,</span> <span class="name builtin">false</span><span class="punctuation">);</span>
<span class="ln">20 </span>      <span class="keyword">if</span> <span class="punctuation">(</span><span class="name">crl</span><span class="punctuation">.</span><span class="name">has_failed</span><span class="punctuation">())</span>
<span class="ln">21 </span>      <span class="punctuation">{</span>
<span class="ln">22 </span>  <span class="comment single">//- error handling goes here (see case 1)
</span><span class="ln">23 </span><span class="comment single"></span>      <span class="punctuation">}</span>
<span class="ln">24 </span>  <span class="punctuation">}</span>
<span class="ln">25 </span>  <span class="keyword">catch</span> <span class="punctuation">(</span><span class="keyword">const</span> <span class="name">DevFailed</span><span class="operator">&amp;</span> <span class="name">df</span><span class="punctuation">)</span>
<span class="ln">26 </span>  <span class="punctuation">{</span>
<span class="ln">27 </span>  <span class="comment single">//- see below
</span><span class="ln">28 </span><span class="comment single"></span>  <span class="punctuation">}</span>
<span class="ln">29 </span>  <span class="name">crl</span><span class="punctuation">.</span><span class="name">reset</span><span class="punctuation">();</span>
</pre>
<p>Note: if we want to execute the command locally on cell-01 (i.e. not on
its sub-groups), we should write the following code:</p>
<pre class="code cpp literal-block">
<span class="ln"> 1 </span>  <span class="comment single">//- get a reference to the target group
</span><span class="ln"> 2 </span><span class="comment single"></span>  <span class="name">Group</span> <span class="name">g</span> <span class="operator">=</span> <span class="name">gauges</span><span class="punctuation">.</span><span class="name">get_group</span><span class="punctuation">(</span><span class="literal string">&quot;cell-01&quot;</span><span class="punctuation">);</span>
<span class="ln"> 3 </span>  <span class="comment single">//- get pre-build arguments list for the group (starting&#64;cell-01)
</span><span class="ln"> 4 </span><span class="comment single"></span>  <span class="name">DeviceData</span><span class="punctuation">[]</span> <span class="name">argins</span> <span class="operator">=</span> <span class="name">g</span><span class="punctuation">.</span><span class="name">get_command_specific_argument_list</span><span class="punctuation">(</span><span class="name builtin">false</span><span class="punctuation">);</span>
<span class="ln"> 5 </span>  <span class="comment single">//- argins for inst-c01/vac-gauge/penning-01
</span><span class="ln"> 6 </span><span class="comment single"></span>  <span class="name">argins</span><span class="punctuation">[</span><span class="literal number integer">0</span><span class="punctuation">].</span><span class="name">insert</span><span class="punctuation">(</span><span class="literal number float">0.1</span><span class="punctuation">);</span>
<span class="ln"> 7 </span>  <span class="comment single">//- argins for inst-c01/vac-gauge/penning-02
</span><span class="ln"> 8 </span><span class="comment single"></span>  <span class="name">argins</span><span class="punctuation">[</span><span class="literal number integer">1</span><span class="punctuation">].</span><span class="name">insert</span><span class="punctuation">(</span><span class="literal number float">0.2</span><span class="punctuation">);</span>
<span class="ln"> 9 </span>  <span class="comment single">//- argins for remaining devices in cell-01.penning
</span><span class="ln">10 </span><span class="comment single"></span>  <span class="punctuation">.</span> <span class="punctuation">.</span> <span class="punctuation">.</span>
<span class="ln">11 </span>  <span class="comment single">//- the reply list
</span><span class="ln">12 </span><span class="comment single"></span>  <span class="name">GroupCmdReplyList</span> <span class="name">crl</span><span class="punctuation">;</span>
<span class="ln">13 </span>  <span class="comment single">//- enter a try/catch block (see below)
</span><span class="ln">14 </span><span class="comment single"></span>  <span class="keyword">try</span>
<span class="ln">15 </span>  <span class="punctuation">{</span>
<span class="ln">16 </span>  <span class="comment single">//- execute the command
</span><span class="ln">17 </span><span class="comment single"></span>      <span class="name">crl</span> <span class="operator">=</span> <span class="name">g</span><span class="punctuation">.</span><span class="name">command_inout</span><span class="punctuation">(</span><span class="literal string">&quot;SetDummyFactor&quot;</span><span class="punctuation">,</span> <span class="name">argins</span><span class="punctuation">,</span> <span class="name builtin">false</span><span class="punctuation">,</span> <span class="name builtin">false</span><span class="punctuation">);</span>
<span class="ln">18 </span>      <span class="keyword">if</span> <span class="punctuation">(</span><span class="name">crl</span><span class="punctuation">.</span><span class="name">has_failed</span><span class="punctuation">())</span>
<span class="ln">19 </span>      <span class="punctuation">{</span>
<span class="ln">20 </span>  <span class="comment single">//- error handling goes here (see case 1)
</span><span class="ln">21 </span><span class="comment single"></span>      <span class="punctuation">}</span>
<span class="ln">22 </span>  <span class="punctuation">}</span>
<span class="ln">23 </span>  <span class="keyword">catch</span> <span class="punctuation">(</span><span class="name">DevFailed</span> <span class="name">d</span><span class="punctuation">)</span>
<span class="ln">24 </span>  <span class="punctuation">{</span>
<span class="ln">25 </span>  <span class="comment single">//- see below
</span><span class="ln">26 </span><span class="comment single"></span>  <span class="punctuation">}</span>
</pre>
<p>This form of <em>command_inout</em> (the one that accepts an array of value as
its input argument), may throw an exception <strong>before</strong> executing the
command if the number of elements in the input array does not match the
number of individual devices in the group or in the hierarchy (depending
on the forward option).</p>
<p>An asynchronous version of this method is also available. See case 1 for
an example of asynchronous command.</p>
</div>
</div>
<div class="section" id="reading-attribute-s">
<h3>Reading attribute(s)<a class="headerlink" href="#reading-attribute-s" title="Permalink to this headline">¶</a></h3>
<p>In order to read attribute(s), the Group interface contains several
implementations of the <em>read_attribute()</em> and <em>read_attributes()</em>
methods. Both synchronous and asynchronous forms are supported. Reading
several attributes is very similar to reading a single attribute. Simply
replace the std::string used for attribute name by a vector of
std::string with one element for each attribute name. In case of
read_attributes() call, the order of attribute value returned in the
GroupAttrReplyList is all attributes for first element in the group
followed by all attributes for the second group element and so on.</p>
<div class="section" id="obtaining-attribute-values">
<h4>Obtaining attribute values<a class="headerlink" href="#obtaining-attribute-values" title="Permalink to this headline">¶</a></h4>
<p>Attribute values are returned using a GroupAttrReplyList. This is
nothing but an array containing a GroupAttrReply for each device in the
group. The GroupAttrReply contains the actual data (i.e. the
DeviceAttribute). By inheritance, it may also contain any error occurred
during the execution of the command (in which case the data is invalid).</p>
<p>Here again, the Tango Group implementation guarantees that the attribute
values are returned in the order in which its elements were attached to
the group. See Obtaining command results for details.</p>
<p>The GroupAttrReply contains some public methods allowing the
identification of both the device (GroupAttrReply::dev_name) and the
attribute (GroupAttrReply::obj_name). It means that, depending of your
application, you can associate a response with its source using its
position in the response list or using the
Tango::GroupAttrReply::dev_name member.</p>
</div>
<div class="section" id="id4">
<h4>A few words on error handling and data extraction<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h4>
<p>Here again, depending of the application and/or the developer’s
programming habits, each individual error can be handle by the C++
exception mechanism or using the dedicated <em>has_failed()</em> method. The
GroupReply class - which is the mother class of both GroupCmdReply and
GroupAttrReply - contains a static method to enable (or disable)
exceptions called <em>enable_exception()</em>. By default, exceptions are
disabled. The following example is proposed with both exceptions enable
and disable.</p>
<p>In C++, data can be extracted directly from an individual reply. The
GroupAttrReply interface contains a template operator&gt;&gt; allowing the
extraction of any supported Tango type (in fact the actual data
extraction is delegated to DeviceAttribute::operator&gt;&gt;).</p>
<p>Reading an attribute is very similar to executing a command.</p>
<p>Reading an attribute in C++:</p>
<pre class="code cpp literal-block">
<span class="ln"> 1 </span>  <span class="comment single">//-----------------------------------------------------------------
</span><span class="ln"> 2 </span><span class="comment single"></span>  <span class="comment single">//- synch. read &quot;vacuum&quot; attribute on each device in the hierarchy
</span><span class="ln"> 3 </span><span class="comment single"></span>  <span class="comment single">//- with exceptions enabled - C++ example
</span><span class="ln"> 4 </span><span class="comment single"></span>  <span class="comment single">//-----------------------------------------------------------------
</span><span class="ln"> 5 </span><span class="comment single"></span>  <span class="comment single">//- enable exceptions and save current mode
</span><span class="ln"> 6 </span><span class="comment single"></span>  <span class="keyword type">bool</span> <span class="name">last_mode</span> <span class="operator">=</span> <span class="name">GroupReply</span><span class="operator">::</span><span class="name">enable_exception</span><span class="punctuation">(</span><span class="name builtin">true</span><span class="punctuation">);</span>
<span class="ln"> 7 </span>  <span class="comment single">//- read attribute
</span><span class="ln"> 8 </span><span class="comment single"></span>  <span class="name">Tango</span><span class="operator">::</span><span class="name">GroupAttrReplyList</span> <span class="name">arl</span> <span class="operator">=</span> <span class="name">gauges</span><span class="operator">-&gt;</span><span class="name">read_attribute</span><span class="punctuation">(</span><span class="literal string">&quot;vacuum&quot;</span><span class="punctuation">);</span>
<span class="ln"> 9 </span>  <span class="comment single">//- for each response in the list ...
</span><span class="ln">10 </span><span class="comment single"></span>  <span class="keyword">for</span> <span class="punctuation">(</span><span class="keyword type">int</span> <span class="name">r</span> <span class="operator">=</span> <span class="literal number integer">0</span><span class="punctuation">;</span> <span class="name">r</span> <span class="operator">&lt;</span> <span class="name">arl</span><span class="punctuation">.</span><span class="name">size</span><span class="punctuation">();</span> <span class="name">r</span><span class="operator">++</span><span class="punctuation">)</span>
<span class="ln">11 </span>  <span class="punctuation">{</span>
<span class="ln">12 </span>  <span class="comment single">//- enter a try/catch block
</span><span class="ln">13 </span><span class="comment single"></span>     <span class="keyword">try</span>
<span class="ln">14 </span>     <span class="punctuation">{</span>
<span class="ln">15 </span>  <span class="comment single">//- try to extract the data from the r-th reply
</span><span class="ln">16 </span><span class="comment single"></span>  <span class="comment single">//- suppose data contains a double
</span><span class="ln">17 </span><span class="comment single"></span>        <span class="keyword type">double</span> <span class="name">ans</span><span class="punctuation">;</span>
<span class="ln">18 </span>        <span class="name">arl</span><span class="punctuation">[</span><span class="name">r</span><span class="punctuation">]</span> <span class="operator">&gt;&gt;</span> <span class="name">ans</span><span class="punctuation">;</span>
<span class="ln">19 </span>        <span class="name">cout</span> <span class="operator">&lt;&lt;</span> <span class="name">arl</span><span class="punctuation">[</span><span class="name">r</span><span class="punctuation">].</span><span class="name">dev_name</span><span class="punctuation">()</span>
<span class="ln">20 </span>             <span class="operator">&lt;&lt;</span> <span class="literal string">&quot;::&quot;</span>
<span class="ln">21 </span>             <span class="operator">&lt;&lt;</span> <span class="name">arl</span><span class="punctuation">[</span><span class="name">r</span><span class="punctuation">].</span><span class="name">obj_name</span><span class="punctuation">()</span>
<span class="ln">22 </span>             <span class="operator">&lt;&lt;</span> <span class="literal string">&quot; value is &quot;</span>
<span class="ln">23 </span>             <span class="operator">&lt;&lt;</span> <span class="name">ans</span> <span class="operator">&lt;&lt;</span> <span class="name">endl</span><span class="punctuation">;</span>
<span class="ln">24 </span>     <span class="punctuation">}</span>
<span class="ln">25 </span>     <span class="keyword">catch</span> <span class="punctuation">(</span><span class="keyword">const</span> <span class="name">DevFailed</span><span class="operator">&amp;</span> <span class="name">df</span><span class="punctuation">)</span>
<span class="ln">26 </span>     <span class="punctuation">{</span>
<span class="ln">27 </span>  <span class="comment single">//- DevFailed caught while trying to extract the data from reply
</span><span class="ln">28 </span><span class="comment single"></span>        <span class="keyword">for</span> <span class="punctuation">(</span><span class="keyword type">int</span> <span class="name">err</span> <span class="operator">=</span> <span class="literal number integer">0</span><span class="punctuation">;</span> <span class="name">err</span> <span class="operator">&lt;</span> <span class="name">df</span><span class="punctuation">.</span><span class="name">errors</span><span class="punctuation">.</span><span class="name">length</span><span class="punctuation">();</span> <span class="name">err</span><span class="operator">++</span><span class="punctuation">)</span>
<span class="ln">29 </span>        <span class="punctuation">{</span>
<span class="ln">30 </span>           <span class="name">cout</span> <span class="operator">&lt;&lt;</span> <span class="literal string">&quot;error: &quot;</span> <span class="operator">&lt;&lt;</span> <span class="name">df</span><span class="punctuation">.</span><span class="name">errors</span><span class="punctuation">[</span><span class="name">err</span><span class="punctuation">].</span><span class="name">desc</span><span class="punctuation">.</span><span class="name">in</span><span class="punctuation">()</span> <span class="operator">&lt;&lt;</span> <span class="name">endl</span><span class="punctuation">;</span>
<span class="ln">31 </span>        <span class="punctuation">}</span>
<span class="ln">32 </span>  <span class="comment single">//- alternatively, one can use arl[r].get_err_stack() see below
</span><span class="ln">33 </span><span class="comment single"></span>     <span class="punctuation">}</span>
<span class="ln">34 </span>     <span class="keyword">catch</span> <span class="punctuation">(...)</span>
<span class="ln">35 </span>     <span class="punctuation">{</span>
<span class="ln">36 </span>        <span class="name">cout</span> <span class="operator">&lt;&lt;</span> <span class="literal string">&quot;unknown exception caught&quot;</span><span class="punctuation">;</span>
<span class="ln">37 </span>     <span class="punctuation">}</span>
<span class="ln">38 </span>  <span class="punctuation">}</span>
<span class="ln">39 </span>  <span class="comment single">//- restore last exception mode (if needed)
</span><span class="ln">40 </span><span class="comment single"></span>  <span class="name">GroupReply</span><span class="operator">::</span><span class="name">enable_exception</span><span class="punctuation">(</span><span class="name">last_mode</span><span class="punctuation">);</span>
<span class="ln">41 </span>  <span class="comment single">//- clear the reply list (if reused later in the code)
</span><span class="ln">42 </span><span class="comment single"></span>  <span class="name">arl</span><span class="punctuation">.</span><span class="name">reset</span><span class="punctuation">();</span>
</pre>
<p>In C++, an asynchronous version of the previous example could be:</p>
<pre class="code cpp literal-block">
<span class="ln"> 1 </span>  <span class="comment single">//- read the attribute asynchronously
</span><span class="ln"> 2 </span><span class="comment single"></span>  <span class="keyword type">long</span> <span class="name">request_id</span> <span class="operator">=</span> <span class="name">gauges</span><span class="operator">-&gt;</span><span class="name">read_attribute_asynch</span><span class="punctuation">(</span><span class="literal string">&quot;vacuum&quot;</span><span class="punctuation">);</span>
<span class="ln"> 3 </span>  <span class="comment single">//- do some work
</span><span class="ln"> 4 </span><span class="comment single"></span>  <span class="name">do_some_work</span><span class="punctuation">();</span>
<span class="ln"> 5 </span>
<span class="ln"> 6 </span>
<span class="ln"> 7 </span>  <span class="comment single">//- get results
</span><span class="ln"> 8 </span><span class="comment single"></span>  <span class="name">Tango</span><span class="operator">::</span><span class="name">GroupAttrReplyList</span> <span class="name">arl</span> <span class="operator">=</span> <span class="name">gauges</span><span class="operator">-&gt;</span><span class="name">read_attribute_reply</span><span class="punctuation">(</span><span class="name">request_id</span><span class="punctuation">);</span>
<span class="ln"> 9 </span>  <span class="comment single">//- process replies as previously described in the synch. implementation
</span><span class="ln">10 </span><span class="comment single"></span>  <span class="keyword">for</span> <span class="punctuation">(</span><span class="keyword type">int</span> <span class="name">r</span> <span class="operator">=</span> <span class="literal number integer">0</span><span class="punctuation">;</span> <span class="name">r</span> <span class="operator">&lt;</span> <span class="name">arl</span><span class="punctuation">.</span><span class="name">size</span><span class="punctuation">();</span> <span class="name">r</span><span class="operator">++</span><span class="punctuation">)</span>
<span class="ln">11 </span>  <span class="punctuation">{</span>
<span class="ln">12 </span>  <span class="comment single">//- data processing and/or error handling goes here
</span><span class="ln">13 </span><span class="comment single"></span>  <span class="punctuation">...</span>
<span class="ln">14 </span>  <span class="punctuation">}</span>
<span class="ln">15 </span>  <span class="comment single">//- clear the reply list (if reused later in the code)
</span><span class="ln">16 </span><span class="comment single"></span>  <span class="name">arl</span><span class="punctuation">.</span><span class="name">reset</span><span class="punctuation">();</span>
</pre>
</div>
</div>
<div class="section" id="writing-an-attribute">
<h3>Writing an attribute<a class="headerlink" href="#writing-an-attribute" title="Permalink to this headline">¶</a></h3>
<p>The Group interface contains several implementations of the
<em>write_attribute()</em> method. Both synchronous and asynchronous forms are
supported. However, writing more than one attribute at a time is not
supported.</p>
<div class="section" id="obtaining-acknowledgement">
<h4>Obtaining acknowledgement<a class="headerlink" href="#obtaining-acknowledgement" title="Permalink to this headline">¶</a></h4>
<p>Acknowledgements are returned using a GroupReplyList. This is nothing
but an array containing a GroupReply for each device in the group. The
GroupReply may contain any error occurred during the execution of the
command. The return value of the <em>has_failed()</em> method indicates
whether an error occurred or not. If this flag is set to true, the
<em>GroupReply::get_err_stack()</em> method gives error details.</p>
<p>Here again, the Tango Group implementation guarantees that the attribute
values are returned in the order in which its elements were attached to
the group. See Obtaining command results for details.</p>
<p>The GroupReply contains some public members allowing the identification
of both the device (GroupReply::dev_name) and the attribute
(GroupReply::obj_name). It means that, depending of your application,
you can associate a response with its source using its position in the
response list or using</p>
</div>
<div class="section" id="case-1-one-value-for-all-devices">
<h4>Case 1: one value for all devices<a class="headerlink" href="#case-1-one-value-for-all-devices" title="Permalink to this headline">¶</a></h4>
<p>Here, we give an example in which the same attribute value is written on
all devices in the group (or its sub-groups). Exceptions are supposed to
be disabled.</p>
<p>Writing an attribute in C++:</p>
<pre class="code cpp literal-block">
<span class="ln"> 1 </span>  <span class="comment single">//-----------------------------------------------------------------
</span><span class="ln"> 2 </span><span class="comment single"></span>  <span class="comment single">//- synch. write &quot;dummy&quot; attribute on each device in the hierarchy
</span><span class="ln"> 3 </span><span class="comment single"></span>  <span class="comment single">//-----------------------------------------------------------------
</span><span class="ln"> 4 </span><span class="comment single"></span>  <span class="comment single">//- assume each device support a &quot;dummy&quot; writable attribute
</span><span class="ln"> 5 </span><span class="comment single"></span>  <span class="comment single">//- insert the value to be written into a generic container
</span><span class="ln"> 6 </span><span class="comment single"></span>  <span class="name">Tango</span><span class="operator">::</span><span class="name">DeviceAttribute</span> <span class="name">value</span><span class="punctuation">(</span><span class="name">std</span><span class="operator">::</span><span class="name">string</span><span class="punctuation">(</span><span class="literal string">&quot;dummy&quot;</span><span class="punctuation">),</span> <span class="literal number float">3.14159</span><span class="punctuation">);</span>
<span class="ln"> 7 </span>  <span class="comment single">//- write the attribute
</span><span class="ln"> 8 </span><span class="comment single"></span>  <span class="name">Tango</span><span class="operator">::</span><span class="name">GroupReplyList</span> <span class="name">rl</span> <span class="operator">=</span> <span class="name">gauges</span><span class="operator">-&gt;</span><span class="name">write_attribute</span><span class="punctuation">(</span><span class="name">value</span><span class="punctuation">);</span>
<span class="ln"> 9 </span>  <span class="comment single">//- any error?
</span><span class="ln">10 </span><span class="comment single"></span>  <span class="keyword">if</span> <span class="punctuation">(</span><span class="name">rl</span><span class="punctuation">.</span><span class="name">has_failed</span><span class="punctuation">()</span> <span class="operator">==</span> <span class="name builtin">false</span><span class="punctuation">)</span>
<span class="ln">11 </span>  <span class="punctuation">{</span>
<span class="ln">12 </span>      <span class="name">cout</span> <span class="operator">&lt;&lt;</span> <span class="literal string">&quot;no error&quot;</span> <span class="operator">&lt;&lt;</span> <span class="name">endl</span><span class="punctuation">;</span>
<span class="ln">13 </span>  <span class="punctuation">}</span>
<span class="ln">14 </span>  <span class="keyword">else</span>
<span class="ln">15 </span>  <span class="punctuation">{</span>
<span class="ln">16 </span>      <span class="name">cout</span> <span class="operator">&lt;&lt;</span> <span class="literal string">&quot;at least one error occurred&quot;</span> <span class="operator">&lt;&lt;</span> <span class="name">endl</span><span class="punctuation">;</span>
<span class="ln">17 </span>  <span class="comment single">//- for each response in the list ...
</span><span class="ln">18 </span><span class="comment single"></span>      <span class="keyword">for</span> <span class="punctuation">(</span><span class="keyword type">int</span> <span class="name">r</span> <span class="operator">=</span> <span class="literal number integer">0</span><span class="punctuation">;</span> <span class="name">r</span> <span class="operator">&lt;</span> <span class="name">rl</span><span class="punctuation">.</span><span class="name">size</span><span class="punctuation">();</span> <span class="name">r</span><span class="operator">++</span><span class="punctuation">)</span>
<span class="ln">19 </span>      <span class="punctuation">{</span>
<span class="ln">20 </span>  <span class="comment single">//- did the r-th device give error?
</span><span class="ln">21 </span><span class="comment single"></span>         <span class="keyword">if</span> <span class="punctuation">(</span><span class="name">rl</span><span class="punctuation">[</span><span class="name">r</span><span class="punctuation">].</span><span class="name">has_failed</span><span class="punctuation">()</span> <span class="operator">==</span> <span class="name builtin">true</span><span class="punctuation">)</span>
<span class="ln">22 </span>         <span class="punctuation">{</span>
<span class="ln">23 </span>  <span class="comment single">//- printout error description
</span><span class="ln">24 </span><span class="comment single"></span>             <span class="name">cout</span> <span class="operator">&lt;&lt;</span> <span class="literal string">&quot;an error occurred while reading &quot;</span>
<span class="ln">25 </span>                  <span class="operator">&lt;&lt;</span> <span class="name">rl</span><span class="punctuation">[</span><span class="name">r</span><span class="punctuation">].</span><span class="name">obj_name</span><span class="punctuation">()</span>
<span class="ln">26 </span>                  <span class="operator">&lt;&lt;</span> <span class="literal string">&quot; on &quot;</span>
<span class="ln">27 </span>                  <span class="operator">&lt;&lt;</span> <span class="name">rl</span><span class="punctuation">[</span><span class="name">r</span><span class="punctuation">].</span><span class="name">dev_name</span><span class="punctuation">()</span>
<span class="ln">28 </span>                  <span class="operator">&lt;&lt;</span> <span class="name">endl</span><span class="punctuation">;</span>
<span class="ln">29 </span>  <span class="comment single">//- dump error stack
</span><span class="ln">30 </span><span class="comment single"></span>             <span class="keyword">const</span> <span class="name">DevErrorList</span><span class="operator">&amp;</span> <span class="name">el</span> <span class="operator">=</span> <span class="name">rl</span><span class="punctuation">[</span><span class="name">r</span><span class="punctuation">].</span><span class="name">get_err_stack</span><span class="punctuation">();</span>
<span class="ln">31 </span>             <span class="keyword">for</span> <span class="punctuation">(</span><span class="keyword type">int</span> <span class="name">err</span> <span class="operator">=</span> <span class="literal number integer">0</span><span class="punctuation">;</span> <span class="name">err</span> <span class="operator">&lt;</span> <span class="name">el</span><span class="punctuation">.</span><span class="name">size</span><span class="punctuation">();</span> <span class="name">err</span><span class="operator">++</span><span class="punctuation">)</span>
<span class="ln">32 </span>             <span class="punctuation">{</span>
<span class="ln">33 </span>                <span class="name">cout</span> <span class="operator">&lt;&lt;</span> <span class="name">el</span><span class="punctuation">[</span><span class="name">err</span><span class="punctuation">].</span><span class="name">desc</span><span class="punctuation">.</span><span class="name">in</span><span class="punctuation">();</span>
<span class="ln">34 </span>             <span class="punctuation">}</span>
<span class="ln">35 </span>          <span class="punctuation">}</span>
<span class="ln">36 </span>       <span class="punctuation">}</span>
<span class="ln">37 </span>  <span class="punctuation">}</span>
<span class="ln">38 </span>  <span class="comment single">//- clear the reply list (if reused later in the code)
</span><span class="ln">39 </span><span class="comment single"></span>  <span class="name">rl</span><span class="punctuation">.</span><span class="name">reset</span><span class="punctuation">();</span>
</pre>
<p>Here is a C++ asynchronous version:</p>
<pre class="code cpp literal-block">
<span class="ln"> 1 </span>  <span class="comment single">//- insert the value to be written into a generic container
</span><span class="ln"> 2 </span><span class="comment single"></span>  <span class="name">Tango</span><span class="operator">::</span><span class="name">DeviceAttribute</span> <span class="name">value</span><span class="punctuation">(</span><span class="name">std</span><span class="operator">::</span><span class="name">string</span><span class="punctuation">(</span><span class="literal string">&quot;dummy&quot;</span><span class="punctuation">),</span> <span class="literal number float">3.14159</span><span class="punctuation">);</span>
<span class="ln"> 3 </span>  <span class="comment single">//- write the attribute asynchronously
</span><span class="ln"> 4 </span><span class="comment single"></span>  <span class="keyword type">long</span> <span class="name">request_id</span> <span class="operator">=</span> <span class="name">gauges</span><span class="punctuation">.</span><span class="name">write_attribute_asynch</span><span class="punctuation">(</span><span class="name">value</span><span class="punctuation">);</span>
<span class="ln"> 5 </span>  <span class="comment single">//- do some work
</span><span class="ln"> 6 </span><span class="comment single"></span>  <span class="name">do_some_work</span><span class="punctuation">();</span>
<span class="ln"> 7 </span>
<span class="ln"> 8 </span>
<span class="ln"> 9 </span>  <span class="comment single">//- get results
</span><span class="ln">10 </span><span class="comment single"></span>  <span class="name">Tango</span><span class="operator">::</span><span class="name">GroupReplyList</span> <span class="name">rl</span> <span class="operator">=</span> <span class="name">gauges</span><span class="operator">-&gt;</span><span class="name">write_attribute_reply</span><span class="punctuation">(</span><span class="name">request_id</span><span class="punctuation">);</span>
<span class="ln">11 </span>  <span class="comment single">//- process replies as previously describe in the synch. implementation ...</span>
</pre>
</div>
<div class="section" id="case-2-a-specific-value-per-device">
<h4>Case 2: a specific value per device<a class="headerlink" href="#case-2-a-specific-value-per-device" title="Permalink to this headline">¶</a></h4>
<p>Here, we give an example in which a <strong>specific</strong> attribute value is
applied to each device in the hierarchy. In order to use this form of
<em>write_attribute()</em>, the user must have an a priori and perfect
knowledge of the devices order in the hierarchy.</p>
<p>The C++ implementation provides a template method which accepts a
std::vector of C++ type for command argument. This allows passing any
kind of data using a single method.</p>
<p>The size of this vector must equal the number of device in the hierarchy
(respectively the number of device in the group) if the forward option
is set to true (respectively set to false). Otherwise, an exception is
thrown.</p>
<p>The first item in the vector is applied to the first device in the
group, the second to the second device in the group, and so on…That’s
why the user must have a perfect knowledge of the devices order in the
group.</p>
<p>Assuming that gauges are ordered by name, the dummy attribute can be
written as follows on group cell-01 (and its sub-groups) as follows:</p>
<p>Remember, cell-01 has the following internal structure:</p>
<pre class="code cpp literal-block">
<span class="ln"> 1 </span>  <span class="operator">-&gt;</span> <span class="name">gauges</span>
<span class="ln"> 2 </span>      <span class="operator">|</span> <span class="operator">-&gt;</span> <span class="name">cell</span><span class="operator">-</span><span class="literal number oct">01</span>
<span class="ln"> 3 </span>      <span class="operator">|</span>     <span class="operator">|-&gt;</span> <span class="name">inst</span><span class="operator">-</span><span class="name">c01</span><span class="operator">/</span><span class="name">vac</span><span class="operator">-</span><span class="name">gauge</span><span class="operator">/</span><span class="name">strange</span>
<span class="ln"> 4 </span>      <span class="operator">|</span>     <span class="operator">|-&gt;</span> <span class="name">penning</span>
<span class="ln"> 5 </span>      <span class="operator">|</span>     <span class="operator">|</span>    <span class="operator">|-&gt;</span> <span class="name">inst</span><span class="operator">-</span><span class="name">c01</span><span class="operator">/</span><span class="name">vac</span><span class="operator">-</span><span class="name">gauge</span><span class="operator">/</span><span class="name">penning</span><span class="operator">-</span><span class="literal number oct">01</span>
<span class="ln"> 6 </span>      <span class="operator">|</span>     <span class="operator">|</span>    <span class="operator">|-&gt;</span> <span class="name">inst</span><span class="operator">-</span><span class="name">c01</span><span class="operator">/</span><span class="name">vac</span><span class="operator">-</span><span class="name">gauge</span><span class="operator">/</span><span class="name">penning</span><span class="operator">-</span><span class="literal number oct">02</span>
<span class="ln"> 7 </span>      <span class="operator">|</span>     <span class="operator">|</span>    <span class="operator">|-&gt;</span> <span class="punctuation">...</span>
<span class="ln"> 8 </span>      <span class="operator">|</span>     <span class="operator">|</span>    <span class="operator">|-&gt;</span> <span class="name">inst</span><span class="operator">-</span><span class="name">c01</span><span class="operator">/</span><span class="name">vac</span><span class="operator">-</span><span class="name">gauge</span><span class="operator">/</span><span class="name">penning</span><span class="operator">-</span><span class="name">xx</span>
<span class="ln"> 9 </span>      <span class="operator">|</span>     <span class="operator">|-&gt;</span> <span class="name">pirani</span>
<span class="ln">10 </span>      <span class="operator">|</span>          <span class="operator">|-&gt;</span> <span class="name">inst</span><span class="operator">-</span><span class="name">c01</span><span class="operator">/</span><span class="name">vac</span><span class="operator">-</span><span class="name">gauge</span><span class="operator">/</span><span class="name">pirani</span><span class="operator">-</span><span class="literal number oct">01</span>
<span class="ln">11 </span>      <span class="operator">|</span>          <span class="operator">|-&gt;</span> <span class="punctuation">...</span>
<span class="ln">12 </span>      <span class="operator">|</span>          <span class="operator">|-&gt;</span> <span class="name">inst</span><span class="operator">-</span><span class="name">c01</span><span class="operator">/</span><span class="name">vac</span><span class="operator">-</span><span class="name">gauge</span><span class="operator">/</span><span class="name">pirani</span><span class="operator">-</span><span class="name">xx</span>
</pre>
<p>C++ version:</p>
<pre class="code cpp literal-block">
<span class="ln"> 1 </span>  <span class="comment single">//- get a reference to the target group
</span><span class="ln"> 2 </span><span class="comment single"></span>  <span class="name">Tango</span><span class="operator">::</span><span class="name">Group</span> <span class="operator">*</span><span class="name">g</span> <span class="operator">=</span> <span class="name">gauges</span><span class="operator">-&gt;</span><span class="name">get_group</span><span class="punctuation">(</span><span class="literal string">&quot;cell-01&quot;</span><span class="punctuation">);</span>
<span class="ln"> 3 </span>  <span class="comment single">//- get number of device in the hierarchy (starting at cell-01)
</span><span class="ln"> 4 </span><span class="comment single"></span>  <span class="keyword type">long</span> <span class="name">n_dev</span> <span class="operator">=</span> <span class="name">g</span><span class="operator">-&gt;</span><span class="name">get_size</span><span class="punctuation">(</span><span class="name builtin">true</span><span class="punctuation">);</span>
<span class="ln"> 5 </span>  <span class="comment single">//- Build value list
</span><span class="ln"> 6 </span><span class="comment single"></span>  <span class="name">std</span><span class="operator">::</span><span class="name">vector</span><span class="operator">&lt;</span><span class="keyword type">double</span><span class="operator">&gt;</span> <span class="name">values</span><span class="punctuation">(</span><span class="name">n_dev</span><span class="punctuation">);</span>
<span class="ln"> 7 </span>  <span class="comment single">//- value for inst-c01/vac-gauge/strange
</span><span class="ln"> 8 </span><span class="comment single"></span>  <span class="name">values</span><span class="punctuation">[</span><span class="literal number integer">0</span><span class="punctuation">]</span> <span class="operator">=</span> <span class="literal number float">3.14159</span><span class="punctuation">;</span>
<span class="ln"> 9 </span>  <span class="comment single">//- value for inst-c01/vac-gauge/penning-01
</span><span class="ln">10 </span><span class="comment single"></span>  <span class="name">values</span><span class="punctuation">[</span><span class="literal number integer">1</span><span class="punctuation">]</span> <span class="operator">=</span> <span class="literal number integer">2</span> <span class="operator">*</span> <span class="literal number float">3.14159</span><span class="punctuation">;</span>
<span class="ln">11 </span>  <span class="comment single">//- value for inst-c01/vac-gauge/penning-02
</span><span class="ln">12 </span><span class="comment single"></span>  <span class="name">values</span><span class="punctuation">[</span><span class="literal number integer">2</span><span class="punctuation">]</span> <span class="operator">=</span> <span class="literal number integer">3</span> <span class="operator">*</span> <span class="literal number float">3.14159</span><span class="punctuation">;</span>
<span class="ln">13 </span>  <span class="comment single">//- value for remaining devices in cell-01.penning
</span><span class="ln">14 </span><span class="comment single"></span>  <span class="punctuation">.</span> <span class="punctuation">.</span> <span class="punctuation">.</span>
<span class="ln">15 </span>  <span class="comment single">//- value for devices in cell-01.pirani
</span><span class="ln">16 </span><span class="comment single"></span>  <span class="punctuation">.</span> <span class="punctuation">.</span> <span class="punctuation">.</span>
<span class="ln">17 </span>  <span class="comment single">//- the reply list
</span><span class="ln">18 </span><span class="comment single"></span>  <span class="name">Tango</span><span class="operator">::</span><span class="name">GroupReplyList</span> <span class="name">rl</span><span class="punctuation">;</span>
<span class="ln">19 </span>  <span class="comment single">//- enter a try/catch block (see below)
</span><span class="ln">20 </span><span class="comment single"></span>  <span class="keyword">try</span>
<span class="ln">21 </span>  <span class="punctuation">{</span>
<span class="ln">22 </span>  <span class="comment single">//- write the &quot;dummy&quot; attribute
</span><span class="ln">23 </span><span class="comment single"></span>      <span class="name">rl</span> <span class="operator">=</span> <span class="name">g</span><span class="operator">-&gt;</span><span class="name">write_attribute</span><span class="punctuation">(</span><span class="literal string">&quot;dummy&quot;</span><span class="punctuation">,</span> <span class="name">values</span><span class="punctuation">,</span> <span class="name builtin">true</span><span class="punctuation">);</span>
<span class="ln">24 </span>      <span class="keyword">if</span> <span class="punctuation">(</span><span class="name">rl</span><span class="punctuation">.</span><span class="name">has_failed</span><span class="punctuation">())</span>
<span class="ln">25 </span>      <span class="punctuation">{</span>
<span class="ln">26 </span>  <span class="comment single">//- error handling (see previous cases)
</span><span class="ln">27 </span><span class="comment single"></span>      <span class="punctuation">}</span>
<span class="ln">28 </span>  <span class="punctuation">}</span>
<span class="ln">29 </span>  <span class="keyword">catch</span> <span class="punctuation">(</span><span class="keyword">const</span> <span class="name">DevFailed</span><span class="operator">&amp;</span> <span class="name">df</span><span class="punctuation">)</span>
<span class="ln">30 </span>  <span class="punctuation">{</span>
<span class="ln">31 </span>  <span class="comment single">//- see below
</span><span class="ln">32 </span><span class="comment single"></span>  <span class="punctuation">}</span>
<span class="ln">33 </span>  <span class="name">rl</span><span class="punctuation">.</span><span class="name">reset</span><span class="punctuation">();</span>
</pre>
<p>Note: if we want to execute the command locally on cell-01 (i.e. not on
its sub-groups), we should write the following code</p>
<pre class="code cpp literal-block">
<span class="ln"> 1 </span>  <span class="comment single">//- get a reference to the target group
</span><span class="ln"> 2 </span><span class="comment single"></span>  <span class="name">Tango</span><span class="operator">::</span><span class="name">Group</span> <span class="operator">*</span><span class="name">g</span> <span class="operator">=</span> <span class="name">gauges</span><span class="operator">-&gt;</span><span class="name">get_group</span><span class="punctuation">(</span><span class="literal string">&quot;cell-01&quot;</span><span class="punctuation">);</span>
<span class="ln"> 3 </span>  <span class="comment single">//- get number of device in the group
</span><span class="ln"> 4 </span><span class="comment single"></span>  <span class="keyword type">long</span> <span class="name">n_dev</span> <span class="operator">=</span> <span class="name">g</span><span class="operator">-&gt;</span><span class="name">get_size</span><span class="punctuation">(</span><span class="name builtin">false</span><span class="punctuation">);</span>
<span class="ln"> 5 </span>  <span class="comment single">//- Build value list
</span><span class="ln"> 6 </span><span class="comment single"></span>  <span class="name">std</span><span class="operator">::</span><span class="name">vector</span><span class="operator">&lt;</span><span class="keyword type">double</span><span class="operator">&gt;</span> <span class="name">values</span><span class="punctuation">(</span><span class="name">n_dev</span><span class="punctuation">);</span>
<span class="ln"> 7 </span>  <span class="comment single">//- value for inst-c01/vac-gauge/penning-01
</span><span class="ln"> 8 </span><span class="comment single"></span>  <span class="name">values</span><span class="punctuation">[</span><span class="literal number integer">0</span><span class="punctuation">]</span> <span class="operator">=</span> <span class="literal number integer">2</span> <span class="operator">*</span> <span class="literal number float">3.14159</span><span class="punctuation">;</span>
<span class="ln"> 9 </span>  <span class="comment single">//- value for inst-c01/vac-gauge/penning-02
</span><span class="ln">10 </span><span class="comment single"></span>  <span class="name">values</span><span class="punctuation">[</span><span class="literal number integer">1</span><span class="punctuation">]</span> <span class="operator">=</span> <span class="literal number integer">3</span> <span class="operator">*</span> <span class="literal number float">3.14159</span><span class="punctuation">;</span>
<span class="ln">11 </span>  <span class="comment single">//- value for remaining devices in cell-01.penning
</span><span class="ln">12 </span><span class="comment single"></span>  <span class="punctuation">.</span> <span class="punctuation">.</span> <span class="punctuation">.</span>
<span class="ln">13 </span>  <span class="comment single">//- the reply list
</span><span class="ln">14 </span><span class="comment single"></span>  <span class="name">Tango</span><span class="operator">::</span><span class="name">GroupReplyList</span> <span class="name">rl</span><span class="punctuation">;</span>
<span class="ln">15 </span>  <span class="comment single">//- enter a try/catch block (see below)
</span><span class="ln">16 </span><span class="comment single"></span>  <span class="keyword">try</span>
<span class="ln">17 </span>  <span class="punctuation">{</span>
<span class="ln">18 </span>  <span class="comment single">//- write the &quot;dummy&quot; attribute
</span><span class="ln">19 </span><span class="comment single"></span>     <span class="name">rl</span> <span class="operator">=</span> <span class="name">g</span><span class="operator">-&gt;</span><span class="name">write_attribute</span><span class="punctuation">(</span><span class="literal string">&quot;dummy&quot;</span><span class="punctuation">,</span> <span class="name">values</span><span class="punctuation">,</span> <span class="name builtin">false</span><span class="punctuation">);</span>
<span class="ln">20 </span>     <span class="keyword">if</span> <span class="punctuation">(</span><span class="name">rl</span><span class="punctuation">.</span><span class="name">has_failed</span><span class="punctuation">())</span>
<span class="ln">21 </span>     <span class="punctuation">{</span>
<span class="ln">22 </span>  <span class="comment single">//- error handling (see previous cases)
</span><span class="ln">23 </span><span class="comment single"></span>     <span class="punctuation">}</span>
<span class="ln">24 </span>  <span class="punctuation">}</span>
<span class="ln">25 </span>  <span class="keyword">catch</span> <span class="punctuation">(</span><span class="keyword">const</span> <span class="name">DevFailed</span><span class="operator">&amp;</span> <span class="name">df</span><span class="punctuation">)</span>
<span class="ln">26 </span>  <span class="punctuation">{</span>
<span class="ln">27 </span>  <span class="comment single">//- see below
</span><span class="ln">28 </span><span class="comment single"></span>  <span class="punctuation">}</span>
<span class="ln">29 </span>  <span class="name">rl</span><span class="punctuation">.</span><span class="name">reset</span><span class="punctuation">();</span>
</pre>
<p>This form of <em>write_attribute()</em> (the one that accepts an array of
value as its input argument), may throw an exception before executing
the command if the number of elements in the input array does not match
the number of individual devices in the group or in the hierarchy
(depending on the forward option).</p>
<p>An asynchronous version of this method is also available.</p>
</div>
</div>
</div>
<div class="section" id="reading-writing-device-pipe">
<h2>Reading/Writing device pipe<a class="headerlink" href="#reading-writing-device-pipe" title="Permalink to this headline">¶</a></h2>
<p>Reading or writing device pipe is made possible using DeviceProxy class
methods. To read a pipe, you have to use the method <strong>read_pipe()</strong>. To
write a pipe, use the <strong>write_pipe()</strong> method. A method
<strong>write_read_pipe()</strong> is also provided in case you need to write then
read a pipe in a non-interuptible way. All these calls generate
synchronous request and support only reading or writing a single pipe at
a time. Those pipe related DeviceProxy class methods (read_pipe,
write_pipe,…) use DevicePipe class instances. A DevicePipe instance
is nothing more than a string for the pipe name and a <em>DevicePipeBlob</em>
instance called the root blob. In a DevicePipeBlob instance, you have:</p>
<ul class="simple">
<li>The blob name</li>
<li>One array of <em>DataElement.</em> Each instance of this DataElement class
has:<ul>
<li>A name</li>
<li>A value which can be either<ul>
<li>Scalar or array of any basic Tango type</li>
<li>Another DevicePipeBlob</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>Therefore, this is a recursive data structure and you may have
DevicePipeBlob in DevicePipeBlob. There is no limit on the depth of this
recursivity even if it is not recommended to have a too large depth. The
following figure summarizes DevicePipe data structure</p>
<div class="figure" id="id8">
<span id="id5"></span><a class="reference internal image-reference" href="../../_images/pipe.png"><img alt="DevicePipe data structure" src="../../_images/pipe.png" style="width: 14.00000cm; height: 8.00000cm;" /></a>
<p class="caption"><span class="caption-text">Figure 4.1: DevicePipe data structure</span></p>
</div>
<p>Many methods to insert/extract data into/from a DevicePipe are
available. In the DevicePipe class, these methods simply forward their
action to the DevicePipe root blob. The same methods are available in
the DevicePipeBlob in case you need to use the recursivity provided by
this data structure.</p>
<div class="section" id="reading-a-pipe">
<h3>Reading a pipe<a class="headerlink" href="#reading-a-pipe" title="Permalink to this headline">¶</a></h3>
<p>When you read a pipe, you have to extract data received from the pipe.
Because data transferred through a pipe can change at any moment, two
differents cases are possible:</p>
<ol class="arabic simple">
<li>The client has a prior knowledge of what should be transferred
through the pipe</li>
<li>The client does not know at all what has been received through the
pipe</li>
</ol>
<p>Those two cases are detailed in the following sub-chapters.</p>
<div class="section" id="extracting-data-with-pipe-content-prior-knowledge">
<h4>Extracting data with pipe content prior knowledge<a class="headerlink" href="#extracting-data-with-pipe-content-prior-knowledge" title="Permalink to this headline">¶</a></h4>
<p>To extract data from a DevicePipe object (or from a DevicePipeBlob
object), you have to use its extraction operator &gt;&gt;. Let’s suppose that
we already know (prior knowledge) that the pipe contains 3 data elements
with a Tango long, an array of double and finally an array of unsigned
short. The code you need to extract these data is (Without error case
treatment detailed in a next sub-chapter)</p>
<pre class="code cpp literal-block">
<span class="ln"> 1 </span> <span class="name">DevicePipe</span> <span class="name">dp</span> <span class="operator">=</span> <span class="name">mydev</span><span class="punctuation">.</span><span class="name">read_pipe</span><span class="punctuation">(</span><span class="literal string">&quot;MyPipe&quot;</span><span class="punctuation">);</span>
<span class="ln"> 2 </span>
<span class="ln"> 3 </span> <span class="name">DevLong</span> <span class="name">dl</span><span class="punctuation">;</span>
<span class="ln"> 4 </span> <span class="name">vector</span><span class="operator">&lt;</span><span class="keyword type">double</span><span class="operator">&gt;</span> <span class="name">v_db</span><span class="punctuation">;</span>
<span class="ln"> 5 </span> <span class="name">DevVarUShortArray</span> <span class="operator">*</span><span class="name">dvush</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="name">DevVarUShortArray</span><span class="punctuation">();</span>
<span class="ln"> 6 </span>
<span class="ln"> 7 </span> <span class="name">dp</span> <span class="operator">&gt;&gt;</span> <span class="name">dl</span> <span class="operator">&gt;&gt;</span> <span class="name">v_db</span> <span class="operator">&gt;&gt;</span> <span class="name">dvush</span><span class="punctuation">;</span>
<span class="ln"> 8 </span>
<span class="ln"> 9 </span> <span class="keyword">delete</span> <span class="name">dvush</span><span class="punctuation">;</span>
</pre>
<p>The pipe is read at line 1. Pipe (or root blob) data extracttion is at
line 7. As you can see, it is just a matter of chaining extraction
operator (&gt;&gt;) into local data (declared line 3 to 5). In this example,
the transported array of double is extracted into a C++ vector while the
unsigned short array is extracted in a Tango sequence data type. When
you extract data into a vector, there is a unavoidable memory copy
between the DevicePipe object and the vector. When you extract data in a
Tango sequence data type, there is no memory copy but the extraction
method consumes the memory and it is therefore caller responsability to
delete the memory. This is the rule of line 9. If there is a
DevicePipeBlob inside the DevicePipe, simply extract it into one
instance of the DevicePipeBlob class.</p>
<p>You may notice that the pipe root blob data elements name are lost in
the previous example. The Tango API also has a DataElement class which
allows you to retrieve/set data element name. The following code is how
you can extract pipe data and retrieve data element name (same pipe then
previously)</p>
<pre class="code cpp literal-block">
<span class="ln"> 1 </span> <span class="name">DevicePipe</span> <span class="name">dp</span> <span class="operator">=</span> <span class="name">mydev</span><span class="punctuation">.</span><span class="name">read_pipe</span><span class="punctuation">(</span><span class="literal string">&quot;MyPipe&quot;</span><span class="punctuation">);</span>
<span class="ln"> 2 </span>
<span class="ln"> 3 </span> <span class="name">DataElement</span><span class="operator">&lt;</span><span class="name">DevLong</span><span class="operator">&gt;</span> <span class="name">de_dl</span><span class="punctuation">;</span>
<span class="ln"> 4 </span> <span class="name">DataElement</span><span class="operator">&lt;</span><span class="name">vector</span><span class="operator">&lt;</span><span class="keyword type">double</span><span class="operator">&gt;</span> <span class="operator">&gt;</span> <span class="name">de_v_db</span><span class="punctuation">;</span>
<span class="ln"> 5 </span> <span class="name">DataElement</span><span class="operator">&lt;</span><span class="name">DevVarUShortArray</span> <span class="operator">*&gt;</span> <span class="name">de_dvush</span><span class="punctuation">(</span><span class="keyword">new</span> <span class="name">DevVarUShortArray</span><span class="punctuation">());</span>
<span class="ln"> 6 </span>
<span class="ln"> 7 </span> <span class="name">dp</span> <span class="operator">&gt;&gt;</span> <span class="name">de_dl</span> <span class="operator">&gt;&gt;</span> <span class="name">de_v_db</span> <span class="operator">&gt;&gt;</span> <span class="name">de_dvush</span><span class="punctuation">;</span>
<span class="ln"> 8 </span>
<span class="ln"> 9 </span> <span class="keyword">delete</span> <span class="name">de_dvush</span><span class="punctuation">.</span><span class="name">value</span><span class="punctuation">;</span>
</pre>
<p>The extraction line (number 7) is similar to the previous case but local
data are instances of DataElement class. This is template class and
instances are created at lines 4 to 6. Each DataElement instance has
only two elements which are:</p>
<ol class="arabic simple">
<li>The data element name (a C++ string): <em>name</em></li>
<li>The data element value (One instance of the template parameter):
<em>value</em></li>
</ol>
</div>
<div class="section" id="extracting-data-in-a-generic-way-without-prior-knowledge">
<h4>Extracting data in a generic way (without prior knowledge)<a class="headerlink" href="#extracting-data-in-a-generic-way-without-prior-knowledge" title="Permalink to this headline">¶</a></h4>
<p>Due to the dynamicity of the data transferred through a pipe, the API
alows to extract data from a pipe without any prior knowledge of its
content. This is achived with methods <em>get_data_elt_nb()</em>,
<em>get_data_elt_type()</em>, <em>get_data_elt_name()</em> and the extraction
operator &gt;&gt;. These methods belong to the DevicePipeBlob class but they
also exist on the DevicePipe class for its root blob. Here is one
example of how you use them:</p>
<pre class="code cpp literal-block">
<span class="ln"> 1 </span>  <span class="name">DevicePipe</span> <span class="name">dp</span> <span class="operator">=</span> <span class="name">mydev</span><span class="punctuation">.</span><span class="name">read_pipe</span><span class="punctuation">(</span><span class="literal string">&quot;MyPipe&quot;</span><span class="punctuation">);</span>
<span class="ln"> 2 </span>
<span class="ln"> 3 </span>  <span class="keyword type">size_t</span> <span class="name">nb_de</span> <span class="operator">=</span> <span class="name">dp</span><span class="punctuation">.</span><span class="name">get_data_elt_nb</span><span class="punctuation">();</span>
<span class="ln"> 4 </span>  <span class="keyword">for</span> <span class="punctuation">(</span><span class="keyword type">size_t</span> <span class="name">loop</span> <span class="operator">=</span> <span class="literal number integer">0</span><span class="punctuation">;</span><span class="name">loop</span> <span class="operator">&lt;</span> <span class="name">nb_de</span><span class="punctuation">;</span><span class="name">loop</span><span class="operator">++</span><span class="punctuation">)</span>
<span class="ln"> 5 </span>  <span class="punctuation">{</span>
<span class="ln"> 6 </span>     <span class="keyword type">int</span> <span class="name">data_type</span> <span class="operator">=</span> <span class="name">dp</span><span class="punctuation">.</span><span class="name">get_data_elt_type</span><span class="punctuation">(</span><span class="name">loop</span><span class="punctuation">);</span>
<span class="ln"> 7 </span>     <span class="name">string</span> <span class="name">de_name</span> <span class="operator">=</span> <span class="name">dp</span><span class="punctuation">.</span><span class="name">get_data_elt_name</span><span class="punctuation">(</span><span class="name">loop</span><span class="punctuation">);</span>
<span class="ln"> 8 </span>     <span class="keyword">switch</span><span class="punctuation">(</span><span class="name">data_type</span><span class="punctuation">)</span>
<span class="ln"> 9 </span>     <span class="punctuation">{</span>
<span class="ln">10 </span>        <span class="keyword">case</span> <span class="name label">DEV_LONG</span><span class="punctuation">:</span>
<span class="ln">11 </span>        <span class="punctuation">{</span>
<span class="ln">12 </span>            <span class="name">DevLong</span> <span class="name">lg</span><span class="punctuation">;</span>
<span class="ln">13 </span>            <span class="name">dp</span> <span class="operator">&gt;&gt;</span> <span class="name">lg</span><span class="punctuation">;</span>
<span class="ln">14 </span>        <span class="punctuation">}</span>
<span class="ln">15 </span>        <span class="keyword">break</span><span class="punctuation">;</span>
<span class="ln">16 </span>
<span class="ln">17 </span>        <span class="keyword">case</span> <span class="name label">DEVVAR_DOUBLEARRAY</span><span class="punctuation">:</span>
<span class="ln">18 </span>        <span class="punctuation">{</span>
<span class="ln">19 </span>            <span class="name">vector</span><span class="operator">&lt;</span><span class="keyword type">double</span><span class="operator">&gt;</span> <span class="name">v_db</span><span class="punctuation">;</span>
<span class="ln">20 </span>            <span class="name">dp</span> <span class="operator">&gt;&gt;</span> <span class="name">v_db</span><span class="punctuation">;</span>
<span class="ln">21 </span>        <span class="punctuation">}</span>
<span class="ln">22 </span>        <span class="keyword">break</span><span class="punctuation">;</span>
<span class="ln">23 </span>        <span class="punctuation">....</span>
<span class="ln">24 </span>    <span class="punctuation">}</span>
<span class="ln">25 </span>    <span class="punctuation">...</span>
<span class="ln">26 </span> <span class="punctuation">}</span>
</pre>
<p>The number of data element in the pipe root blob is retrieve at line 3.
Then a loop for each data element is coded. For each data element, its
value data type and its name are retrieved at lines 6 and 7. Then,
according to the data element value data type, the data are extracted
using the classical extraction operator (lines 13 or 20)</p>
</div>
<div class="section" id="error-management">
<h4>Error management<a class="headerlink" href="#error-management" title="Permalink to this headline">¶</a></h4>
<p>By default, in case of error, the DevicePipe object throws different
kind of exceptions according to the error kind. It is possible to
disable exception throwing. If you do so, the code has to test the
DevicePipe state after extraction. The possible error cases are:</p>
<ul class="simple">
<li>DevicePipe object is empty</li>
<li>Wrong data type for extraction (For instance extraction into a double
data while the DataElement contains a string)</li>
<li>Wrong number of DataElement (Extraction code extract 5 data element
while the pipe contains only four)</li>
<li>Mix of extraction (or insertion) method kind (classical operators &lt;&lt;
or &gt;&gt;) and [] operator.</li>
</ul>
<p>Methods <em>exceptions()</em> and <em>reset_exceptions()</em> of the DevicePipe and
DevicePipeBlob classes allow the user to select which kind of error he
is interested in. For error treatment without exceptions, methods
<em>has_failed()</em> and <em>state()</em> has to be used. See reference
documentation for details about these methods.</p>
</div>
</div>
<div class="section" id="writing-a-pipe">
<h3>Writing a pipe<a class="headerlink" href="#writing-a-pipe" title="Permalink to this headline">¶</a></h3>
<p>Writing data into a DevicePipe or a DevicePipeBlob is similar to reading
data from a pipe. The main method is the insertion operator &lt;&lt;. Let’s
have a look at a first example if you want to write a pipe with a Tango
long, a vector of double and finally an array of unsigned short.</p>
<pre class="code cpp literal-block">
<span class="ln"> 1 </span>  <span class="name">DevicePipe</span> <span class="name function">dp</span><span class="punctuation">(</span><span class="literal string">&quot;MyPipe&quot;</span><span class="punctuation">);</span>
<span class="ln"> 2 </span>
<span class="ln"> 3 </span>  <span class="name">vector</span><span class="operator">&lt;</span><span class="name">string</span><span class="operator">&gt;</span> <span class="name">de_names</span> <span class="punctuation">{</span><span class="literal string">&quot;FirstDE&quot;</span><span class="punctuation">,</span><span class="literal string">&quot;SecondDE&quot;</span><span class="punctuation">,</span><span class="literal string">&quot;ThirdDE&quot;</span><span class="punctuation">};</span>
<span class="ln"> 4 </span>  <span class="name">db</span><span class="punctuation">.</span><span class="name">set_data_elt_names</span><span class="punctuation">(</span><span class="name">de_names</span><span class="punctuation">);</span>
<span class="ln"> 5 </span>
<span class="ln"> 6 </span>  <span class="name">DevLong</span> <span class="name">dl</span> <span class="operator">=</span> <span class="literal number integer">666</span><span class="punctuation">;</span>
<span class="ln"> 7 </span>  <span class="name">vector</span><span class="operator">&lt;</span><span class="keyword type">double</span><span class="operator">&gt;</span> <span class="name">v_db</span> <span class="punctuation">{</span><span class="literal number float">1.11</span><span class="punctuation">,</span><span class="literal number float">2.22</span><span class="punctuation">};</span>
<span class="ln"> 8 </span>  <span class="keyword type">unsigned</span> <span class="keyword type">short</span> <span class="operator">*</span><span class="name">array</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="keyword type">unsigned</span> <span class="keyword type">short</span> <span class="punctuation">[</span><span class="literal number integer">100</span><span class="punctuation">];</span>
<span class="ln"> 9 </span>  <span class="name">DevVarUShortArray</span> <span class="operator">*</span><span class="name">dvush</span> <span class="operator">=</span> <span class="name">create_DevVarUShortArray</span><span class="punctuation">(</span><span class="name">array</span><span class="punctuation">,</span><span class="literal number integer">100</span><span class="punctuation">);</span>
<span class="ln">10 </span>
<span class="ln">11 </span> <span class="keyword">try</span>
<span class="ln">12 </span> <span class="punctuation">{</span>
<span class="ln">13 </span>    <span class="name">dp</span> <span class="operator">&lt;&lt;</span> <span class="name">dl</span> <span class="operator">&lt;&lt;</span> <span class="name">v_db</span> <span class="operator">&lt;&lt;</span> <span class="name">dvush</span><span class="punctuation">;</span>
<span class="ln">14 </span>    <span class="name">mydev</span><span class="punctuation">.</span><span class="name">write_pipe</span><span class="punctuation">(</span><span class="name">dp</span><span class="punctuation">);</span>
<span class="ln">15 </span> <span class="punctuation">}</span>
<span class="ln">16 </span> <span class="keyword">catch</span> <span class="punctuation">(</span><span class="name">DevFailed</span> <span class="operator">&amp;</span><span class="name">e</span><span class="punctuation">)</span>
<span class="ln">17 </span> <span class="punctuation">{</span>
<span class="ln">18 </span>    <span class="name">cout</span> <span class="operator">&lt;&lt;</span> <span class="literal string">&quot;DevicePipeBlob insertion failed&quot;</span> <span class="operator">&lt;&lt;</span> <span class="name">endl</span><span class="punctuation">;</span>
<span class="ln">19 </span>    <span class="punctuation">....</span>
<span class="ln">20 </span> <span class="punctuation">}</span>
</pre>
<p>Insertion into the DevicePipe is done at line 12 with the insert
operators. The main difference with extracting data from the pipe is at
line 3 and 4. When inserting data into a pipe, you need to FIRST define
its number od name of data elements. In our example, the device pipe is
initialized to carry three data element and the names of these data
elements is defined at line 4. This is a mandatory requirement. If you
don’t define data element number, exception will be thrown during the
use of insertion methods. The population of the array used for the third
pipe data element is not represented here.</p>
<p>It’s also possible to use DataElement class instances to set the pipe
data element. Here is the previous example modified to use DataElement
class.</p>
<pre class="code cpp literal-block">
<span class="ln"> 1 </span>  <span class="name">DevicePipe</span> <span class="name function">dp</span><span class="punctuation">(</span><span class="literal string">&quot;MyPipe&quot;</span><span class="punctuation">);</span>
<span class="ln"> 2 </span>
<span class="ln"> 3 </span>  <span class="name">DataElement</span><span class="operator">&lt;</span><span class="name">DevLong</span><span class="operator">&gt;</span> <span class="name">de_dl</span><span class="punctuation">(</span><span class="literal string">&quot;FirstElt&quot;</span><span class="punctuation">,</span><span class="literal number integer">666</span><span class="punctuation">);</span>
<span class="ln"> 4 </span>  <span class="name">vector</span><span class="operator">&lt;</span><span class="keyword type">double</span><span class="operator">&gt;</span>  <span class="name">v_db</span> <span class="punctuation">{</span><span class="literal number float">1.11</span><span class="punctuation">,</span><span class="literal number float">2.22</span><span class="punctuation">};</span>
<span class="ln"> 5 </span>  <span class="name">DataElement</span><span class="operator">&lt;</span><span class="name">vector</span><span class="operator">&lt;</span><span class="keyword type">double</span><span class="operator">&gt;</span> <span class="operator">&gt;</span> <span class="name">de_v_db</span><span class="punctuation">(</span><span class="literal string">&quot;SecondElt,v_db);</span>
<span class="ln"> 6 </span>
<span class="ln"> 7 </span>  <span class="keyword type">unsigned</span> <span class="keyword type">short</span> <span class="operator">*</span><span class="name">array</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="keyword type">unsigned</span> <span class="keyword type">short</span> <span class="punctuation">[</span><span class="literal number integer">100</span><span class="punctuation">];</span>
<span class="ln"> 8 </span>  <span class="name">DevVarUShortArray</span> <span class="operator">*</span><span class="name">dvush</span> <span class="operator">=</span> <span class="name">create_DevVarUShortArray</span><span class="punctuation">(</span><span class="name">array</span><span class="punctuation">,</span><span class="literal number integer">100</span><span class="punctuation">);</span>
<span class="ln"> 9 </span>  <span class="name">DataElement</span><span class="operator">&lt;</span><span class="name">DevVarUShortArray</span> <span class="operator">*&gt;</span> <span class="name">de_dvush</span><span class="punctuation">(</span><span class="literal string">&quot;ThirdDE&quot;</span><span class="punctuation">,</span><span class="name">array</span><span class="punctuation">);</span>
<span class="ln">10 </span>
<span class="ln">11 </span> <span class="keyword">try</span>
<span class="ln">12 </span> <span class="punctuation">{</span>
<span class="ln">13 </span>    <span class="name">dp</span> <span class="operator">&lt;&lt;</span> <span class="name">de_dl</span> <span class="operator">&lt;&lt;</span> <span class="name">de_v_db</span> <span class="operator">&lt;&lt;</span> <span class="name">de_dvush</span><span class="punctuation">;</span>
<span class="ln">14 </span>    <span class="name">mydev</span><span class="punctuation">.</span><span class="name">write_pipe</span><span class="punctuation">(</span><span class="name">dp</span><span class="punctuation">);</span>
<span class="ln">15 </span> <span class="punctuation">}</span>
<span class="ln">16 </span> <span class="keyword">catch</span> <span class="punctuation">(</span><span class="name">DevFailed</span> <span class="operator">&amp;</span><span class="name">e</span><span class="punctuation">)</span>
<span class="ln">17 </span> <span class="punctuation">{</span>
<span class="ln">18 </span>    <span class="name">cout</span> <span class="operator">&lt;&lt;</span> <span class="literal string">&quot;DevicePipeBlob insertion failed&quot;</span> <span class="operator">&lt;&lt;</span> <span class="name">endl</span><span class="punctuation">;</span>
<span class="ln">19 </span>    <span class="punctuation">....</span>
<span class="ln">20 </span> <span class="punctuation">}</span>
</pre>
<p>The population of the array used for the third pipe data element is not
represented here. Finally, there is a third way to insert data into a
device pipe. You have to defined number and names of the data element
within the pipe (similar to first insertion method) but you are able to
insert data into the data element in any order using the operator
overwritten for the DevicePipe and DevicePipeBlob classes. Look at the
following example:</p>
<pre class="code cpp literal-block">
<span class="ln"> 1 </span>  <span class="name">DevicePipe</span> <span class="name function">dp</span><span class="punctuation">(</span><span class="literal string">&quot;MyPipe&quot;</span><span class="punctuation">);</span>
<span class="ln"> 2 </span>
<span class="ln"> 3 </span>  <span class="name">vector</span><span class="operator">&lt;</span><span class="name">string</span><span class="operator">&gt;</span> <span class="name">de_names</span> <span class="punctuation">{</span><span class="literal string">&quot;FirstDE&quot;</span><span class="punctuation">,</span><span class="literal string">&quot;SecondDE&quot;</span><span class="punctuation">,</span><span class="literal string">&quot;ThirdDE&quot;</span><span class="punctuation">};</span>
<span class="ln"> 4 </span>  <span class="name">db</span><span class="punctuation">.</span><span class="name">set_data_elt_names</span><span class="punctuation">(</span><span class="name">de_names</span><span class="punctuation">);</span>
<span class="ln"> 5 </span>
<span class="ln"> 6 </span>  <span class="name">DevLong</span> <span class="name">dl</span> <span class="operator">=</span> <span class="literal number integer">666</span><span class="punctuation">;</span>
<span class="ln"> 7 </span>  <span class="name">vector</span><span class="operator">&lt;</span><span class="keyword type">double</span><span class="operator">&gt;</span> <span class="name">v_db</span> <span class="operator">=</span> <span class="punctuation">{</span><span class="literal number float">1.11</span><span class="punctuation">,</span><span class="literal number float">2.22</span><span class="punctuation">};</span>
<span class="ln"> 8 </span>  <span class="keyword type">unsigned</span> <span class="keyword type">short</span> <span class="operator">*</span><span class="name">array</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="keyword type">unsigned</span> <span class="keyword type">short</span> <span class="punctuation">[</span><span class="literal number integer">100</span><span class="punctuation">];</span>
<span class="ln"> 9 </span>  <span class="name">DevVarUShortArray</span> <span class="operator">*</span><span class="name">dvush</span> <span class="operator">=</span> <span class="name">create_DevVarUShortArray</span><span class="punctuation">(</span><span class="name">array</span><span class="punctuation">,</span><span class="literal number integer">100</span><span class="punctuation">);</span>
<span class="ln">10 </span>
<span class="ln">11 </span> <span class="name">dp</span><span class="punctuation">[</span><span class="literal string">&quot;SecondDE&quot;</span><span class="punctuation">]</span> <span class="operator">&lt;&lt;</span> <span class="name">v_db</span><span class="punctuation">;</span>
<span class="ln">12 </span> <span class="name">dp</span><span class="punctuation">[</span><span class="literal string">&quot;FirstDE&quot;</span><span class="punctuation">]</span> <span class="operator">&lt;&lt;</span> <span class="name">dl</span><span class="punctuation">;</span>
<span class="ln">13 </span> <span class="name">dp</span><span class="punctuation">[</span><span class="literal string">&quot;ThirdDE&quot;</span><span class="punctuation">]</span> <span class="operator">&lt;&lt;</span> <span class="name">dvush</span><span class="punctuation">;</span>
</pre>
<p>Insertion into the device pipe is now done at lines 11 to 13. The
population of the array used for the third pipe data element is not
represented here. Note that the data element name is case insensitive.</p>
<div class="section" id="id6">
<h4>Error management<a class="headerlink" href="#id6" title="Permalink to this headline">¶</a></h4>
<p>When inserting data into a DevicePipe or a DevicePipeBlob, error
management is very similar to reading data from from a DevicePipe or a
DevicePipeBlob. The difference is that there is one more case which
could trigger one exception during the insertion. This case is</p>
<ul class="simple">
<li>Insertion into the DevicePipe (or DevicePipeBlob) if its data element
number have not been set.</li>
</ul>
</div>
</div>
</div>
<div class="section" id="device-locking">
<h2>Device locking<a class="headerlink" href="#device-locking" title="Permalink to this headline">¶</a></h2>
<p>Starting with Tango release 7 (and device inheriting from
Device_4Impl), device locking is supported. For instance, this feature
could be used by an application doing a scan on a synchrotron beam line.
In such a case, you want to move an actuator then read a sensor, move
the actuator again, read the sensor…You don’t want the actuator to be
moved by another client while the application is doing the scan. If the
application doing the scan locks the actuator device, it will be sure
that this device is reserved for the application doing the scan and
other client will not be able to move it until the scan application
un-locks this actuator.</p>
<p>A locked device is protected against:</p>
<ul class="simple">
<li><em>command_inout</em> call except for device state and status requested
via command and for the set of commands defined as allowed following
the definition of allowed command in the Tango control access schema.</li>
<li><em>write_attribute</em> and <em>write_pipe</em> call</li>
<li><em>write_read_attribute, write_read_attributes</em> and
<em>write_read_pipe</em> call</li>
<li><em>set_attribute_config</em> and <em>set_pipe_config</em> call</li>
<li>polling and logging commands related to the locked device</li>
</ul>
<p>Other clients trying to do one of these calls on a locked device will
get a DevFailed exception. In case of application with locked device
crashed, the lock will be automatically release after a defined
interval. The API provides a set of methods for application code to
lock/unlock device. These methods are:</p>
<ul class="simple">
<li><em>DeviceProxy::lock()</em> and <em>DeviceProxy::unlock()</em> to lock/unlock
device</li>
<li><em>DeviceProxy::locking_status()</em>, <em>DeviceProxy::is_locked()</em>,
<em>DeviceProxy::is_locked_by_me()</em> and <em>DeviceProxy::get_locker()</em>
to get locking information</li>
</ul>
<p>These methods are precisely described in the API reference chapters.</p>
</div>
<div class="section" id="reconnection-and-exception">
<h2>Reconnection and exception<a class="headerlink" href="#reconnection-and-exception" title="Permalink to this headline">¶</a></h2>
<p>The Tango API automatically manages re-connection between client and
server in case of communication error during a network access between a
client and a server. By default, when a communication error occurs, an
exception is returned to the caller and the connection is internally
marked as bad. On the next try to contact the device, the API will try
to re-build the network connection. With the
<em>set_transparency_reconnection()</em> method of the DeviceProxy class, it
is even possible not to have any exception thrown in case of
communication error. The API will try to re-build the network connection
as soon as it is detected as bad. This is the default mode. See
<a class="reference internal" href="#reconnection-and-exception">Reconnection and exception</a> for more details on this subject.</p>
</div>
<div class="section" id="thread-safety">
<h2>Thread safety<a class="headerlink" href="#thread-safety" title="Permalink to this headline">¶</a></h2>
<p>Starting with Tango 7.2, some classes of the C++ API has been made
thread safe. These classes are:</p>
<ul class="simple">
<li>DeviceProxy</li>
<li>Database</li>
<li>Group</li>
<li>ApiUtil</li>
<li>AttributeProxy</li>
</ul>
<p>This means that it is possible to share between threads a pointer to a
DeviceProxy instance. It is safe to execute a call on this DeviceProxy
instance while another thread is also doing a call to the same
DeviceProxy instance. Obviously, this also means that it is possible to
create thread local DeviceProxy instances and to execute method calls on
these instances. Nevertheless, data local to a DeviceProxy instance like
its timeout are not managed on a per thread basis. For a DeviceProxy
instance shared between two threads, if thread 1 changes the instance
timeout, thread 2 will also see this change.</p>
</div>
<div class="section" id="compiling-and-linking-a-tango-client">
<h2>Compiling and linking a Tango client<a class="headerlink" href="#compiling-and-linking-a-tango-client" title="Permalink to this headline">¶</a></h2>
<p>Compiling and linking a Tango client is similar to compiling and linking
a Tango device server. Please, refer to chapter
<a class="reference internal" href="../device-api/device-server-writing.html#compiling-device-server"><span class="std std-ref">Compiling and linking a C++ device server</span></a>
to get all the details.</p>
<table class="docutils footnote" frame="void" id="id7" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id2">[1]</a></td><td>note: the polling is not synchronized is currently not synchronized
on the hour</td></tr>
</tbody>
</table>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="atk-programmers-guide.html" class="btn btn-neutral float-right" title="TangoATK Programmer’s Guide" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="index.html" class="btn btn-neutral" title="Tango Client" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, Tango Community, Creative Commons Attribution 4.0 International (CC BY 4.0).

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../',
            VERSION:'9.2.5',
            LANGUAGE:'en',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>
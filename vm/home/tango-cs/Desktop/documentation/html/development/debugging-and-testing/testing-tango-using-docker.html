

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Using Tango docker containers &mdash; Tango Controls 9.2.5 documentation</title>
  

  
  
    <link rel="shortcut icon" href="../../_static/favicon.png"/>
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="../../genindex.html"/>
        <link rel="search" title="Search" href="../../search.html"/>
    <link rel="top" title="Tango Controls 9.2.5 documentation" href="../../index.html"/>
        <link rel="up" title="Debugging and Testing" href="index.html"/>
        <link rel="next" title="Advanced" href="../advanced/index.html"/>
        <link rel="prev" title="Debugging and Testing" href="index.html"/> 

  
  <script src="../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../contents.html" class="icon icon-home"> Tango Controls
          

          
            
            <img src="../../_static/logo_tangocontrols_white.png" class="logo" />
          
          </a>

          
            
            
              <div class="version">
                9.2
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../index.html">Welcome to Tango Controls documentation!</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../authors.html">Authors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../overview/index.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../installation/index.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../getting-started/index.html">Getting Started</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Developer’s Guide</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../overview.html">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../general-guidelines/index.html">General guidelines</a></li>
<li class="toctree-l2"><a class="reference internal" href="../corba.html">10 things you should know about CORBA</a></li>
<li class="toctree-l2"><a class="reference internal" href="../client-api/index.html">Tango Client</a></li>
<li class="toctree-l2"><a class="reference internal" href="../device-api/index.html">Device Servers</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html">Debugging and Testing</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">Using Tango docker containers</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../advanced/index.html">Advanced</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cpp-api/index.html">Tango Core C++ Classes Reference Documentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../contributing/index.html">Contributing</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../tools-and-extensions/index.html">Tools and Extensions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../administration/index.html">Administration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials-and-howtos/index.html">Tutorials and How-Tos</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../reference/index.html">Reference</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../contents.html">Tango Controls</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../contents.html">Docs</a> &raquo;</li>
        
          <li><a href="../index.html">Developer’s Guide</a> &raquo;</li>
        
          <li><a href="index.html">Debugging and Testing</a> &raquo;</li>
        
      <li>Using Tango docker containers</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/development/debugging-and-testing/testing-tango-using-docker.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <p>level: advanced; target: Tango developer</p>
<div class="section" id="using-tango-docker-containers">
<h1>Using Tango docker containers<a class="headerlink" href="#using-tango-docker-containers" title="Permalink to this headline">¶</a></h1>
<p>In this section we describe how one can test newly developed tango device server using <a href="#id1"><span class="problematic" id="id2">`docker https://www.docker.com/`_</span></a> containers.</p>
<p>Tango docker containers provide a lightweight solution for deploying tango.</p>
<p>To get info on how to install docker on your machine please refer to the docker <a href="#id3"><span class="problematic" id="id4">`documentation https://docs.docker.com/engine/installation/`_</span></a>.</p>
<p>Once docker is installed one can pull docker images with pre-installed tango.</p>
<div class="section" id="tango-docker-containers">
<h2>Tango docker containers<a class="headerlink" href="#tango-docker-containers" title="Permalink to this headline">¶</a></h2>
<p>Tango provides two docker containers: mysql container with Tango scheme and tango-cs container with minimal set of Tango servers.</p>
<p>These containers can be found in the corresponding repositories:
<a class="reference external" href="https://github.com/tango-controls/docker-mysql">https://github.com/tango-controls/docker-mysql</a></p>
<p><a class="reference external" href="https://github.com/tango-controls/tango-cs-docker">https://github.com/tango-controls/tango-cs-docker</a></p>
<div class="section" id="tango-docker-stack">
<h3>Tango docker stack<a class="headerlink" href="#tango-docker-stack" title="Permalink to this headline">¶</a></h3>
<p>Typical tango stack looks like this:</p>
<img alt="../../_images/tango-stack.png" src="../../_images/tango-stack.png" />
<p>The best way to setup the whole stack is to use <a class="reference external" href="https://docs.docker.com/compose/">docker compose</a></p>
<p>Here is an example of docker-compose.yml:</p>
<div class="highlight-yaml"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">version</span><span class="p p-Indicator">:</span> <span class="s">&#39;2&#39;</span>
<span class="l l-Scalar l-Scalar-Plain">services</span><span class="p p-Indicator">:</span>
  <span class="l l-Scalar l-Scalar-Plain">tango-db</span><span class="p p-Indicator">:</span>
    <span class="l l-Scalar l-Scalar-Plain">image</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">tangocs/mysql:9.2.2</span>
    <span class="l l-Scalar l-Scalar-Plain">ports</span><span class="p p-Indicator">:</span>
     <span class="p p-Indicator">-</span> <span class="s">&quot;9999:3306&quot;</span>
    <span class="l l-Scalar l-Scalar-Plain">environment</span><span class="p p-Indicator">:</span>
     <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">MYSQL_ROOT_PASSWORD=root</span>
  <span class="l l-Scalar l-Scalar-Plain">tango-cs</span><span class="p p-Indicator">:</span>
    <span class="l l-Scalar l-Scalar-Plain">image</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">tangocs/tango-cs:9</span>
    <span class="l l-Scalar l-Scalar-Plain">ports</span><span class="p p-Indicator">:</span>
     <span class="p p-Indicator">-</span> <span class="s">&quot;10000:10000&quot;</span>
    <span class="l l-Scalar l-Scalar-Plain">environment</span><span class="p p-Indicator">:</span>
     <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">TANGO_HOST=localhost:10000</span>
     <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">MYSQL_HOST=tango-db:3306</span>
     <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">MYSQL_USER=tango</span>
     <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">MYSQL_PASSWORD=tango</span>
     <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">MYSQL_DATABASE=tango</span>
    <span class="l l-Scalar l-Scalar-Plain">depends_on</span><span class="p p-Indicator">:</span>
<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">tango-db</span>
</pre></div>
</div>
<p>Now to start the whole stack execute <strong class="command">docker-compose up</strong></p>
<p>Once docker containers are up and running one can access mysql on localhost:9999 and the tango host on localhost:10000</p>
<p>For instance, one can start jive [reference] (assuming it is installed on the system).</p>
</div>
<div class="section" id="tango-docker-stack-for-tango-rest-api">
<h3>Tango docker stack for Tango REST API<a class="headerlink" href="#tango-docker-stack-for-tango-rest-api" title="Permalink to this headline">¶</a></h3>
<p>One can setup Tango docker stack for Tango REST API [reference] as well. Currently only mtangorest.server [link] provides docker container that can be used together with Tango docker containers:
<a class="reference external" href="https://bitbucket.org/hzgwpn/mtangorest.docker">https://bitbucket.org/hzgwpn/mtangorest.docker</a></p>
<p>The following docker-compose.yml assembles the whole stack:</p>
<p>Note this is almost the same as the previous, expect we have added tango-rest node. Once <strong class="command">docker-compose up</strong> executed one can access Tango REST API at <a class="reference external" href="http://localhost:10001/tango/rest">http://localhost:10001/tango/rest</a></p>
</div>
</div>
<div class="section" id="extending-existing-containers">
<h2>Extending existing containers<a class="headerlink" href="#extending-existing-containers" title="Permalink to this headline">¶</a></h2>
<p>Applying additional SQL script to tangocs/mysql.</p>
<p>Since every docker image can be used as a base for another docker image one can create his own image. In this new image new SQL scripts can be applied to extend the exiting scheme, for instance to add new devices or adjust configuration.</p>
<p>An example of such extension could look like this:</p>
<p>[TODO script]</p>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../advanced/index.html" class="btn btn-neutral float-right" title="Advanced" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="index.html" class="btn btn-neutral" title="Debugging and Testing" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, Tango Community, Creative Commons Attribution 4.0 International (CC BY 4.0).

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../',
            VERSION:'9.2.5',
            LANGUAGE:'en',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>
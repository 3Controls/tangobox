

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Forwarded attribute &mdash; Tango Controls 9.2.5 documentation</title>
  

  
  
    <link rel="shortcut icon" href="../../_static/favicon.png"/>
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="../../genindex.html"/>
        <link rel="search" title="Search" href="../../search.html"/>
    <link rel="top" title="Tango Controls 9.2.5 documentation" href="../../index.html"/>
        <link rel="up" title="Device Servers" href="index.html"/>
        <link rel="next" title="Device polling" href="device-polling.html"/>
        <link rel="prev" title="Memorized attribute" href="memorized-attribute.html"/> 

  
  <script src="../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../contents.html" class="icon icon-home"> Tango Controls
          

          
            
            <img src="../../_static/logo_tangocontrols_white.png" class="logo" />
          
          </a>

          
            
            
              <div class="version">
                9.2
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../index.html">Welcome to Tango Controls documentation!</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../authors.html">Authors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../overview/index.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../installation/index.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../getting-started/index.html">Getting Started</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Developer’s Guide</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../overview.html">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../general-guidelines/index.html">General guidelines</a></li>
<li class="toctree-l2"><a class="reference internal" href="../corba.html">10 things you should know about CORBA</a></li>
<li class="toctree-l2"><a class="reference internal" href="../client-api/index.html">Tango Client</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html">Device Servers</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="introduction.html">Introduction to device server</a></li>
<li class="toctree-l3"><a class="reference internal" href="ds-guideline/index.html">TANGO Device Server Guidelines</a></li>
<li class="toctree-l3"><a class="reference internal" href="device-server-model.html">The TANGO device server model</a></li>
<li class="toctree-l3"><a class="reference internal" href="device-server-writing.html">Writing a TANGO device server</a></li>
<li class="toctree-l3"><a class="reference internal" href="attribute-alarms.html">Attribute alarms</a></li>
<li class="toctree-l3"><a class="reference internal" href="enumerated-attribute.html">Enumerated attribute</a></li>
<li class="toctree-l3"><a class="reference internal" href="memorized-attribute.html">Memorized attribute</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Forwarded attribute</a></li>
<li class="toctree-l3"><a class="reference internal" href="device-polling.html">Device polling</a></li>
<li class="toctree-l3"><a class="reference internal" href="generating-events.html">Generating events in a device server</a></li>
<li class="toctree-l3"><a class="reference internal" href="java/index.html">Tango Device in Java</a></li>
<li class="toctree-l3"><a class="reference internal" href="python/index.html">PyTango - a Python binding to Tango</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../debugging-and-testing/index.html">Debugging and Testing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../advanced/index.html">Advanced</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cpp-api/index.html">Tango Core C++ Classes Reference Documentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../contributing/index.html">Contributing</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../tools-and-extensions/index.html">Tools and Extensions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../administration/index.html">Administration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials-and-howtos/index.html">Tutorials and How-Tos</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../reference/index.html">Reference</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../contents.html">Tango Controls</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../contents.html">Docs</a> &raquo;</li>
        
          <li><a href="../index.html">Developer’s Guide</a> &raquo;</li>
        
          <li><a href="index.html">Device Servers</a> &raquo;</li>
        
      <li>Forwarded attribute</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/development/device-api/forwarded-attribute.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="forwarded-attribute">
<h1>Forwarded attribute<a class="headerlink" href="#forwarded-attribute" title="Permalink to this headline">¶</a></h1>
<div class="section" id="definition">
<h2>Definition<a class="headerlink" href="#definition" title="Permalink to this headline">¶</a></h2>
<p>Let’s take an example to explain what is a forwarded attribute. We
assume we have to write a Tango class for a ski lift in a ski resort
somewhere in the Alps. Obviously, the ski lift has a motor for which we
already have a Tango class. This motor Tango class has one attribute
<em>speed</em>. But for the ski lift, the motor speed is not the only thing
which has to be controlled. For instance, you also want to give access
to the wind sensor data installed on the top of the ski lift. Therefore,
you write a ski-lift Tango class representing the whole ski-lift system.
This ski-lift class will have at least two attributes which are:</p>
<ol class="arabic simple">
<li>The wind speed at the top of the ski-lift</li>
<li>The motor speed</li>
</ol>
<p>The ski-lift Tango class motor speed attribute is nothing more than the
motor Tango class speed attribute. All the ski-lift class has to do for
this attribute is to forward the request (read/write) to the speed
attribute of the motor Tango class. The speed attribute of the ski-lift
Tango class is a <strong>forwarded attribute</strong> while the speed attribute of
the motor Tango class is its <strong>root attribute</strong>.</p>
<p>A forwarded attribute get its configuration from its root attribute and
it forwards to its root attribute</p>
<ul class="simple">
<li>Its read / write / write_read requests</li>
<li>Its configuration change</li>
<li>Its event subscription</li>
<li>Its locking behavior</li>
</ul>
<p>As stated above, a forwarded attribute has the same configuration than
its root attribute except its <em>name</em> and <em>label</em> which stays local. All
other attribute configuration parameters are forwarded to the root
attribute. If a root attribute configuration parameter is changed, the
forwarded attribute is informed (via event) and its local configuration
is also modified.</p>
<p>The association between the forwarded attribute and its root attribute
is done using a property named</p>
<p>__root_att</p>
<p>belonging to the forwarded attribute. This property value is simply the
name of the root attribute. Muti-control system is supported and this
__root_att attribute property value can be something like
<em>tango://my_tango_host:10000/my/favorite/dev/the_root_attribute</em>.
The name of the root attribute is included in attribute configuration.</p>
<p>It is forbidden to poll a forwarded attribute and one exception is
thrown if such a case happens. Polling has to be done on the root
attribute. Nevertheless, if the root attribute is polled, a request to
read the forwarded attribute with the DeviceProxy object source
parameter set to CACHE_DEVICE or CACHE will get its data from the root
attribute polling buffer.</p>
<p>If you subscribe to event(s) on a forwarded attribute, the subscription
is forwarded to the root attribute. When the event is received by the
forwarded attribute, the attribute name in the event data is modified to
reflect the forwarded attribute name and the event is pushed to the
original client(s).</p>
<p>When a device with forwarded attribute is locked, the device to which
the root attribute belongs is also locked.</p>
</div>
<div class="section" id="coding">
<h2>Coding<a class="headerlink" href="#coding" title="Permalink to this headline">¶</a></h2>
<p>As explained in the chapter Writing a Tango device server, each Tango
class attribute is implemented via a C++ class which has to inherit from
either <em>Attr</em>, <em>SpectrumAttr</em> or <em>ImageAttr</em> according to the attribute
data format. For forwarded attribute, the related class has to inherit
from the <strong>FwdAttr</strong> class whatever its data format is. For classical
attribute, the programmer can define in the Tango class code default
value for the attribute properties using one instance of the
<em>UserDefaultAttrProp</em> class. For forwarded attribute, the programmer has
to create one instance of the <strong>UserDefaultFwdAttrProp</strong> class but only
the attribute label can be defined. One example of how to program a
forwarded attribute is given below</p>
<pre class="code cpp literal-block">
<span class="ln"> 1 </span>  <span class="keyword">class</span> <span class="name class">MyFwdAttr</span><span class="operator">:</span> <span class="keyword">public</span> <span class="name">Tango</span><span class="operator">::</span><span class="name">FwdAttr</span>
<span class="ln"> 2 </span>  <span class="punctuation">{</span>
<span class="ln"> 3 </span>  <span class="keyword">public</span><span class="operator">:</span>
<span class="ln"> 4 </span>      <span class="name">MyFwdAttr</span><span class="punctuation">(</span><span class="keyword">const</span> <span class="name">string</span> <span class="operator">&amp;</span><span class="name">_n</span><span class="punctuation">)</span><span class="operator">:</span><span class="name">FwdAttr</span><span class="punctuation">(</span><span class="name">_n</span><span class="punctuation">)</span> <span class="punctuation">{};</span>
<span class="ln"> 5 </span>      <span class="operator">~</span><span class="name">MyFwdAttr</span><span class="punctuation">()</span> <span class="punctuation">{};</span>
<span class="ln"> 6 </span>  <span class="punctuation">};</span>
<span class="ln"> 7 </span>
<span class="ln"> 8 </span>  <span class="keyword type">void</span> <span class="name">DevTestClass</span><span class="operator">::</span><span class="name">attribute_factory</span><span class="punctuation">(</span><span class="name">vector</span><span class="operator">&lt;</span><span class="name">Tango</span><span class="operator">::</span><span class="name">Attr</span> <span class="operator">*&gt;</span> <span class="operator">&amp;</span><span class="name">att_list</span><span class="punctuation">)</span>
<span class="ln"> 9 </span>  <span class="punctuation">{</span>
<span class="ln">10 </span>     <span class="punctuation">...</span>
<span class="ln">11 </span>     <span class="name">MyFwdAttr</span> <span class="operator">*</span><span class="name">att1</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="name">MyFwdAttr</span><span class="punctuation">(</span><span class="literal string">&quot;fwd_att_name&quot;</span><span class="punctuation">);</span>
<span class="ln">12 </span>     <span class="name">Tango</span><span class="operator">::</span><span class="name">UserDefaultFwdAttrProp</span> <span class="name">att1_prop</span><span class="punctuation">;</span>
<span class="ln">13 </span>     <span class="name">att1_prop</span><span class="punctuation">.</span><span class="name">set_label</span><span class="punctuation">(</span><span class="literal string">&quot;Gasp a fwd attribute&quot;</span><span class="punctuation">);</span>
<span class="ln">14 </span>     <span class="name">att1</span><span class="operator">-&gt;</span><span class="name">set_default_properties</span><span class="punctuation">(</span><span class="name">att1_prop</span><span class="punctuation">);</span>
<span class="ln">15 </span>     <span class="name">att_list</span><span class="punctuation">.</span><span class="name">push_back</span><span class="punctuation">(</span><span class="name">att1</span><span class="punctuation">);</span>
<span class="ln">16 </span>     <span class="punctuation">...</span>
<span class="ln">17 </span>  <span class="punctuation">}</span>
</pre>
<p>Line 1 : The forwarded attribute class inherits from FwdAttr class.</p>
<p>Line 4-5 : Only constructor and destructor methods are required</p>
<p>Line 11 : The attribute object is created</p>
<p>Line 12-14 : A default value for the forwarded attribute label is
defined.</p>
<p>Line 15: The forwarded attribute is added to the list of attribute</p>
<p>In case of error in the forwarded attribute configuration (for instance
missing __root_att property), the attribute is not created by the
Tango kernel and is therefore not visible for the external world. The
state of the device to which the forwarded attribute belongs to is set
to ALARM (if not already FAULT) and a detailed error report is available
in the device status. In case a device with forwarded attribute(s) is
started before the device(s) with the root attribute(s), the same
principle is used: forwarded attribute(s) are not created, device state
is set to ALARM and device status is reporting the error. When the
device(s) with the root attribute will start, the forwarded attributes
will automatically be created.</p>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="device-polling.html" class="btn btn-neutral float-right" title="Device polling" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="memorized-attribute.html" class="btn btn-neutral" title="Memorized attribute" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, Tango Community, Creative Commons Attribution 4.0 International (CC BY 4.0).

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../',
            VERSION:'9.2.5',
            LANGUAGE:'en',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>
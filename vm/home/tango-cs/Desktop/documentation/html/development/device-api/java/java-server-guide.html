

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Introduction &mdash; Tango Controls 9.2.5 documentation</title>
  

  
  
    <link rel="shortcut icon" href="../../../_static/favicon.png"/>
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="../../../genindex.html"/>
        <link rel="search" title="Search" href="../../../search.html"/>
    <link rel="top" title="Tango Controls 9.2.5 documentation" href="../../../index.html"/>
        <link rel="up" title="Tango Device in Java" href="index.html"/>
        <link rel="next" title="Debugging and Testing" href="../../debugging-and-testing/index.html"/>
        <link rel="prev" title="Tango Device in Java" href="index.html"/> 

  
  <script src="../../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../../contents.html" class="icon icon-home"> Tango Controls
          

          
            
            <img src="../../../_static/logo_tangocontrols_white.png" class="logo" />
          
          </a>

          
            
            
              <div class="version">
                9.2
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../index.html">Welcome to Tango Controls documentation!</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../authors.html">Authors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../overview/index.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../installation/index.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../getting-started/index.html">Getting Started</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../index.html">Developer’s Guide</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../overview.html">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../general-guidelines/index.html">General guidelines</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../corba.html">10 things you should know about CORBA</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../client-api/index.html">Tango Client</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../index.html">Device Servers</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../introduction.html">Introduction to device server</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ds-guideline/index.html">TANGO Device Server Guidelines</a></li>
<li class="toctree-l3"><a class="reference internal" href="../device-server-model.html">The TANGO device server model</a></li>
<li class="toctree-l3"><a class="reference internal" href="../device-server-writing.html">Writing a TANGO device server</a></li>
<li class="toctree-l3"><a class="reference internal" href="../attribute-alarms.html">Attribute alarms</a></li>
<li class="toctree-l3"><a class="reference internal" href="../enumerated-attribute.html">Enumerated attribute</a></li>
<li class="toctree-l3"><a class="reference internal" href="../memorized-attribute.html">Memorized attribute</a></li>
<li class="toctree-l3"><a class="reference internal" href="../forwarded-attribute.html">Forwarded attribute</a></li>
<li class="toctree-l3"><a class="reference internal" href="../device-polling.html">Device polling</a></li>
<li class="toctree-l3"><a class="reference internal" href="../generating-events.html">Generating events in a device server</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="index.html">Tango Device in Java</a><ul class="current">
<li class="toctree-l4 current"><a class="current reference internal" href="#">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="#a-first-device">A first device</a></li>
<li class="toctree-l4"><a class="reference internal" href="#device">Device</a></li>
<li class="toctree-l4"><a class="reference internal" href="#command">Command</a></li>
<li class="toctree-l4"><a class="reference internal" href="#attribute">Attribute</a></li>
<li class="toctree-l4"><a class="reference internal" href="#pipe">Pipe</a></li>
<li class="toctree-l4"><a class="reference internal" href="#init">Init</a></li>
<li class="toctree-l4"><a class="reference internal" href="#delete">Delete</a></li>
<li class="toctree-l4"><a class="reference internal" href="#state">State</a></li>
<li class="toctree-l4"><a class="reference internal" href="#status">Status</a></li>
<li class="toctree-l4"><a class="reference internal" href="#device-property">Device property</a></li>
<li class="toctree-l4"><a class="reference internal" href="#device-properties">Device properties</a></li>
<li class="toctree-l4"><a class="reference internal" href="#class-property">Class property</a></li>
<li class="toctree-l4"><a class="reference internal" href="#around-invoke">Around Invoke</a></li>
<li class="toctree-l4"><a class="reference internal" href="#state-machine">State machine</a></li>
<li class="toctree-l4"><a class="reference internal" href="#device-manager">Device Manager</a></li>
<li class="toctree-l4"><a class="reference internal" href="#dynamic-api">Dynamic API</a></li>
<li class="toctree-l4"><a class="reference internal" href="#default-dynamic-attributes-and-commands">Default dynamic attributes and commands</a></li>
<li class="toctree-l4"><a class="reference internal" href="#events">Events</a></li>
<li class="toctree-l4"><a class="reference internal" href="#error-management">Error management</a></li>
<li class="toctree-l4"><a class="reference internal" href="#logging">Logging</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../python/index.html">PyTango - a Python binding to Tango</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../debugging-and-testing/index.html">Debugging and Testing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../advanced/index.html">Advanced</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../cpp-api/index.html">Tango Core C++ Classes Reference Documentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../contributing/index.html">Contributing</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../tools-and-extensions/index.html">Tools and Extensions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../administration/index.html">Administration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../tutorials-and-howtos/index.html">Tutorials and How-Tos</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../reference/index.html">Reference</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../contents.html">Tango Controls</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../contents.html">Docs</a> &raquo;</li>
        
          <li><a href="../../index.html">Developer’s Guide</a> &raquo;</li>
        
          <li><a href="../index.html">Device Servers</a> &raquo;</li>
        
          <li><a href="index.html">Tango Device in Java</a> &raquo;</li>
        
      <li>Introduction</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../../_sources/development/device-api/java/java-server-guide.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="introduction">
<h1>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h1>
<p>This paper is a documentation intended for developers. It described how
to build a Java Tango Device. A background in the Java language is
strongly recommended. The pre-requisites are:</p>
<ul class="simple">
<li>The Java language Standard Edition :
<a class="reference external" href="http://www.oracle.com/technetwork/java/javase/documentation/index.html">http://www.oracle.com/technetwork/java/javase/documentation/index.html</a></li>
<li>The concept of annotations introduced in Java version 5:
<a class="reference external" href="https://docs.oracle.com/javase/tutorial/java/annotations/">https://docs.oracle.com/javase/tutorial/java/annotations/</a></li>
<li>Java beans&nbsp;:
<a class="reference external" href="http://en.wikipedia.org/wiki/JavaBeans">http://en.wikipedia.org/wiki/JavaBeans</a></li>
</ul>
</div>
<div class="section" id="a-first-device">
<h1>A first device<a class="headerlink" href="#a-first-device" title="Permalink to this headline">¶</a></h1>
<p>Here is the code of a simple device class with one Tango command and one
attribute (see annexes for full code):</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="nd">@Device</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">TestDevice</span> <span class="o">{</span>

    <span class="kd">private</span> <span class="kd">final</span> <span class="n">Logger</span> <span class="n">logger</span> <span class="o">=</span> <span class="n">LoggerFactory</span><span class="o">.</span><span class="na">getLogger</span><span class="o">(</span><span class="n">TestDevice</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
    <span class="cm">/**</span>
<span class="cm">     * Attribute myAttribute READ WRITE, type DevDouble.</span>
<span class="cm">     */</span>
    <span class="nd">@Attribute</span>
    <span class="kd">public</span> <span class="kt">double</span> <span class="n">myAttribute</span><span class="o">;</span>

    <span class="cm">/**</span>
<span class="cm">     * Starts the server.</span>
<span class="cm">     */</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="kd">final</span> <span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">ServerManager</span><span class="o">.</span><span class="na">getInstance</span><span class="o">().</span><span class="na">start</span><span class="o">(</span><span class="n">args</span><span class="o">,</span> <span class="n">TestDevice</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="cm">/**</span>
<span class="cm">     * init device</span>
<span class="cm">     */</span>
    <span class="nd">@Init</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">init</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">logger</span><span class="o">.</span><span class="na">debug</span><span class="o">(</span><span class="s">&quot;init&quot;</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="cm">/**</span>
<span class="cm">     * delete device</span>
<span class="cm">     */</span>
    <span class="nd">@Delete</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">delete</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">logger</span><span class="o">.</span><span class="na">debug</span><span class="o">(</span><span class="s">&quot;delete&quot;</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="cm">/**</span>
<span class="cm">     * Execute command start. Type VOID-VOID</span>
<span class="cm">     */</span>
    <span class="nd">@Command</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">start</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">logger</span><span class="o">.</span><span class="na">debug</span><span class="o">(</span><span class="s">&quot;start&quot;</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="cm">/**</span>
<span class="cm">     * Read attribute myAttribute.</span>
<span class="cm">     *</span>
<span class="cm">     * @return</span>
<span class="cm">     */</span>
    <span class="kd">public</span> <span class="kt">double</span> <span class="nf">getMyAttribute</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">logger</span><span class="o">.</span><span class="na">debug</span><span class="o">(</span><span class="s">&quot;getMyAttribute {}&quot;</span><span class="o">,</span> <span class="n">myAttribute</span><span class="o">);</span>
        <span class="k">return</span> <span class="n">myAttribute</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="cm">/**</span>
<span class="cm">     * Write attribute myAttribute</span>
<span class="cm">     *</span>
<span class="cm">     * @param myAttribute</span>
<span class="cm">     */</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setMyAttribute</span><span class="o">(</span><span class="kd">final</span> <span class="kt">double</span> <span class="n">myAttribute</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">logger</span><span class="o">.</span><span class="na">debug</span><span class="o">(</span><span class="s">&quot;setMyAttribute {}&quot;</span><span class="o">,</span> <span class="n">myAttribute</span><span class="o">);</span>
        <span class="k">this</span><span class="o">.</span><span class="na">myAttribute</span> <span class="o">=</span> <span class="n">myAttribute</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
<p>Before starting this device, it has to be declared in the Tango database
with Jive menu “Create server”. Hereafter, a server “TestDevice/1” with
one device “tmp/test/device.1” is created:</p>
<p><a class="reference internal" href="../../../_images/image31.png"><img alt="image0" src="../../../_images/image31.png" style="width: 2.57847in; height: 1.98403in;" /></a><a class="reference internal" href="../../../_images/image41.png"><img alt="image1" src="../../../_images/image41.png" style="width: 3.13194in; height: 1.61389in;" /></a></p>
<p><a class="reference internal" href="../../../_images/image5.png"><img alt="image2" src="../../../_images/image5.png" style="width: 2.33735in; height: 0.75904in;" /></a></p>
<p>As the TestDevice class of this device has a main method, it can be
started as a standard Java program:</p>
<ol class="arabic simple">
<li>A Java system property “TANGO_HOST” must be defined. For instance
“tangodb:20001,tangodb:20002” , like in the Jive screenshot above.</li>
<li>The mandatory program argument is the instance name (1 in above
example).</li>
</ol>
<p>Once started, the device can be tested. Here is an example of the Tango
generic client ATKPanel:</p>
<p><a class="reference internal" href="../../../_images/image6.png"><img alt="image3" src="../../../_images/image6.png" style="width: 2.94805in; height: 3.00085in;" /></a></p>
<p>NB: In Tango, the commands <em>Init</em>, <em>State</em>, <em>Status</em> and the attributes
<em>State</em>, <em>Status</em> are created by default for any device.</p>
<p>Here is a first code explanation:</p>
<ul class="simple">
<li>The “&#64;Device” annotation on a class defines this class as a Tango
Device.</li>
<li>The “&#64;Attribute” annotation defines a field as a Tango attribute:<ul>
<li>The attribute type is defined by the field type;</li>
<li>If this field has a getter, it is a READ attribute;</li>
<li>If it has a setter, it is a WRITE attribute;</li>
<li>If it has both getter and setter, it is a READ/WRITE attribute.</li>
</ul>
</li>
<li>The annotation “&#64;Command” defines a method as a Tango command:<ul>
<li>The parameter type defines the input type</li>
<li>The return type defines the output type</li>
</ul>
</li>
<li>The “&#64;Init” annotation defines a method called:<ul>
<li>At server startup;</li>
<li>When “Init” command is called.</li>
</ul>
</li>
<li>The “&#64;Delete” annotation defines a method called:<ul>
<li>At server shutdown;</li>
<li>At “Init” command, just before “&#64;Init”.</li>
</ul>
</li>
<li>The main method starts the server</li>
<li>The logger field is to log.</li>
</ul>
<p>The following chapters will describes all this in details.</p>
</div>
<div class="section" id="device">
<h1>Device<a class="headerlink" href="#device" title="Permalink to this headline">¶</a></h1>
<p>A Tango device class must have the following Java annotation:</p>
<p>org.tango.server.annotation.Device</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="nd">@Device</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">TestDevice</span> <span class="o">{</span>

<span class="o">}</span>
</pre></div>
</div>
<p>This class can only have a no-arguments constructor.</p>
<p>This annotation has an option to configure how the server will manage
client transactions. Default value is “NONE”. Here is an example for one
client request at a time per device:</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="nd">@Device</span><span class="o">(</span><span class="n">transactionType</span> <span class="o">=</span> <span class="n">TransactionType</span><span class="o">.</span><span class="na">DEVICE</span><span class="o">)</span>
</pre></div>
</div>
<p>All transaction values are:</p>
<ul class="simple">
<li>TransactionType.<em>DEVICE</em>: One client request per device.</li>
<li>TransactionType.<em>CLASS</em>: One client request per device class (that
may contain several devices).</li>
<li>TransactionType.<em>SERVER</em>: One client request per server (that may
contain several classes).</li>
<li>TransactionType.<em>ATTRIBUTE</em>: One client request per attribute.</li>
<li>TransactionType.<em>COMMAND</em>: One client request per command.</li>
<li>TransactionType.<em>ATTRIBUTE_COMMAND</em>: One client request per
attribute or command.</li>
<li>TransactionType.<em>NONE</em>: Default value. All client requests can be
done at the same time.</li>
</ul>
<p>NB: A good choice has to be made between performance and thread-safety
of the device depending of the use-cases:</p>
<ul class="simple">
<li>Using TransactionType.NONE means that several clients can modify
values, states in the device at the same time. In this case, the
developer has to implement the thread-safety by himself if necessary.
A good use case for this configuration is a “stateless” device where
each request is an independent transaction that is unrelated to any
previous request.</li>
<li>Using TransactionType.DEVICE means that only one client can do a
request on the device at a time. So, if a lot of clients are
connected to the device, their performance can be drastically reduced
while waiting for other clients. The main use case for this
configuration is a “statefull” device that contains a conversation
state that is retained across transactions.</li>
</ul>
</div>
<div class="section" id="command">
<h1>Command<a class="headerlink" href="#command" title="Permalink to this headline">¶</a></h1>
<p>A tango command is created with this Java annotation on a method:</p>
<p>org.tango.server.annotation.Command</p>
<p>Example code of a command with a parameter of type DEVVARDOUBLEARRAY and
a returned type of DEVLONG:</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="nd">@Command</span>
<span class="kd">public</span> <span class="kt">int</span> <span class="nf">testCmd</span><span class="o">(</span><span class="kd">final</span> <span class="kt">double</span><span class="o">[]</span> <span class="n">in</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">return</span> <span class="mi">0</span><span class="o">;</span>
<span class="o">}</span>
</pre></div>
</div>
<p>The command name is by default the method name. The Command annotation
has some parameters to change its name, its description, its polling
configuration… See javadoc for details.</p>
<p>The method has to be public.</p>
<p>The input and output types are defined by the method definition. Here
are the Tango types for each Java type:</p>
<table border="1" class="docutils">
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Java type</th>
<th class="head">Tango type</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>void</td>
<td>DEVVOID</td>
</tr>
<tr class="row-odd"><td>boolean</td>
<td>DEVBOOLEAN</td>
</tr>
<tr class="row-even"><td>long</td>
<td>DEVLONG64</td>
</tr>
<tr class="row-odd"><td>long[]</td>
<td>DEVVARLONG64ARRAY</td>
</tr>
<tr class="row-even"><td>short</td>
<td>DEVSHORT</td>
</tr>
<tr class="row-odd"><td>short[]</td>
<td>DEVVARSHORTARRAY</td>
</tr>
<tr class="row-even"><td>float</td>
<td>DEVFLOAT</td>
</tr>
<tr class="row-odd"><td>float[]</td>
<td>DEVVARFLOATARRAY</td>
</tr>
<tr class="row-even"><td>double</td>
<td>DEVDOUBLE</td>
</tr>
<tr class="row-odd"><td>double[]</td>
<td>DEVVARDOUBLEARRAY</td>
</tr>
<tr class="row-even"><td>String</td>
<td>DEVSTRING</td>
</tr>
<tr class="row-odd"><td>String[]</td>
<td>DEVVARSTRINGARRAY</td>
</tr>
<tr class="row-even"><td>int</td>
<td>DEVLONG</td>
</tr>
<tr class="row-odd"><td>Int[]</td>
<td>DEVVARLONGARRAY</td>
</tr>
<tr class="row-even"><td>DevState or DeviceState</td>
<td>DEVSTATE</td>
</tr>
<tr class="row-odd"><td>byte</td>
<td>DEVUCHAR</td>
</tr>
<tr class="row-even"><td>byte[]</td>
<td>DEVVARCHARARRAY</td>
</tr>
<tr class="row-odd"><td>DevEncoded</td>
<td>DEVENCONDED</td>
</tr>
<tr class="row-even"><td>DevVarLongStringArray</td>
<td>DEVVARLONGSTRINGARRAY</td>
</tr>
<tr class="row-odd"><td>DevVarDoubleStringArray</td>
<td>DEVVARDOUBLESTRINGARRAY</td>
</tr>
</tbody>
</table>
<p>NB: Full class names of Tango commands:</p>
<p>fr.esrf.Tango.DevState</p>
<p>fr.esrf.Tango.DevEncoded</p>
<p>fr.esrf.Tango.DevVarLongStringArray</p>
<p>fr.esrf.Tango.DevVarDoubleStringArray</p>
<p>org.tango.DeviceState</p>
<p>Tango provides also other types that do not have equivalent in Java
types: DEVULONG, DEVULONG64, DEVUSHORT, DEVVARULONGARRAY,
DEVVARULONG64ARRAY, DEVVARUSHORTARRAY. It is possible to define these
types with a dynamic command (Cf chapter dynamic API for details).</p>
<p>NB: The wrappers objects of primitives (Integer, Double…) can also be
used, but it could lead to performance issues.</p>
</div>
<div class="section" id="attribute">
<h1>Attribute<a class="headerlink" href="#attribute" title="Permalink to this headline">¶</a></h1>
<p>A tango attribute is created with this Java annotation on a method or a
field:</p>
<p>org.tango.server.annotation.Attribute</p>
<p>Example code of a DEVDOUBLE scalar read and write attribute:</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="nd">@Attribute</span>
<span class="kd">private</span> <span class="kt">double</span> <span class="n">testAttribute</span><span class="o">;</span>

<span class="kd">public</span> <span class="kt">double</span> <span class="nf">getTestAttribute</span><span class="o">()</span> <span class="o">{</span>
    <span class="k">return</span> <span class="n">testAttribute</span><span class="o">;</span>
<span class="o">}</span>

<span class="kd">public</span> <span class="kt">void</span> <span class="nf">setTestAttribute</span><span class="o">(</span><span class="kt">double</span> <span class="n">testAttribute</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">this</span><span class="o">.</span><span class="na">testAttribute</span> <span class="o">=</span> <span class="n">testAttribute</span><span class="o">;</span>
<span class="o">}</span>
</pre></div>
</div>
<p>Example code for DEVENUM attribute:</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="kd">public</span> <span class="kd">enum</span> <span class="n">TestType</span> <span class="o">{</span>
    <span class="n">VALUE1</span><span class="o">,</span> <span class="n">VALUE2</span>
<span class="o">}</span>

<span class="nd">@Attribute</span>
<span class="kd">private</span> <span class="n">TestType</span> <span class="n">enumAttribute</span> <span class="o">=</span> <span class="n">TestType</span><span class="o">.</span><span class="na">VALUE1</span><span class="o">;</span>
<span class="kd">public</span> <span class="n">TestType</span> <span class="nf">getEnumAttribute</span><span class="o">()</span> <span class="o">{</span>
    <span class="k">return</span> <span class="n">enumAttribute</span><span class="o">;</span>
<span class="o">}</span>

<span class="kd">public</span> <span class="kt">void</span> <span class="nf">setEnumAttribute</span><span class="o">(</span><span class="kd">final</span> <span class="n">TestType</span> <span class="n">enumAttribute</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">this</span><span class="o">.</span><span class="na">enumAttribute</span> <span class="o">=</span> <span class="n">enumAttribute</span><span class="o">;</span>
<span class="o">}</span>
</pre></div>
</div>
<p>As defined by the Java bean convention, the setter and getter must
contain the name of the field and manage the same type as the field
(reminder: a getter for a boolean starts by “is”). The getter and setter
have to be public while the field is private.</p>
<ul class="simple">
<li>If this field has a getter, it is a READ attribute;</li>
<li>If it has a setter, it is a WRITE attribute;</li>
<li>If it has both, it is a READ/WRITE attribute.</li>
</ul>
<p>It is also possible to place the annotation on the getter method.</p>
<p>The attribute name is by default the field name. The annotation has some
parameters to change its name, its polling configuration, its
memorization configuration… See javadoc for details.</p>
<p>Here are the Tango types for each Java type:</p>
<table border="1" class="docutils">
<colgroup>
<col width="53%" />
<col width="23%" />
<col width="24%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Java type</th>
<th class="head">Tango type</th>
<th class="head">Tango format</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>Boolean</td>
<td>DEVBOOLEAN</td>
<td>SCALAR</td>
</tr>
<tr class="row-odd"><td>boolean[]</td>
<td>DEVBOOLEAN</td>
<td>SPECTRUM</td>
</tr>
<tr class="row-even"><td>boolean[][]</td>
<td>DEVBOOLEAN</td>
<td>IMAGE</td>
</tr>
<tr class="row-odd"><td>Long</td>
<td>DEVLONG64</td>
<td>SCALAR</td>
</tr>
<tr class="row-even"><td>long[]</td>
<td>DEVLONG64</td>
<td>SPECTRUM</td>
</tr>
<tr class="row-odd"><td>long[][]</td>
<td>DEVLONG64</td>
<td>IMAGE</td>
</tr>
<tr class="row-even"><td>Short</td>
<td>DEVSHORT</td>
<td>SCALAR</td>
</tr>
<tr class="row-odd"><td>short[]</td>
<td>DEVSHORT</td>
<td>SPECTRUM</td>
</tr>
<tr class="row-even"><td>short[][]</td>
<td>DEVSHORT</td>
<td>IMAGE</td>
</tr>
<tr class="row-odd"><td>Float</td>
<td>DEVFLOAT</td>
<td>SCALAR</td>
</tr>
<tr class="row-even"><td>float[]</td>
<td>DEVFLOAT</td>
<td>SPECTRUM</td>
</tr>
<tr class="row-odd"><td>float[][]</td>
<td>DEVFLOAT</td>
<td>IMAGE</td>
</tr>
<tr class="row-even"><td>Double</td>
<td>DEVDOUBLE</td>
<td>SCALAR</td>
</tr>
<tr class="row-odd"><td>double[]</td>
<td>DEVDOUBLE</td>
<td>SPECTRUM</td>
</tr>
<tr class="row-even"><td>double[][]</td>
<td>DEVDOUBLE</td>
<td>IMAGE</td>
</tr>
<tr class="row-odd"><td>String</td>
<td>DEVSTRING</td>
<td>SCALAR</td>
</tr>
<tr class="row-even"><td>String[]</td>
<td>DEVSTRING</td>
<td>SPECTRUM</td>
</tr>
<tr class="row-odd"><td>String[][]</td>
<td>DEVSTRING</td>
<td>IMAGE</td>
</tr>
<tr class="row-even"><td>Int</td>
<td>DEVLONG</td>
<td>SCALAR</td>
</tr>
<tr class="row-odd"><td>int[]</td>
<td>DEVLONG</td>
<td>SPECTRUM</td>
</tr>
<tr class="row-even"><td>int[][]</td>
<td>DEVLONG</td>
<td>IMAGE</td>
</tr>
<tr class="row-odd"><td>DevState or DeviceState</td>
<td>DEVSTATE</td>
<td>SCALAR</td>
</tr>
<tr class="row-even"><td>DevState[] or DeviceState[]</td>
<td>DEVSTATE</td>
<td>SPECTRUM</td>
</tr>
<tr class="row-odd"><td>DevState[][] or DeviceState[][]</td>
<td>DEVSTATE</td>
<td>IMAGE</td>
</tr>
<tr class="row-even"><td>Byte</td>
<td>DEVUCHAR</td>
<td>SCALAR</td>
</tr>
<tr class="row-odd"><td>byte[]</td>
<td>DEVUCHAR</td>
<td>SPECTRUM</td>
</tr>
<tr class="row-even"><td>byte[][]</td>
<td>DEVUCHAR</td>
<td>IMAGE</td>
</tr>
<tr class="row-odd"><td>DevEncoded</td>
<td>DEVENCONDED</td>
<td>SCALAR</td>
</tr>
<tr class="row-even"><td>Enum</td>
<td>DEVENUM</td>
<td>SCALAR</td>
</tr>
</tbody>
</table>
<p>NB: Full class names of tango attributes:</p>
<p><code class="docutils literal"><span class="pre">fr.esrf.Tango.DevState</span></code>
<code class="docutils literal"><span class="pre">fr.esrf.Tango.DevEncoded</span></code>
<code class="docutils literal"><span class="pre">fr.esrf.Tango.DevVarLongStringArray</span></code>
<code class="docutils literal"><span class="pre">fr.esrf.Tango.DevVarDoubleStringArray</span></code>
<code class="docutils literal"><span class="pre">org.tango.DeviceState</span></code></p>
<p>Tango provides also other types that do not have equivalent in Java
types: DEVULONG, DEVULONG64, and DEVUSHORT, DEVENUM (with enumerated
value configurable from its attribute property). It is possible to
define these types with a dynamic attribute (Cf chapter dynamic API for
details). Please also refer to this section if the write part of the
attribute has to be changed from the device.</p>
<p>NB: The wrappers objects of primitives (Integer, Double…) can also be
used, but it could lead to performance issues.</p>
<p>A Tango attribute has also a quality and a timestamp. The default
behavior is a valid quality, and the timestamp is the read time. To
access these properties, the getter method can return a container for
the attribute value, quality and timestamp. The container is:
<code class="docutils literal"><span class="pre">org.tango.server.attribute.AttributeValue</span></code>. It contains constructors and
methods to set the value, quality and timestamp. Please refer to its
javadoc for details.</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="nd">@Attribute</span>
<span class="kd">private</span> <span class="kt">double</span> <span class="n">myAttribute</span><span class="o">;</span>

<span class="kd">public</span> <span class="n">AttributeValue</span> <span class="nf">getMyAttribute</span><span class="o">()</span> <span class="kd">throws</span> <span class="n">DevFailed</span> <span class="o">{</span>
    <span class="n">AttributeValue</span> <span class="n">value</span> <span class="o">=</span> <span class="k">new</span> <span class="n">AttributeValue</span><span class="o">(</span><span class="n">myAttribute</span><span class="o">);</span>
    <span class="n">value</span><span class="o">.</span><span class="na">setQuality</span><span class="o">(</span><span class="n">AttrQuality</span><span class="o">.</span><span class="na">ATTR_CHANGING</span><span class="o">);</span>
    <span class="n">value</span><span class="o">.</span><span class="na">setTime</span><span class="o">(</span><span class="n">System</span><span class="o">.</span><span class="na">currentTimeMillis</span><span class="o">());</span>
    <span class="k">return</span> <span class="n">value</span><span class="o">;</span>
<span class="o">}</span>
</pre></div>
</div>
<p>The default attribute properties are configurable with this annotation:</p>
<p><code class="docutils literal"><span class="pre">org.tango.server.annotation.AttributeProperties</span></code></p>
<p>Please refer to javadoc for details. Example:</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="nd">@Attribute</span>
<span class="nd">@AttributeProperties</span><span class="o">(</span><span class="n">format</span> <span class="o">=</span> <span class="s">&quot;%6.4f&quot;</span><span class="o">,</span> <span class="n">description</span> <span class="o">=</span> <span class="s">&quot;a test attribute&quot;</span><span class="o">)</span>
<span class="kd">private</span> <span class="kt">double</span> <span class="n">testAttribute</span><span class="o">;</span>
</pre></div>
</div>
</div>
<div class="section" id="pipe">
<h1>Pipe<a class="headerlink" href="#pipe" title="Permalink to this headline">¶</a></h1>
<blockquote>
<div><p>A tango pipe is created with this Java annotation on a method or a
field:</p>
<p><code class="docutils literal"><span class="pre">org.tango.server.annotation.Pipe</span></code></p>
<p>Example code of a read pipe:</p>
</div></blockquote>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="nd">@Pipe</span>
<span class="kd">private</span> <span class="n">PipeValue</span> <span class="n">myPipeRO</span><span class="o">;</span>

<span class="c1">// ...</span>

<span class="kd">final</span> <span class="n">PipeBlob</span> <span class="n">myPipeBlob</span> <span class="o">=</span> <span class="k">new</span> <span class="n">PipeBlob</span><span class="o">(</span><span class="s">&quot;A&quot;</span><span class="o">);</span>
<span class="n">myPipeBlob</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="k">new</span> <span class="n">PipeDataElement</span><span class="o">(</span><span class="s">&quot;C&quot;</span><span class="o">,</span> <span class="s">&quot;B&quot;</span><span class="o">));</span>
<span class="n">myPipeRO</span> <span class="o">=</span> <span class="k">new</span> <span class="n">PipeValue</span><span class="o">(</span><span class="n">myPipeBlob</span><span class="o">);</span>

<span class="c1">// ...</span>

<span class="kd">public</span> <span class="n">PipeValue</span> <span class="nf">getMyPipeRO</span><span class="o">()</span> <span class="o">{</span><span class="k">return</span> <span class="n">myPipeRO</span><span class="o">;}</span>
</pre></div>
</div>
</div>
<div class="section" id="init">
<h1>Init<a class="headerlink" href="#init" title="Permalink to this headline">¶</a></h1>
<p><code class="docutils literal"><span class="pre">org.tango.server.annotation.Init</span></code></p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="nd">@Init</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">init</span><span class="o">()</span> <span class="o">{</span>
<span class="o">}</span>
</pre></div>
</div>
<p>This method must be public with no parameters. It is called:</p>
<ul class="simple">
<li>At server startup</li>
<li>And when “Init” command is called.</li>
</ul>
<p>If this method throws an exception, the device will automatically switch
to the “FAULT” state and the status will provide the stack trace.</p>
<p>This annotation has a boolean option called “lazyLoading”. Its default
value is false. If the init method takes a lot a time, its execution can
be detached with this option set to true. The device will automatically
switch in state “INIT” during its execution. This option avoids timeouts
when executing the “Init” command as well as a rapid device startup and
consequently a rapid control system startup.</p>
</div>
<div class="section" id="delete">
<h1>Delete<a class="headerlink" href="#delete" title="Permalink to this headline">¶</a></h1>
<p><code class="docutils literal"><span class="pre">org.tango.server.annotation.Delete</span></code></p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="nd">@Delete</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">delete</span><span class="o">()</span> <span class="o">{</span>
<span class="o">}</span>
</pre></div>
</div>
<p>Method must be public with no parameters. It is called:</p>
<ul class="simple">
<li>When “Init” command is called before &#64;Init method</li>
<li>At server shutdown.</li>
</ul>
<p>The delete method is generally used to close resources.</p>
</div>
<div class="section" id="state">
<h1>State<a class="headerlink" href="#state" title="Permalink to this headline">¶</a></h1>
<p><code class="docutils literal"><span class="pre">org.tango.server.annotation.State</span></code></p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="nd">@State</span>
<span class="kd">private</span> <span class="n">DeviceState</span> <span class="n">state</span><span class="o">;</span>

<span class="kd">public</span> <span class="n">DeviceState</span> <span class="nf">getState</span><span class="o">()</span> <span class="o">{</span>
    <span class="k">return</span> <span class="n">state</span><span class="o">;</span>
<span class="o">}</span>

<span class="kd">public</span> <span class="kt">void</span> <span class="nf">setState</span><span class="o">(</span><span class="kd">final</span> <span class="n">DeviceState</span> <span class="n">state</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">this</span><span class="o">.</span><span class="na">state</span> <span class="o">=</span> <span class="n">state</span><span class="o">;</span>
<span class="o">}</span>
</pre></div>
</div>
<p>The state annotation defines the state of the device, which will appear
in the default command and attribute “State”. The field can be
<code class="docutils literal"><span class="pre">fr.esrf.Tango.DevState</span></code> or <code class="docutils literal"><span class="pre">org.tango.DeviceState</span></code>:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">DevState</span></code> is the Tango standard type defined by the IDL.</li>
<li><code class="docutils literal"><span class="pre">DeviceState</span></code> is java <code class="docutils literal"><span class="pre">Enum</span></code> that provides easiness to manage a State.</li>
</ul>
<p>Getter and setter are mandatory.</p>
<p>The device property “StateCheckAttrAlarm” is defined for all Java
devices. If set to true, each times a client request the state or the
status of the device, all attributes are read to check if some
attributes are in ALARM or WARNING quality. If alarms are detected, the
state and the status will be updated consequently. The default value of
this property is false. WARNING: if some attributes requests are slow,
it could lead to performance issues.</p>
</div>
<div class="section" id="status">
<h1>Status<a class="headerlink" href="#status" title="Permalink to this headline">¶</a></h1>
<p><code class="docutils literal"><span class="pre">org.tango.server.annotation.Status</span></code></p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="nd">@Status</span>
<span class="kd">private</span> <span class="n">String</span> <span class="n">status</span><span class="o">;</span>

<span class="kd">public</span> <span class="n">String</span> <span class="nf">getStatus</span><span class="o">()</span> <span class="o">{</span>
    <span class="k">return</span> <span class="n">status</span><span class="o">;</span>
<span class="o">}</span>

<span class="kd">public</span> <span class="kt">void</span> <span class="nf">setStatus</span><span class="o">(</span><span class="n">String</span> <span class="n">status</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">this</span><span class="o">.</span><span class="na">status</span> <span class="o">=</span> <span class="n">status</span><span class="o">;</span>
<span class="o">}</span>
</pre></div>
</div>
<p>The status annotation defines the status of the device, which will
appear in the default command and attribute “Status”. The status field
must be a String, getter and setter are mandatory.</p>
</div>
<div class="section" id="device-property">
<h1>Device property<a class="headerlink" href="#device-property" title="Permalink to this headline">¶</a></h1>
<p><code class="docutils literal"><span class="pre">org.tango.server.annotation.DeviceProperty</span></code></p>
<p><em>NB: Tango reminder: loading order of a device property:</em></p>
<ul class="simple">
<li><em>Value defined at device level</em></li>
<li><em>If does not exists; value defined at class level</em></li>
<li><em>If does not exists; default value</em></li>
</ul>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="nd">@DeviceProperty</span> <span class="o">(</span><span class="n">defaultValue</span> <span class="o">=</span> <span class="s">&quot;&quot;</span><span class="o">,</span> <span class="n">description</span> <span class="o">=</span> <span class="s">&quot;an example&quot;</span><span class="o">)</span>
<span class="kd">private</span> <span class="n">String</span> <span class="n">devicePropTest</span><span class="o">;</span>

<span class="kd">public</span> <span class="kt">void</span> <span class="nf">setDevicePropTest</span><span class="o">(</span><span class="n">String</span> <span class="n">devicePropTest</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">this</span><span class="o">.</span><span class="na">devicePropTest</span> <span class="o">=</span> <span class="n">devicePropTest</span><span class="o">;</span>
<span class="o">}</span>
</pre></div>
</div>
<p>The field can be of any standard java type (int, double …), as scalar or
array.</p>
<p>The property has some parameters, details are in javadoc.</p>
<p>A setter is mandatory, so that the value can be injected at device
initialization.</p>
</div>
<div class="section" id="device-properties">
<h1>Device properties<a class="headerlink" href="#device-properties" title="Permalink to this headline">¶</a></h1>
<p><code class="docutils literal"><span class="pre">org.tango.server.annotation.DeviceProperties</span></code></p>
<p>It is possible to retrieve all device properties at once. It can be
useful if some device properties are not known in advance (Example: some
dynamic attributes that have their names as a device property name).</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="nd">@DeviceProperties</span>
<span class="kd">private</span> <span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">String</span><span class="o">[]&gt;</span> <span class="n">devicePropTest</span><span class="o">;</span>

<span class="kd">public</span> <span class="kt">void</span> <span class="nf">setDevicePropTest</span><span class="o">(</span><span class="kd">final</span> <span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">String</span><span class="o">[]&gt;</span> <span class="n">devicePropTest</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">this</span><span class="o">.</span><span class="na">devicePropTest</span> <span class="o">=</span> <span class="n">devicePropTest</span><span class="o">;</span>
<span class="o">}</span>
</pre></div>
</div>
<p>The field has to be a java.util.Map with a “String” key and a “String[]”
value.</p>
<p>A setter is mandatory, so that the value can be injected at device
initialization.</p>
</div>
<div class="section" id="class-property">
<h1>Class property<a class="headerlink" href="#class-property" title="Permalink to this headline">¶</a></h1>
<p><code class="docutils literal"><span class="pre">org.tango.server.annotation.ClassProperty</span></code></p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="nd">@ClassProperty</span>
<span class="kd">private</span> <span class="kt">double</span><span class="o">[]</span> <span class="n">classPropTest</span><span class="o">;</span>

<span class="kd">public</span> <span class="kt">void</span> <span class="nf">setClassPropTest</span><span class="o">(</span><span class="kt">double</span><span class="o">[]</span> <span class="n">classPropTest</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">this</span><span class="o">.</span><span class="na">classPropTest</span> <span class="o">=</span> <span class="n">classPropTest</span><span class="o">;</span>
<span class="o">}</span>
</pre></div>
</div>
<p>The field can be of any standard java type (int, double …), as scalar or
array.</p>
<p>The property has some parameters, details are in javadoc.</p>
<p>A setter is mandatory, so that the value can be injected at device
initialization.</p>
</div>
<div class="section" id="around-invoke">
<h1>Around Invoke<a class="headerlink" href="#around-invoke" title="Permalink to this headline">¶</a></h1>
<p><code class="docutils literal"><span class="pre">org.tango.server.annotation.AroundInvoke</span></code></p>
<p>It defines a public void method with a single parameter of class
org.tango.server.InvocationContext. It is called before and after every
command and attributes execution. This functionality is known as “always
executed hook” in C++.</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="nd">@AroundInvoke</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">aroundInvoke</span><span class="o">(</span><span class="kd">final</span> <span class="n">InvocationContext</span> <span class="n">ctxt</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;called at &quot;</span> <span class="o">+</span> <span class="n">ctxt</span><span class="o">.</span><span class="na">getContext</span><span class="o">());</span>
    <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;called command or attributes &quot;</span> <span class="o">+</span>
                        <span class="n">Arrays</span><span class="o">.</span><span class="na">toString</span><span class="o">(</span><span class="n">ctxt</span><span class="o">.</span><span class="na">getNames</span><span class="o">()));</span>
<span class="o">}</span>
</pre></div>
</div>
</div>
<div class="section" id="state-machine">
<h1>State machine<a class="headerlink" href="#state-machine" title="Permalink to this headline">¶</a></h1>
<p><code class="docutils literal"><span class="pre">org.tango.server.annotation.StateMachine</span></code></p>
<p>The StateMachine annotation allows to define some denied states, and
some state changes:</p>
<ul class="simple">
<li>For an “&#64;Init”, it is possible to define the state at the end of its
execution</li>
<li>For a command, its execution can be disallowed for some states and
the state at the end of its execution can be defined.</li>
<li>For an attribute, it can be disallowed to write it for some states
and the state at the end of its execution.</li>
</ul>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="nd">@Attribute</span>
<span class="nd">@StateMachine</span><span class="o">(</span><span class="n">endState</span> <span class="o">=</span> <span class="n">DeviceState</span><span class="o">.</span><span class="na">RUNNING</span><span class="o">)</span>
<span class="kd">private</span> <span class="kt">double</span> <span class="n">value</span><span class="o">;</span>

<span class="nd">@Init</span>
<span class="nd">@StateMachine</span><span class="o">(</span><span class="n">endState</span> <span class="o">=</span> <span class="n">DeviceState</span><span class="o">.</span><span class="na">OFF</span><span class="o">)</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">init</span><span class="o">()</span> <span class="o">{</span>
<span class="o">}</span>

<span class="nd">@Command</span>
<span class="nd">@StateMachine</span><span class="o">(</span><span class="n">deniedStates</span> <span class="o">=</span> <span class="o">{</span> <span class="n">DeviceState</span><span class="o">.</span><span class="na">FAULT</span><span class="o">,</span> <span class="n">DeviceState</span><span class="o">.</span><span class="na">UNKNOWN</span> <span class="o">},</span> <span class="n">endState</span> <span class="o">=</span> <span class="n">DeviceState</span><span class="o">.</span><span class="na">ON</span><span class="o">)</span>
<span class="kd">public</span> <span class="kt">int</span> <span class="nf">on</span><span class="o">()</span> <span class="o">{</span>
    <span class="k">return</span> <span class="mi">0</span><span class="o">;</span>
<span class="o">}</span>
</pre></div>
</div>
</div>
<div class="section" id="device-manager">
<h1>Device Manager<a class="headerlink" href="#device-manager" title="Permalink to this headline">¶</a></h1>
<p><code class="docutils literal"><span class="pre">org.tango.server.annotation.DeviceManagement</span></code></p>
<p>DeviceManager contains common utilities for a device. For example, it
provides its name, its admin device name, a way to change attribute
properties…</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="nd">@DeviceManagement</span>
<span class="kd">private</span> <span class="n">DeviceManager</span> <span class="n">deviceManager</span><span class="o">;</span>

<span class="nd">@Init</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">init</span><span class="o">()</span> <span class="o">{</span>
    <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">deviceManager</span><span class="o">.</span><span class="na">getName</span><span class="o">());</span>
<span class="o">}</span>

<span class="kd">public</span> <span class="kt">void</span> <span class="nf">setDeviceManager</span><span class="o">(</span><span class="kd">final</span> <span class="n">DeviceManager</span> <span class="n">deviceManager</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">this</span><span class="o">.</span><span class="na">deviceManager</span> <span class="o">=</span> <span class="n">deviceManager</span><span class="o">;</span>
<span class="o">}</span>
</pre></div>
</div>
</div>
<div class="section" id="dynamic-api">
<h1>Dynamic API<a class="headerlink" href="#dynamic-api" title="Permalink to this headline">¶</a></h1>
<p>Attributes and commands can be created dynamically with the class
org.tango.server.dynamic.DynamicManager that will be injected by using
the annotation org.tango.server.annotation.DynamicManagement. It
provides methods to add or remove attributes and commands. Typically,
the add methods will be called in the &#64;Init method and remove will be
called in &#64;Delete method:</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="nd">@DynamicManagement</span>
<span class="kd">private</span> <span class="n">DynamicManager</span> <span class="n">dynamicManagement</span><span class="o">;</span>

<span class="kd">public</span> <span class="kt">void</span> <span class="nf">setDynamicManagement</span><span class="o">(</span><span class="n">DynamicManager</span> <span class="n">dynamicManagement</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">this</span><span class="o">.</span><span class="na">dynamicManagement</span> <span class="o">=</span> <span class="n">dynamicManagement</span><span class="o">;</span>
<span class="o">}</span>

<span class="nd">@Init</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">init</span><span class="o">()</span> <span class="kd">throws</span> <span class="n">DevFailed</span> <span class="o">{</span>
    <span class="n">dynamicManager</span><span class="o">.</span><span class="na">addAttribute</span><span class="o">(</span><span class="k">new</span> <span class="n">TestDynamicAttribute</span><span class="o">());</span>
    <span class="n">dynamicManager</span><span class="o">.</span><span class="na">addCommand</span><span class="o">(</span><span class="k">new</span> <span class="n">TestDynamicCommand</span><span class="o">());</span>
<span class="o">}</span>

<span class="nd">@Delete</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">delete</span><span class="o">()</span> <span class="kd">throws</span> <span class="n">DevFailed</span> <span class="o">{</span>
    <span class="n">dynamicManager</span><span class="o">.</span><span class="na">clearAll</span><span class="o">();</span>
<span class="o">}</span>
</pre></div>
</div>
<p>NB: If a server is running with several devices in the same process, the
dynamic commands or attributes can be different for each device.</p>
<p>The following paragraphs explain in details how to create attribute and
commands.</p>
<div class="section" id="dynamic-command">
<h2>Dynamic Command<a class="headerlink" href="#dynamic-command" title="Permalink to this headline">¶</a></h2>
<p>A dynamic command is a class that must implement the interface:</p>
<p><code class="docutils literal"><span class="pre">org.tango.server.command.ICommandBehavior</span></code></p>
<p>See annexes for a full sample code.</p>
<div class="section" id="configuration">
<h3>Configuration<a class="headerlink" href="#configuration" title="Permalink to this headline">¶</a></h3>
<p>The method getConfiguration is used to define a command configuration
like its name, its type… see javadoc of
org.tango.server.command.CommandConfiguration for details). Here is an
example a command called testDynCmd with no parameter and a returned
value of type DEVDOUBLE:</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="kd">public</span> <span class="n">CommandConfiguration</span> <span class="nf">getConfiguration</span><span class="o">()</span> <span class="kd">throws</span> <span class="n">DevFailed</span> <span class="o">{</span>
    <span class="kd">final</span> <span class="n">CommandConfiguration</span> <span class="n">config</span> <span class="o">=</span> <span class="k">new</span> <span class="n">CommandConfiguration</span><span class="o">();</span>
    <span class="n">config</span><span class="o">.</span><span class="na">setName</span><span class="o">(</span><span class="s">&quot;testDynCmd&quot;</span><span class="o">);</span>
    <span class="n">config</span><span class="o">.</span><span class="na">setInType</span><span class="o">(</span><span class="kt">void</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
    <span class="n">config</span><span class="o">.</span><span class="na">setOutType</span><span class="o">(</span><span class="kt">double</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
    <span class="k">return</span> <span class="n">config</span><span class="o">;</span>
<span class="o">}</span>
</pre></div>
</div>
<p>The command types may be declared in two different ways:</p>
<ul>
<li><p class="first">setInType(Class&lt;?&gt; type) or setOutType: as table in chapter
“Command”, the java class defines the command type.</p>
</li>
<li><p class="first">setTangoInType(int tangoType)or setTangoOutType: defines the type
with an integer (constants are defined in class fr.esrf.TangoConst).
This method is more flexible as some Tango types do not have
equivalent in Java classes: DEVULONG, DEVULONG64, DEVUSHORT,
DEVVARULONGARRAY, DEVVARULONG64ARRAY, and DEVVARUSHORTARRAY.</p>
<ol class="lowerroman">
<li><p class="first rubric" id="statemachine">StateMachine</p>
</li>
</ol>
</li>
</ul>
<p>It is optional and can return “null”. It works like the StateMachine
annotation. See its chapter for details.</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="kd">public</span> <span class="n">StateMachineBehavior</span> <span class="nf">getStateMachine</span><span class="o">()</span> <span class="kd">throws</span> <span class="n">DevFailed</span> <span class="o">{</span>
    <span class="kd">final</span> <span class="n">StateMachineBehavior</span> <span class="n">stateMachine</span> <span class="o">=</span> <span class="k">new</span> <span class="n">StateMachineBehavior</span><span class="o">();</span>
    <span class="n">stateMachine</span><span class="o">.</span><span class="na">setDeniedStates</span><span class="o">(</span><span class="n">DeviceState</span><span class="o">.</span><span class="na">FAULT</span><span class="o">);</span>
    <span class="n">stateMachine</span><span class="o">.</span><span class="na">setEndState</span><span class="o">(</span><span class="n">DeviceState</span><span class="o">.</span><span class="na">ON</span><span class="o">);</span>
    <span class="k">return</span> <span class="n">stateMachine</span><span class="o">;</span>
<span class="o">}</span>
</pre></div>
</div>
</div>
<div class="section" id="execution">
<h3>Execution<a class="headerlink" href="#execution" title="Permalink to this headline">¶</a></h3>
<p>The input and output types of the execute method is defined by the
configuration above. If the type is void, the parameter or returned
value may be null.</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="kd">public</span> <span class="n">Object</span> <span class="nf">execute</span><span class="o">(</span><span class="kd">final</span> <span class="n">Object</span> <span class="n">arg</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">DevFailed</span> <span class="o">{</span>
    <span class="k">return</span> <span class="mf">10.0</span><span class="o">;</span>
<span class="o">}</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="dynamic-attribute">
<h2>Dynamic Attribute<a class="headerlink" href="#dynamic-attribute" title="Permalink to this headline">¶</a></h2>
<p>A dynamic attribute is a class that must implement:</p>
<p><code class="docutils literal"><span class="pre">org.tango.server.attribute.IAttributeBehavior</span></code></p>
<p>See annexes for a full sample code.</p>
<div class="section" id="id1">
<h3>Configuration<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<p>The method “getConfiguration” returns the full configuration of the
attribute (see javadoc of
org.tango.server.attribute.AttributeConfiguration for details). Here is
an example for a scalar, DevDouble, READ_WRITE attribute:</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="kd">public</span> <span class="n">AttributeConfiguration</span> <span class="nf">getConfiguration</span><span class="o">()</span> <span class="kd">throws</span> <span class="n">DevFailed</span> <span class="o">{</span>
    <span class="kd">final</span> <span class="n">AttributeConfiguration</span> <span class="n">config</span> <span class="o">=</span> <span class="k">new</span> <span class="n">AttributeConfiguration</span><span class="o">();</span>
    <span class="n">config</span><span class="o">.</span><span class="na">setName</span><span class="o">(</span><span class="s">&quot;testDynAttr&quot;</span><span class="o">);</span>
    <span class="c1">// attribute testDynAttr is a DevDouble</span>
    <span class="n">config</span><span class="o">.</span><span class="na">setType</span><span class="o">(</span><span class="kt">double</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
    <span class="c1">// attribute testDynAttr is READ_WRITE</span>
    <span class="n">config</span><span class="o">.</span><span class="na">setWritable</span><span class="o">(</span><span class="n">AttrWriteType</span><span class="o">.</span><span class="na">READ_WRITE</span><span class="o">);</span>
    <span class="k">return</span> <span class="n">config</span><span class="o">;</span>
<span class="o">}</span>
</pre></div>
</div>
<p>The attribute type and format may be declared in two different ways:</p>
<ul class="simple">
<li>setType(Class&lt;?&gt; type): as table in chapter “Attribute”, the java
class defines the attribute type and format.</li>
<li>setTangoType(int tangoType, AttrDataFormat format): defines the type
with an integer (constants are defined in class fr.esrf.TangoConst).
The format is defined by the class fr.esrf.AttrDataFormat. This
method is more flexible as some Tango types do not have equivalent in
Java classes: DEVULONG, DEVULONG64, DEVUSHORT, DEVENUM. Example of
DEVENUM:</li>
</ul>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="kd">final</span> <span class="n">AttributePropertiesImpl</span> <span class="n">props</span> <span class="o">=</span> <span class="k">new</span> <span class="n">AttributePropertiesImpl</span><span class="o">();</span>
<span class="n">props</span><span class="o">.</span><span class="na">setLabel</span><span class="o">(</span><span class="s">&quot;DevEnumDynamic&quot;</span><span class="o">);</span>
<span class="n">props</span><span class="o">.</span><span class="na">setEnumLabels</span><span class="o">(</span><span class="k">new</span> <span class="n">String</span><span class="o">[]</span> <span class="o">{</span> <span class="s">&quot;label1&quot;</span><span class="o">,</span> <span class="s">&quot;label2&quot;</span> <span class="o">});</span>
<span class="n">configAttr</span><span class="o">.</span><span class="na">setTangoType</span><span class="o">(</span><span class="n">TangoConst</span><span class="o">.</span><span class="na">Tango_DEV_ENUM</span><span class="o">,</span> <span class="n">AttrDataFormat</span><span class="o">.</span><span class="na">SCALAR</span><span class="o">);</span>
</pre></div>
</div>
</div>
<div class="section" id="id2">
<h3>StateMachine<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h3>
<p>Not mandatory, can return “null”. It works like the StateMachine
annotation. See its chapter for details.</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="kd">public</span> <span class="n">StateMachineBehavior</span> <span class="nf">getStateMachine</span><span class="o">()</span> <span class="kd">throws</span> <span class="n">DevFailed</span> <span class="o">{</span>
    <span class="kd">final</span> <span class="n">StateMachineBehavior</span> <span class="n">stateMachine</span> <span class="o">=</span> <span class="k">new</span> <span class="n">StateMachineBehavior</span><span class="o">();</span>
    <span class="n">stateMachine</span><span class="o">.</span><span class="na">setDeniedStates</span><span class="o">(</span><span class="n">DeviceState</span><span class="o">.</span><span class="na">FAULT</span><span class="o">);</span>
    <span class="n">stateMachine</span><span class="o">.</span><span class="na">setEndState</span><span class="o">(</span><span class="n">DeviceState</span><span class="o">.</span><span class="na">ON</span><span class="o">);</span>
    <span class="k">return</span> <span class="n">stateMachine</span><span class="o">;</span>
<span class="o">}</span>
</pre></div>
</div>
</div>
<div class="section" id="read-attribute">
<h3>Read attribute<a class="headerlink" href="#read-attribute" title="Permalink to this headline">¶</a></h3>
<p>The “getValue” method is used to read the attribute. It must return an
org.tango.server.attribute.AttributeValue (see javadoc for details). Of
course, the inserted value must be of the same type as the attribute
type (defined in “getConfiguration”).</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="kd">private</span> <span class="kt">double</span> <span class="n">readValue</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
<span class="kd">private</span> <span class="kt">double</span> <span class="n">writeValue</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>

<span class="kd">public</span> <span class="n">AttributeValue</span> <span class="nf">getValue</span><span class="o">()</span> <span class="kd">throws</span> <span class="n">DevFailed</span> <span class="o">{</span>
    <span class="n">readValue</span> <span class="o">=</span> <span class="n">readValue</span> <span class="o">+</span> <span class="n">writeValue</span><span class="o">;</span>
    <span class="k">return</span> <span class="k">new</span> <span class="n">AttributeValue</span><span class="o">(</span><span class="n">readValue</span><span class="o">);</span>
<span class="o">}</span>
</pre></div>
</div>
</div>
<div class="section" id="write-attribute">
<h3>Write attribute<a class="headerlink" href="#write-attribute" title="Permalink to this headline">¶</a></h3>
<p>The method “setValue” will be called only if the attribute has been
defined as writable in “getConfiguration”.</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="kd">public</span> <span class="kt">void</span> <span class="nf">setValue</span><span class="o">(</span><span class="kd">final</span> <span class="n">AttributeValue</span> <span class="n">value</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">DevFailed</span> <span class="o">{</span>
    <span class="n">writeValue</span> <span class="o">=</span> <span class="o">(</span><span class="n">Double</span><span class="o">)</span> <span class="n">value</span><span class="o">.</span><span class="na">getValue</span><span class="o">();</span>
<span class="o">}</span>
</pre></div>
</div>
</div>
<div class="section" id="update-write-part">
<h3>Update write part<a class="headerlink" href="#update-write-part" title="Permalink to this headline">¶</a></h3>
<p>In some specific cases, the write part has to be updated from the device
(i.e. the last set point of an equipment). This is possible by
implementing the interface org.tango.server.attribute.ISetValueUpdater
which has one method:</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="kd">public</span> <span class="n">AttributeValue</span> <span class="nf">getSetValue</span><span class="o">()</span> <span class="kd">throws</span> <span class="n">DevFailed</span> <span class="o">{</span>
    <span class="k">return</span> <span class="k">new</span> <span class="n">AttributeValue</span><span class="o">(</span><span class="n">writeValue</span><span class="o">);</span>
<span class="o">}</span>
</pre></div>
</div>
</div>
<div class="section" id="forwarded-attribute">
<h3>Forwarded Attribute<a class="headerlink" href="#forwarded-attribute" title="Permalink to this headline">¶</a></h3>
<p>To create a forwarded attribute, just use
<code class="docutils literal"><span class="pre">org.tango.server.attribute.ForwardedAttribute</span></code>:</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="nd">@DynamicManagement</span>
<span class="kd">private</span> <span class="n">DynamicManager</span> <span class="n">dynamicManagement</span><span class="o">;</span>

<span class="nd">@Init</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">init</span><span class="o">()</span> <span class="kd">throws</span> <span class="n">DevFailed</span> <span class="o">{</span>
    <span class="n">dynamicManager</span><span class="o">.</span><span class="na">addAttribute</span><span class="o">(</span><span class="k">new</span> <span class="n">ForwardedAttribute</span><span class="o">(</span><span class="n">fullRootAttributeName</span><span class="o">,</span> <span class="n">attributeName</span><span class="o">,</span> <span class="n">defaulltLabel</span><span class="o">);</span>
<span class="o">}</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="default-dynamic-attributes-and-commands">
<h1>Default dynamic attributes and commands<a class="headerlink" href="#default-dynamic-attributes-and-commands" title="Permalink to this headline">¶</a></h1>
<p>Some default dynamic attributes and commands are already in the library
JTangoServerLang, i.e.:</p>
<ul class="simple">
<li>Attribute and command proxies</li>
<li>Group command</li>
<li>Log attribute to send logs to an attribute</li>
</ul>
<p>Example: org.tango.server.dynamic.command.ProxyCommand will create a
Command that is connected to another command. The input and output types
will be calculated automatically.</p>
</div>
<div class="section" id="events">
<h1>Events<a class="headerlink" href="#events" title="Permalink to this headline">¶</a></h1>
<p>The detailed concepts of events are described in the Tango kernel
documentation. This section is just a reminder of the key concepts and
how to apply it in Java.</p>
<p>An event is send from a device’s attribute to the clients that have
subscribed to it. There are six different types of events:</p>
<ul class="simple">
<li><em>CHANGE_EVENT</em>: Sends an event according to the criteria defined in
the attribute properties “abs_change” and/or “rel_change”. Sends
also an event if the attribute‘s quality changes.</li>
<li><em>PERIODIC_EVENT</em>: Sends an event at the period specified by the
attribute property “event_period”</li>
<li><em>ARCHIVE_EVENT</em>: Archived event. Can either:<ul>
<li>Sends a periodic event at period configured in the property
“archive_period”.</li>
<li>Or/and change event with values from “archive_rel_change” and/or
“archive_abs_change”</li>
</ul>
</li>
<li><em>USER_EVENT</em>: The developer of the device can choose when to send
this event.</li>
<li><em>ATT_CONF_EVENT</em>: Attribute configuration event. Sends an event if
an attribute’s properties change.</li>
<li><em>DATA_READY_EVENT</em>: The developer of the device can choose when to
send the event. It is used to notify the client that some data is
ready.</li>
<li><em>INTERFACE_CHANGE:</em> Each time the lists of commands or attributes
change, an event is fire.</li>
</ul>
<p>There are two ways to send events from a server to clients:</p>
<ul>
<li><p class="first">Polled events: the cache mechanism will take care of sending events.</p>
</li>
<li><p class="first">Pushed events: the events will be sent directly for the device’s
code.</p>
<ol class="loweralpha">
<li><p class="first rubric" id="polled-events">Polled events</p>
</li>
</ol>
</li>
</ul>
<p>To send a polled event, the polling has to be configured. Only
<em>CHANGE_EVENT, PERIODIC_EVENT</em> and <em>ARCHIVE_EVENT</em> can be send by the
polling mechanism. Some default values can be set directly in the
device’s code. In the following example, the attribute ‘doubleAtt’ is
polled at a 100 milliseconds rate and will send a change event if its
value varies at least of 1 since the last time it was sent:</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="nd">@Attribute</span><span class="o">(</span><span class="n">isPolled</span> <span class="o">=</span> <span class="kc">true</span><span class="o">,</span> <span class="n">pollingPeriod</span> <span class="o">=</span> <span class="mi">100</span><span class="o">)</span>
<span class="nd">@AttributeProperties</span><span class="o">(</span><span class="n">changeEventAbsolute</span> <span class="o">=</span> <span class="s">&quot;1&quot;</span><span class="o">)</span>
<span class="kd">private</span> <span class="kt">double</span> <span class="n">doubleAtt</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
</pre></div>
</div>
<div class="section" id="pushed-events">
<h2>Pushed events<a class="headerlink" href="#pushed-events" title="Permalink to this headline">¶</a></h2>
<p>The event types that can be sent from the device’s code are
<em>CHANGE_EVENT, ARCHIVING_EVENT, DATA_READY_EVENT and USER_EVENT</em>.
For the <em>CHANGE</em> and <em>ARCHIVING</em> events types, it is possible to
activate the check of the attribute properties criteria before firing
it. In this case, it is done by the API before sending the event.</p>
<p>In the following example, a change event is pushed on the attribute
‘doubleAttr’. The API will check if the event must be send according to
the criteria ‘changeEventAbsolute’ and ‘changeEventRelative’:</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="nd">@DeviceManagement</span>
<span class="n">DeviceManager</span> <span class="n">deviceManager</span><span class="o">;</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">setDeviceManager</span><span class="o">(</span><span class="kd">final</span> <span class="n">DeviceManager</span> <span class="n">deviceManager</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">this</span><span class="o">.</span><span class="na">deviceManager</span> <span class="o">=</span> <span class="n">deviceManager</span><span class="o">;</span>
<span class="o">}</span>

<span class="nd">@Attribute</span><span class="o">(</span><span class="n">pushChangeEvent</span> <span class="o">=</span> <span class="kc">true</span><span class="o">,</span> <span class="n">checkChangeEvent</span> <span class="o">=</span> <span class="kc">true</span><span class="o">)</span>
<span class="nd">@AttributeProperties</span><span class="o">(</span><span class="n">changeEventAbsolute</span> <span class="o">=</span> <span class="s">&quot;1&quot;</span><span class="o">,</span> <span class="n">changeEventRelative</span> <span class="o">=</span> <span class="s">&quot;0.3&quot;</span><span class="o">)</span>
<span class="kd">private</span> <span class="kt">double</span> <span class="n">doubleAttr</span><span class="o">;</span>
<span class="c1">// ...</span>

<span class="n">doubleAttr</span><span class="o">++;</span>
<span class="n">deviceManager</span><span class="o">.</span><span class="na">pushEvent</span><span class="o">(</span><span class="s">&quot;doubleAttr&quot;</span><span class="o">,</span> <span class="k">new</span> <span class="n">AttributeValue</span><span class="o">(</span><span class="n">doubleAttr</span><span class="o">),</span> <span class="n">EventType</span><span class="o">.</span><span class="na">CHANGE_EVENT</span><span class="o">);</span>
<span class="c1">// ...</span>
</pre></div>
</div>
<p>Here is an example for pushing data ready events:</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="kd">private</span> <span class="kt">int</span> <span class="n">counter</span><span class="o">;</span>

<span class="nd">@Attribute</span><span class="o">(</span><span class="n">pushDataReady</span> <span class="o">=</span> <span class="kc">true</span><span class="o">)</span>
<span class="kd">private</span> <span class="kt">double</span> <span class="n">doubleAttr</span><span class="o">;</span>
    <span class="c1">// ...</span>

    <span class="n">counter</span><span class="o">++;</span>
    <span class="c1">// ...</span>

    <span class="n">deviceManager</span><span class="o">.</span><span class="na">pushDataReadyEvent</span><span class="o">(</span><span class="s">&quot;doubleAttr&quot;</span><span class="o">,</span> <span class="n">counter</span><span class="o">);</span>
    <span class="c1">// ...</span>
</pre></div>
</div>
<p>Here is an example that sends a user event:</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="nd">@Attribute</span>
<span class="kd">public</span> <span class="n">String</span> <span class="nf">getUserEvent</span><span class="o">()</span> <span class="kd">throws</span> <span class="n">DevFailed</span> <span class="o">{</span>
    <span class="k">return</span> <span class="s">&quot;Hello&quot;</span><span class="o">;</span>
<span class="o">}</span>

<span class="c1">// ...</span>
<span class="n">deviceManager</span><span class="o">.</span><span class="na">pushEvent</span><span class="o">(</span><span class="s">&quot;userEvent&quot;</span><span class="o">,</span><span class="k">new</span> <span class="n">AttributeValue</span><span class="o">(</span><span class="s">&quot;test&quot;</span><span class="o">),</span> <span class="n">EventType</span><span class="o">.</span><span class="na">USER_EVENT</span><span class="o">);</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="error-management">
<h1>Error management<a class="headerlink" href="#error-management" title="Permalink to this headline">¶</a></h1>
<p>The standard exception in Tango is fr.esrf.DevFailed. The class
org.tango.DevFailedUtils is useful to throw it. It will, for instance,
fill the origin field. See javadoc for details.</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="nd">@Command</span>
<span class="kd">public</span> <span class="kt">int</span> <span class="nf">off</span><span class="o">()</span> <span class="kd">throws</span> <span class="n">DevFailed</span> <span class="o">{</span>
    <span class="k">throw</span> <span class="n">DevFailedUtils</span><span class="o">.</span><span class="na">newDevFailed</span><span class="o">(</span><span class="s">&quot;DEVICE_ERROR&quot;</span><span class="o">,</span> <span class="s">&quot;an example error&quot;</span><span class="o">);</span>
<span class="o">}</span>
</pre></div>
</div>
</div>
<div class="section" id="logging">
<h1>Logging<a class="headerlink" href="#logging" title="Permalink to this headline">¶</a></h1>
<p>The Java Tango server API uses SLF4J
(<a class="reference external" href="http://www.slf4j.org/">*http://www.slf4j.org/*</a>). The underlying
libraries use also SLF4J (i.e. jacorb, ehcache…). Here is a declaration
example of a logger class:</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">org.slf4j.Logger</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.slf4j.LoggerFactory</span><span class="o">;</span>

<span class="c1">// ...</span>
<span class="kd">private</span> <span class="kd">final</span> <span class="n">Logger</span> <span class="n">logger</span> <span class="o">=</span> <span class="n">LoggerFactory</span><span class="o">.</span><span class="na">getLogger</span><span class="o">(</span><span class="n">TestDevice</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
</pre></div>
</div>
<p>For details about SLF4J, please refer to its documentation:
<a class="reference external" href="http://www.slf4j.org/docs.html">*http://www.slf4j.org/docs.html*</a></p>
<p>SLF4J is an abstraction layer for various logging frameworks (ie.
logback, log4j, java.util.logging…). It allows the end user to choose
the logging framework at deployment time. Nevertheless, the logging
configuration is framework dependent.</p>
<p>A configuration file allows configuring the logging output to be
directed to the console, files, e-mails… It also configures the logging
level. This file has to be in the class path of the device. See annexes
for an example of a logback configuration file and
<em>http://logback.qos.ch/</em> for details about configuration.</p>
<p>LIMITATION: JTangoServer depends directly on logback, because it has to
implement some particularities&nbsp;to configure it:</p>
<ul class="simple">
<li>Configuration of the logging level</li>
<li>Configuration of logging into file or into another device (for
logviewer application).</li>
</ul>
<p>So logback may be used to benefit from the above configuration topics
(accessible through the administration device).</p>
<ol class="arabic">
<li><p class="first rubric" id="start-up-dbno-db">Start up: DB/NO DB</p>
<ol class="loweralpha">
<li><p class="first rubric" id="server-with-tango-database">Server with Tango Database</p>
</li>
</ol>
</li>
</ol>
<p>A device class may contain a main method to start its server. It should
call “start” of org.tango.server.ServerManager.</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="kd">final</span> <span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">ServerManager</span><span class="o">.</span><span class="na">getInstance</span><span class="o">().</span><span class="na">start</span><span class="o">(</span><span class="n">args</span><span class="o">,</span> <span class="n">TestDevice</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
<span class="o">}</span>
</pre></div>
</div>
<p>When using the Tango database, the java system property or environment
variable TANGO_HOST must be defined to indicate the host and port of
the database. The string array passed in the start method must contain
at least the instance name as it has been previously defined in the
Tango database. The other options are:</p>
<ul class="simple">
<li>The “-h” option displays the list of instances declared in the tango
database for the given server.</li>
<li>The “–v x“ option allows to override the default logging level (also
called root level) of the logging configuration file where x is a
integer value (possible values are OFF=0, FATAL = 1, ERROR = 2, WARN
= 3, INFO = 4, DEBUG = 5, TRACE = 6)</li>
</ul>
<p>It is possible to have several classes in a single server. Here is an
example of a server started with two classes (org.tango.Motor and
org.tango.PowerSupply):</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="c1">// add class org.tango.Motor to the server (to be declared as “Motor” in the tango db)</span>
<span class="n">ServerManager</span><span class="o">.</span><span class="na">getInstance</span><span class="o">().</span><span class="na">addClass</span><span class="o">(</span><span class="n">org</span><span class="o">.</span><span class="na">tango</span><span class="o">.</span><span class="na">Motor</span><span class="o">.</span><span class="na">class</span><span class="o">.</span><span class="na">getSimpleName</span><span class="o">(),</span> <span class="n">org</span><span class="o">.</span><span class="na">tango</span><span class="o">.</span><span class="na">Motor</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
<span class="c1">// add class org.tango.PowerSupply to the server (to be declared as “PowerSupply” in the tango db)</span>
<span class="n">ServerManager</span><span class="o">.</span><span class="na">getInstance</span><span class="o">().</span><span class="na">addClass</span><span class="o">(</span><span class="n">org</span><span class="o">.</span><span class="na">tango</span><span class="o">.</span><span class="na">PowerSupply</span><span class="o">.</span><span class="na">class</span><span class="o">.</span><span class="na">getSimpleName</span><span class="o">(),</span><span class="n">org</span><span class="o">.</span><span class="na">tango</span><span class="o">.</span> <span class="n">PowerSupply</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
<span class="c1">// start the server “Insertion/test”</span>
<span class="n">ServerManager</span><span class="o">.</span><span class="na">getInstance</span><span class="o">().</span><span class="na">start</span><span class="o">(</span><span class="k">new</span> <span class="n">String</span><span class="o">[]</span> <span class="o">{</span><span class="s">&quot;test&quot;</span><span class="o">},</span> <span class="s">&quot;Insertion&quot;</span><span class="o">);</span>
</pre></div>
</div>
<p>The following screenshot shows an example declaration of the server
“Insertion/test” in the tango db; it contains 4 devices, 2 of class
Motor and 2 of class PowerSupply:</p>
<p><a class="reference internal" href="../../../_images/image7.png"><img alt="image4" src="../../../_images/image7.png" style="width: 2.77108in; height: 1.58082in;" /></a></p>
<div class="section" id="device-without-tango-database">
<h2>Device without Tango database<a class="headerlink" href="#device-without-tango-database" title="Permalink to this headline">¶</a></h2>
<p>A device may also be started without a Tango database, for example to
perform unit tests. The system property OAPort (used by JacORB) must
specify the port on which the server is started. The following code
starts a device “1/1/1” on the port 12354 (NB: a client will connect to
it with an address like “tango://localhost:12354/1/1/1#dbase=no”)</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="n">String</span> <span class="n">NO_DB_DEVICE_NAME</span> <span class="o">=</span> <span class="s">&quot;1/1/1&quot;</span><span class="o">;</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="n">String</span> <span class="n">NO_DB_GIOP_PORT</span> <span class="o">=</span> <span class="s">&quot;12354&quot;</span><span class="o">;</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="n">String</span> <span class="n">NO_DB_INSTANCE_NAME</span> <span class="o">=</span> <span class="s">&quot;1&quot;</span><span class="o">;</span>

<span class="c1">// ...</span>
<span class="n">System</span><span class="o">.</span><span class="na">setProperty</span><span class="o">(</span><span class="s">&quot;OAPort&quot;</span><span class="o">,</span> <span class="n">NO_DB_GIOP_PORT</span><span class="o">);</span>
<span class="n">ServerManager</span><span class="o">.</span><span class="na">getInstance</span><span class="o">().</span><span class="na">start</span><span class="o">(</span><span class="k">new</span> <span class="n">String</span><span class="o">[]</span> <span class="o">{</span> <span class="n">NO_DB_INSTANCE_NAME</span><span class="o">,</span> <span class="s">&quot;-nodb&quot;</span><span class="o">,</span> <span class="s">&quot;-dlist&quot;</span><span class="o">,</span> <span class="n">NO_DB_DEVICE_NAME</span> <span class="o">},</span>
            <span class="n">TestDevice</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
</pre></div>
</div>
<p>The start options are for a no db server:</p>
<ul class="simple">
<li>-nodb to indicate a server without database</li>
<li>-dlist the list of devices in the server</li>
<li>-file= the properties file. As the device and class properties are
normally defined in the Tango DB, a file can be specified to replace
it. (Refer to annexes for an example). If the device started without
database is also defined in tango db, it is possible to generate its
file with Jive. The “Save server data” menu is accessible by
right-clicking on the instance name:</li>
</ul>
<p><a class="reference internal" href="../../../_images/image8.png"><img alt="image5" src="../../../_images/image8.png" style="width: 1.91667in; height: 1.54306in;" /></a></p>
<p>Example:</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="n">System</span><span class="o">.</span><span class="na">setProperty</span><span class="o">(</span><span class="s">&quot;OAPort&quot;</span><span class="o">,</span> <span class="n">NO_DB_GIOP_PORT</span><span class="o">);</span>
<span class="n">ServerManager</span><span class="o">.</span><span class="na">getInstance</span><span class="o">().</span><span class="na">start</span><span class="o">(</span>
            <span class="k">new</span> <span class="n">String</span><span class="o">[]</span> <span class="o">{</span> <span class="n">NO_DB_INSTANCE_NAME</span><span class="o">,</span> <span class="s">&quot;-nodb&quot;</span><span class="o">,</span> <span class="s">&quot;-dlist&quot;</span><span class="o">,</span> <span class="n">NO_DB_DEVICE_NAME</span><span class="o">,</span>
                    <span class="s">&quot;-file=&quot;</span> <span class="o">+</span> <span class="n">TestDevice</span><span class="o">.</span><span class="na">class</span><span class="o">.</span><span class="na">getResource</span><span class="o">(</span><span class="s">&quot;/noDbproperties.txt&quot;</span><span class="o">).</span><span class="na">getPath</span><span class="o">()</span> <span class="o">},</span> <span class="n">TestDevice</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
</pre></div>
</div>
<ol class="arabic">
<li><p class="first rubric" id="annexes">Annexes</p>
<ol class="loweralpha">
<li><p class="first rubric" id="full-sample-device-code">Full sample device code</p>
</li>
</ol>
</li>
</ol>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="kn">package</span> <span class="nn">org.tango.test</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.slf4j.Logger</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.slf4j.LoggerFactory</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.tango.server.ServerManager</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.tango.server.annotation.Attribute</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.tango.server.annotation.Command</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.tango.server.annotation.Delete</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.tango.server.annotation.Device</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.tango.server.annotation.Init</span><span class="o">;</span>

<span class="nd">@Device</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">TestDevice</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="n">Logger</span> <span class="n">logger</span> <span class="o">=</span> <span class="n">LoggerFactory</span><span class="o">.</span><span class="na">getLogger</span><span class="o">(</span><span class="n">TestDevice</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>

    <span class="cm">/**</span>
<span class="cm">    * Attribute myAttribute READ WRITE, type DevDouble.</span>
<span class="cm">    */</span>
    <span class="nd">@Attribute</span>
    <span class="kd">public</span> <span class="kt">double</span> <span class="n">myAttribute</span><span class="o">;</span>

    <span class="cm">/**</span>
<span class="cm">    * Starts the server.</span>
<span class="cm">    */</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="kd">final</span> <span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">ServerManager</span><span class="o">.</span><span class="na">getInstance</span><span class="o">().</span><span class="na">start</span><span class="o">(</span><span class="n">args</span><span class="o">,</span> <span class="n">TestDevice</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="cm">/**</span>
<span class="cm">    * init device</span>
<span class="cm">    */</span>
    <span class="nd">@Init</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">init</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">logger</span><span class="o">.</span><span class="na">debug</span><span class="o">(</span><span class="s">&quot;init&quot;</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="cm">/**</span>
<span class="cm">    * delete device</span>
<span class="cm">    */</span>
    <span class="nd">@Delete</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">delete</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">logger</span><span class="o">.</span><span class="na">debug</span><span class="o">(</span><span class="s">&quot;delete&quot;</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="cm">/**</span>
<span class="cm">    * Execute command start. Type VOID-VOID</span>
<span class="cm">    */</span>
    <span class="nd">@Command</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">start</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">logger</span><span class="o">.</span><span class="na">debug</span><span class="o">(</span><span class="s">&quot;start&quot;</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="cm">/**</span>
<span class="cm">    * Read attribute myAttribute.</span>
<span class="cm">    *</span>
<span class="cm">    * @return</span>
<span class="cm">    */</span>
    <span class="kd">public</span> <span class="kt">double</span> <span class="nf">getMyAttribute</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">logger</span><span class="o">.</span><span class="na">debug</span><span class="o">(</span><span class="s">&quot;getMyAttribute {}&quot;</span><span class="o">,</span> <span class="n">myAttribute</span><span class="o">);</span>
        <span class="k">return</span> <span class="n">myAttribute</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="cm">/**</span>
<span class="cm">    * Write attribute myAttribute</span>
<span class="cm">    *</span>
<span class="cm">    * @param myAttribute</span>
<span class="cm">    */</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setMyAttribute</span><span class="o">(</span><span class="kd">final</span> <span class="kt">double</span> <span class="n">myAttribute</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">logger</span><span class="o">.</span><span class="na">debug</span><span class="o">(</span><span class="s">&quot;setMyAttribute {}&quot;</span><span class="o">,</span> <span class="n">myAttribute</span><span class="o">);</span>
        <span class="k">this</span><span class="o">.</span><span class="na">myAttribute</span> <span class="o">=</span> <span class="n">myAttribute</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
</div>
<div class="section" id="command-with-icommandbehavior">
<h2>Command with ICommandBehavior<a class="headerlink" href="#command-with-icommandbehavior" title="Permalink to this headline">¶</a></h2>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="kn">package</span> <span class="nn">org.tango.test</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.tango.server.StateMachineBehavior</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.tango.server.command.CommandConfiguration</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.tango.server.command.ICommandBehavior</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">fr.esrf.Tango.DevFailed</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">TestDynamicCommand</span> <span class="kd">implements</span> <span class="n">ICommandBehavior</span>
<span class="o">{</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="n">CommandConfiguration</span> <span class="nf">getConfiguration</span><span class="o">()</span> <span class="kd">throws</span> <span class="n">DevFailed</span>
    <span class="o">{</span>
        <span class="kd">final</span> <span class="n">CommandConfiguration</span> <span class="n">config</span> <span class="o">=</span> <span class="k">new</span> <span class="n">CommandConfiguration</span><span class="o">();</span>
        <span class="n">config</span><span class="o">.</span><span class="na">setName</span><span class="o">(</span><span class="s">&quot;testDynCmd&quot;</span><span class="o">);</span>
        <span class="n">config</span><span class="o">.</span><span class="na">setInType</span><span class="o">(</span><span class="kt">void</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
        <span class="n">config</span><span class="o">.</span><span class="na">setOutType</span><span class="o">(</span><span class="kt">double</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
        <span class="k">return</span> <span class="n">config</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="n">Object</span> <span class="nf">execute</span><span class="o">(</span><span class="kd">final</span> <span class="n">Object</span> <span class="n">arg</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">DevFailed</span> <span class="o">{</span>
        <span class="k">return</span> <span class="mf">10.0</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="n">StateMachineBehavior</span> <span class="nf">getStateMachine</span><span class="o">()</span> <span class="kd">throws</span> <span class="n">DevFailed</span> <span class="o">{</span>
        <span class="k">return</span> <span class="kc">null</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
</div>
<div class="section" id="attribute-with-iattributebehavior">
<h2>Attribute with IAttributeBehavior<a class="headerlink" href="#attribute-with-iattributebehavior" title="Permalink to this headline">¶</a></h2>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="kn">package</span> <span class="nn">org.tango.test</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.tango.server.StateMachineBehavior</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.tango.server.attribute.AttributeConfiguration</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.tango.server.attribute.AttributeValue</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.tango.server.attribute.IAttributeBehavior</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">fr.esrf.Tango.AttrWriteType</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">fr.esrf.Tango.DevFailed</span><span class="o">;</span>

<span class="cm">/**</span>
<span class="cm">* A sample attribute</span>
<span class="cm">*</span>
<span class="cm">*/</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">TestDynamicAttribute</span> <span class="kd">implements</span> <span class="n">IAttributeBehavior</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kt">double</span> <span class="n">readValue</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kt">double</span> <span class="n">writeValue</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>

    <span class="cm">/**</span>
<span class="cm">    * Configure the attribute</span>
<span class="cm">    */</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="n">AttributeConfiguration</span> <span class="nf">getConfiguration</span><span class="o">()</span> <span class="kd">throws</span> <span class="n">DevFailed</span> <span class="o">{</span>
        <span class="kd">final</span> <span class="n">AttributeConfiguration</span> <span class="n">config</span> <span class="o">=</span> <span class="k">new</span> <span class="n">AttributeConfiguration</span><span class="o">();</span>
        <span class="n">config</span><span class="o">.</span><span class="na">setName</span><span class="o">(</span><span class="s">&quot;testDynAttr&quot;</span><span class="o">);</span>
        <span class="c1">// attribute testDynAttr is a DevDouble</span>
        <span class="n">config</span><span class="o">.</span><span class="na">setType</span><span class="o">(</span><span class="kt">double</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
        <span class="c1">// attribute testDynAttr is READ_WRITE</span>
        <span class="n">config</span><span class="o">.</span><span class="na">setWritable</span><span class="o">(</span><span class="n">AttrWriteType</span><span class="o">.</span><span class="na">READ_WRITE</span><span class="o">);</span>
        <span class="k">return</span> <span class="n">config</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="cm">/**</span>
<span class="cm">    * Read the attribute</span>
<span class="cm">    */</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="n">AttributeValue</span> <span class="nf">getValue</span><span class="o">()</span> <span class="kd">throws</span> <span class="n">DevFailed</span> <span class="o">{</span>
        <span class="n">readValue</span> <span class="o">=</span> <span class="n">readValue</span> <span class="o">+</span> <span class="n">writeValue</span><span class="o">;</span>
        <span class="k">return</span> <span class="k">new</span> <span class="n">AttributeValue</span><span class="o">(</span><span class="n">readValue</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="cm">/**</span>
<span class="cm">    * Write the attribute</span>
<span class="cm">    */</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setValue</span><span class="o">(</span><span class="kd">final</span> <span class="n">AttributeValue</span> <span class="n">value</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">DevFailed</span> <span class="o">{</span>
        <span class="n">writeValue</span> <span class="o">=</span> <span class="o">(</span><span class="n">Double</span><span class="o">)</span> <span class="n">value</span><span class="o">.</span><span class="na">getValue</span><span class="o">();</span>
    <span class="o">}</span>

    <span class="cm">/**</span>
<span class="cm">    * Configure state machine if needed</span>
<span class="cm">    */</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="n">StateMachineBehavior</span> <span class="nf">getStateMachine</span><span class="o">()</span> <span class="kd">throws</span> <span class="n">DevFailed</span> <span class="o">{</span>
        <span class="kd">final</span> <span class="n">StateMachineBehavior</span> <span class="n">stateMachine</span> <span class="o">=</span> <span class="k">new</span> <span class="n">StateMachineBehavior</span><span class="o">();</span>
        <span class="n">stateMachine</span><span class="o">.</span><span class="na">setDeniedStates</span><span class="o">(</span><span class="n">DeviceState</span><span class="o">.</span><span class="na">FAULT</span><span class="o">);</span>
        <span class="n">stateMachine</span><span class="o">.</span><span class="na">setEndState</span><span class="o">(</span><span class="n">DeviceState</span><span class="o">.</span><span class="na">ON</span><span class="o">);</span>
        <span class="k">return</span> <span class="n">stateMachine</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="n">AttributeValue</span> <span class="nf">getSetValue</span><span class="o">()</span> <span class="kd">throws</span> <span class="n">DevFailed</span> <span class="o">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="n">AttributeValue</span><span class="o">(</span><span class="n">writeValue</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
</div>
<div class="section" id="extended-example">
<h2>Extended example<a class="headerlink" href="#extended-example" title="Permalink to this headline">¶</a></h2>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="kn">package</span> <span class="nn">org.tango.test</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.util.Map</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.slf4j.Logger</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.slf4j.LoggerFactory</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.tango.DeviceState</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.tango.server.ServerManager</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.tango.server.annotation.Attribute</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.tango.server.annotation.ClassProperty</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.tango.server.annotation.Command</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.tango.server.annotation.Delete</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.tango.server.annotation.Device</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.tango.server.annotation.DeviceProperties</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.tango.server.annotation.DeviceProperty</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.tango.server.annotation.DynamicManagement</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.tango.server.annotation.Init</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.tango.server.annotation.State</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.tango.server.annotation.StateMachine</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.tango.server.dynamic.DynamicManager</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.tango.server.testserver.JTangoTest</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">fr.esrf.Tango.DevFailed</span><span class="o">;</span>

<span class="nd">@Device</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">TestDevice</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="n">Logger</span> <span class="n">logger</span> <span class="o">=</span> <span class="n">LoggerFactory</span><span class="o">.</span><span class="na">getLogger</span><span class="o">(</span><span class="n">TestDevice</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>

    <span class="cm">/**</span>
<span class="cm">    * A device property</span>
<span class="cm">    */</span>
    <span class="nd">@DeviceProperty</span><span class="o">(</span><span class="n">defaultValue</span> <span class="o">=</span> <span class="s">&quot;&quot;</span><span class="o">,</span> <span class="n">description</span> <span class="o">=</span> <span class="s">&quot;an example device property&quot;</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">myProp</span><span class="o">;</span>

    <span class="nd">@ClassProperty</span><span class="o">(</span><span class="n">defaultValue</span> <span class="o">=</span> <span class="s">&quot;0&quot;</span><span class="o">,</span> <span class="n">description</span> <span class="o">=</span> <span class="s">&quot;an example class property&quot;</span><span class="o">)</span>
    <span class="kd">private</span> <span class="kt">int</span> <span class="n">myClassProp</span><span class="o">;</span>

    <span class="nd">@DeviceProperties</span>
    <span class="kd">private</span> <span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">String</span><span class="o">[]&gt;</span> <span class="n">deviceProperties</span><span class="o">;</span>

    <span class="cm">/**</span>
<span class="cm">    * Attribute myAttribute READ WRITE, type DevDouble.</span>
<span class="cm">    */</span>

    <span class="nd">@Attribute</span>
    <span class="kd">public</span> <span class="kt">double</span> <span class="n">myAttribute</span><span class="o">;</span>

    <span class="cm">/**</span>
<span class="cm">    * Manage dynamic attributes and commands</span>
<span class="cm">    */</span>

    <span class="nd">@DynamicManagement</span>
    <span class="kd">public</span> <span class="n">DynamicManager</span> <span class="n">dynamicManager</span><span class="o">;</span>

    <span class="cm">/**</span>
<span class="cm">    * Manage state of the device</span>
<span class="cm">    */</span>

    <span class="nd">@State</span>
    <span class="kd">private</span> <span class="n">DeviceState</span> <span class="n">state</span> <span class="o">=</span> <span class="n">DeviceState</span><span class="o">.</span><span class="na">OFF</span><span class="o">;</span>

    <span class="cm">/**</span>
<span class="cm">    * Starts the server.</span>
<span class="cm">    */</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="kd">final</span> <span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">ServerManager</span><span class="o">.</span><span class="na">getInstance</span><span class="o">().</span><span class="na">start</span><span class="o">(</span><span class="n">args</span><span class="o">,</span> <span class="n">TestDevice</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="n">String</span> <span class="n">NO_DB_DEVICE_NAME</span> <span class="o">=</span> <span class="s">&quot;1/1/1&quot;</span><span class="o">;</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="n">String</span> <span class="n">NO_DB_GIOP_PORT</span> <span class="o">=</span> <span class="s">&quot;12354&quot;</span><span class="o">;</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="n">String</span> <span class="n">NO_DB_INSTANCE_NAME</span> <span class="o">=</span> <span class="s">&quot;1&quot;</span><span class="o">;</span>

    <span class="cm">/**</span>
<span class="cm">    * Starts the server in nodb mode.</span>
<span class="cm">    *</span>
<span class="cm">    * @throws DevFailed</span>
<span class="cm">    */</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">startNoDb</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">System</span><span class="o">.</span><span class="na">setProperty</span><span class="o">(</span><span class="s">&quot;OAPort&quot;</span><span class="o">,</span> <span class="n">NO_DB_GIOP_PORT</span><span class="o">);</span>
        <span class="n">ServerManager</span><span class="o">.</span><span class="na">getInstance</span><span class="o">().</span><span class="na">start</span><span class="o">(</span><span class="k">new</span> <span class="n">String</span><span class="o">[]</span> <span class="o">{</span>
            <span class="n">NO_DB_INSTANCE_NAME</span><span class="o">,</span> <span class="s">&quot;-nodb&quot;</span><span class="o">,</span> <span class="s">&quot;-dlist&quot;</span><span class="o">,</span> <span class="n">NO_DB_DEVICE_NAME</span> <span class="o">},</span>
            <span class="n">TestDevice</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="cm">/**</span>
<span class="cm">    * Starts the server in nodb mode with a file for device and class  properties</span>
<span class="cm">    *</span>
<span class="cm">    * @throws DevFailed</span>
<span class="cm">    */</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">startNoDbFile</span><span class="o">()</span> <span class="kd">throws</span> <span class="n">DevFailed</span> <span class="o">{</span>
        <span class="n">System</span><span class="o">.</span><span class="na">setProperty</span><span class="o">(</span><span class="s">&quot;OAPort&quot;</span><span class="o">,</span> <span class="n">NO_DB_GIOP_PORT</span><span class="o">);</span>
        <span class="n">ServerManager</span><span class="o">.</span><span class="na">getInstance</span><span class="o">().</span><span class="na">start</span><span class="o">(</span> <span class="k">new</span> <span class="n">String</span><span class="o">[]</span> <span class="o">{</span> <span class="n">NO_DB_INSTANCE_NAME</span><span class="o">,</span> <span class="s">&quot;-nodb&quot;</span><span class="o">,</span> <span class="s">&quot;-dlist&quot;</span><span class="o">,</span>
            <span class="n">NO_DB_DEVICE_NAME</span><span class="o">,</span>
            <span class="s">&quot;-file=&quot;</span> <span class="o">+</span> <span class="n">JTangoTest</span><span class="o">.</span><span class="na">class</span><span class="o">.</span><span class="na">getResource</span><span class="o">(</span><span class="s">&quot;/noDbproperties.txt&quot;</span><span class="o">).</span><span class="na">getPath</span><span class="o">()</span> <span class="o">},</span>
            <span class="n">TestDevice</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="cm">/**</span>
<span class="cm">    * init device</span>
<span class="cm">    *</span>
<span class="cm">    * @throws DevFailed</span>
<span class="cm">    */</span>
    <span class="nd">@Init</span>
    <span class="nd">@StateMachine</span><span class="o">(</span><span class="n">endState</span> <span class="o">=</span> <span class="n">DeviceState</span><span class="o">.</span><span class="na">ON</span><span class="o">)</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">init</span><span class="o">()</span> <span class="kd">throws</span> <span class="n">DevFailed</span> <span class="o">{</span>
        <span class="n">logger</span><span class="o">.</span><span class="na">debug</span><span class="o">(</span><span class="s">&quot;myProp value = {}&quot;</span><span class="o">,</span> <span class="n">myProp</span><span class="o">);</span>
        <span class="n">logger</span><span class="o">.</span><span class="na">debug</span><span class="o">(</span><span class="s">&quot;myClassProp value = {}&quot;</span><span class="o">,</span> <span class="n">myClassProp</span><span class="o">);</span>
        <span class="n">logger</span><span class="o">.</span><span class="na">debug</span><span class="o">(</span><span class="s">&quot;deviceProperties value = {}&quot;</span><span class="o">,</span> <span class="n">deviceProperties</span><span class="o">);</span>
        <span class="c1">// create a new dynamic attribute</span>
        <span class="n">dynamicManager</span><span class="o">.</span><span class="na">addAttribute</span><span class="o">(</span><span class="k">new</span> <span class="n">TestDynamicAttribute</span><span class="o">());</span>
        <span class="c1">// create a new dynamic command</span>
        <span class="n">dynamicManager</span><span class="o">.</span><span class="na">addCommand</span><span class="o">(</span><span class="k">new</span> <span class="n">TestDynamicCommand</span><span class="o">());</span>
        <span class="n">logger</span><span class="o">.</span><span class="na">debug</span><span class="o">(</span><span class="s">&quot;init done&quot;</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="cm">/**</span>
<span class="cm">    * delete device</span>
<span class="cm">    *</span>
<span class="cm">    * @throws DevFailed</span>
<span class="cm">    */</span>
    <span class="nd">@Delete</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">delete</span><span class="o">()</span> <span class="kd">throws</span> <span class="n">DevFailed</span> <span class="o">{</span>
        <span class="n">logger</span><span class="o">.</span><span class="na">debug</span><span class="o">(</span><span class="s">&quot;delete&quot;</span><span class="o">);</span>
        <span class="c1">// remove all dynamic commands and attributes</span>
        <span class="n">dynamicManager</span><span class="o">.</span><span class="na">clearAll</span><span class="o">();</span>
    <span class="o">}</span>

    <span class="cm">/**</span>
<span class="cm">    * Execute command start.</span>
<span class="cm">    */</span>
    <span class="nd">@Command</span>
    <span class="nd">@StateMachine</span><span class="o">(</span><span class="n">endState</span> <span class="o">=</span> <span class="n">DeviceState</span><span class="o">.</span><span class="na">RUNNING</span><span class="o">,</span> <span class="n">deniedStates</span> <span class="o">=</span>
    <span class="n">DeviceState</span><span class="o">.</span><span class="na">FAULT</span><span class="o">)</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">start</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">logger</span><span class="o">.</span><span class="na">debug</span><span class="o">(</span><span class="s">&quot;start&quot;</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="cm">/**</span>
<span class="cm">    * Read attribute myAttribute.</span>
<span class="cm">    *</span>
<span class="cm">    * @return</span>
<span class="cm">    */</span>
    <span class="kd">public</span> <span class="kt">double</span> <span class="nf">getMyAttribute</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">logger</span><span class="o">.</span><span class="na">debug</span><span class="o">(</span><span class="s">&quot;getMyAttribute {}&quot;</span><span class="o">,</span> <span class="n">myAttribute</span><span class="o">);</span>
        <span class="k">return</span> <span class="n">myAttribute</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="cm">/**</span>
<span class="cm">    * Write attribute myAttribute</span>
<span class="cm">    *</span>
<span class="cm">    * @param myAttribute</span>
<span class="cm">    */</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setMyAttribute</span><span class="o">(</span><span class="kd">final</span> <span class="kt">double</span> <span class="n">myAttribute</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">logger</span><span class="o">.</span><span class="na">debug</span><span class="o">(</span><span class="s">&quot;setMyAttribute {}&quot;</span><span class="o">,</span> <span class="n">myAttribute</span><span class="o">);</span>
        <span class="k">this</span><span class="o">.</span><span class="na">myAttribute</span> <span class="o">=</span> <span class="n">myAttribute</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setMyProp</span><span class="o">(</span><span class="kd">final</span> <span class="n">String</span> <span class="n">myProp</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">myProp</span> <span class="o">=</span> <span class="n">myProp</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setMyClassProp</span><span class="o">(</span><span class="kd">final</span> <span class="kt">int</span> <span class="n">myClassProp</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">myClassProp</span> <span class="o">=</span> <span class="n">myClassProp</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">String</span><span class="o">[]&gt;</span> <span class="nf">getDeviceProperties</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">deviceProperties</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="n">DeviceState</span> <span class="nf">getState</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">state</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setState</span><span class="o">(</span><span class="kd">final</span> <span class="n">DeviceState</span> <span class="n">state</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">state</span> <span class="o">=</span> <span class="n">state</span><span class="o">;</span>
    <span class="o">}</span>

<span class="o">}</span>
</pre></div>
</div>
</div>
<div class="section" id="logging-configuration-with-logback">
<h2>Logging configuration with logback<a class="headerlink" href="#logging-configuration-with-logback" title="Permalink to this headline">¶</a></h2>
<p>In this example, the logging is output to the console. The underlying
APIs Jacorb and ehcache will log only errors while the classes
“org.tango.test” will log in debug level. And the rest of classes will
log in debug (root level). See
<a class="reference external" href="http://logback.qos.ch/manual/configuration.html">*http://logback.qos.ch/manual/configuration.html*</a>
for details.</p>
<div class="highlight-xml"><div class="highlight"><pre><span></span><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span>
<span class="nt">&lt;configuration&gt;</span>
    <span class="nt">&lt;jmxConfigurator</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;appender</span> <span class="na">name=</span><span class="s">&quot;CONSOLE&quot;</span>  <span class="na">class=</span><span class="s">&quot;ch.qos.logback.core.ConsoleAppender&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;layout</span> <span class="na">class=</span><span class="s">&quot;ch.qos.logback.classic.PatternLayout&quot;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;pattern&gt;</span>%-5level %d{HH:mm:ss.SSS} [%thread - %X{deviceName}] %logger{36}.%M:%L - %msg%n<span class="nt">&lt;/pattern&gt;</span>
        <span class="nt">&lt;/layout&gt;</span>
    <span class="nt">&lt;/appender&gt;</span>
    <span class="nt">&lt;logger</span> <span class="na">name=</span><span class="s">&quot;jacorb&quot;</span> <span class="na">level=</span><span class="s">&quot;ERROR&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;logger</span> <span class="na">name=</span><span class="s">&quot;net.sf.ehcache&quot;</span> <span class="na">level=</span><span class="s">&quot;ERROR&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;logger</span> <span class="na">name=</span><span class="s">&quot;org.tango&quot;</span> <span class="na">level=</span><span class="s">&quot;ERROR&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;logger</span> <span class="na">name=</span><span class="s">&quot;org.tango.test&quot;</span> <span class="na">level=</span><span class="s">&quot;DEBUG&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;root</span> <span class="na">level=</span><span class="s">&quot;DEBUG&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;appender-ref</span> <span class="na">ref=</span><span class="s">&quot;CONSOLE&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;/root&gt;</span>
<span class="nt">&lt;/configuration&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="properties-file-for-a-device-without-tango-database">
<h2>Properties file for a device without Tango Database<a class="headerlink" href="#properties-file-for-a-device-without-tango-database" title="Permalink to this headline">¶</a></h2>
<div class="highlight-text"><div class="highlight"><pre><span></span># --- 1/1/1 *properties*
1/1/1-&gt;myProp:titi
CLASS/TestDevice-&gt;myClassProp: 10
</pre></div>
</div>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../../debugging-and-testing/index.html" class="btn btn-neutral float-right" title="Debugging and Testing" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="index.html" class="btn btn-neutral" title="Tango Device in Java" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, Tango Community, Creative Commons Attribution 4.0 International (CC BY 4.0).

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../../',
            VERSION:'9.2.5',
            LANGUAGE:'en',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>
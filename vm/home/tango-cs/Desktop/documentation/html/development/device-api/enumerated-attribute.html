

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Enumerated attribute &mdash; Tango Controls 9.2.5 documentation</title>
  

  
  
    <link rel="shortcut icon" href="../../_static/favicon.png"/>
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="../../genindex.html"/>
        <link rel="search" title="Search" href="../../search.html"/>
    <link rel="top" title="Tango Controls 9.2.5 documentation" href="../../index.html"/>
        <link rel="up" title="Device Servers" href="index.html"/>
        <link rel="next" title="Memorized attribute" href="memorized-attribute.html"/>
        <link rel="prev" title="Attribute alarms" href="attribute-alarms.html"/> 

  
  <script src="../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../contents.html" class="icon icon-home"> Tango Controls
          

          
            
            <img src="../../_static/logo_tangocontrols_white.png" class="logo" />
          
          </a>

          
            
            
              <div class="version">
                9.2
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../index.html">Welcome to Tango Controls documentation!</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../authors.html">Authors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../overview/index.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../installation/index.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../getting-started/index.html">Getting Started</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Developer’s Guide</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../overview.html">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../general-guidelines/index.html">General guidelines</a></li>
<li class="toctree-l2"><a class="reference internal" href="../corba.html">10 things you should know about CORBA</a></li>
<li class="toctree-l2"><a class="reference internal" href="../client-api/index.html">Tango Client</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html">Device Servers</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="introduction.html">Introduction to device server</a></li>
<li class="toctree-l3"><a class="reference internal" href="ds-guideline/index.html">TANGO Device Server Guidelines</a></li>
<li class="toctree-l3"><a class="reference internal" href="device-server-model.html">The TANGO device server model</a></li>
<li class="toctree-l3"><a class="reference internal" href="device-server-writing.html">Writing a TANGO device server</a></li>
<li class="toctree-l3"><a class="reference internal" href="attribute-alarms.html">Attribute alarms</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Enumerated attribute</a></li>
<li class="toctree-l3"><a class="reference internal" href="memorized-attribute.html">Memorized attribute</a></li>
<li class="toctree-l3"><a class="reference internal" href="forwarded-attribute.html">Forwarded attribute</a></li>
<li class="toctree-l3"><a class="reference internal" href="device-polling.html">Device polling</a></li>
<li class="toctree-l3"><a class="reference internal" href="generating-events.html">Generating events in a device server</a></li>
<li class="toctree-l3"><a class="reference internal" href="java/index.html">Tango Device in Java</a></li>
<li class="toctree-l3"><a class="reference internal" href="python/index.html">PyTango - a Python binding to Tango</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../debugging-and-testing/index.html">Debugging and Testing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../advanced/index.html">Advanced</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cpp-api/index.html">Tango Core C++ Classes Reference Documentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../contributing/index.html">Contributing</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../tools-and-extensions/index.html">Tools and Extensions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../administration/index.html">Administration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials-and-howtos/index.html">Tutorials and How-Tos</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../reference/index.html">Reference</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../contents.html">Tango Controls</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../contents.html">Docs</a> &raquo;</li>
        
          <li><a href="../index.html">Developer’s Guide</a> &raquo;</li>
        
          <li><a href="index.html">Device Servers</a> &raquo;</li>
        
      <li>Enumerated attribute</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/development/device-api/enumerated-attribute.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="enumerated-attribute">
<h1>Enumerated attribute<a class="headerlink" href="#enumerated-attribute" title="Permalink to this headline">¶</a></h1>
<p>Since Tango release 9, enumerated attribute is supported using the new
data type DevEnum. This data type is not a real C++ enumeration because:</p>
<ol class="arabic simple">
<li>The enumerated value allways start with 0</li>
<li>Values are consecutive</li>
<li>It is transferred on the network as DevShort data type</li>
</ol>
<p>One enumeration label is associated to each enumeration value. For the
Tango kernel, it is this list of enumeration labels which will define
the possible enumeration values. For instance if the enumeration has 3
labels, its value must be between 0 and 2. There are two ways to define
the enumeration labels:</p>
<ol class="arabic simple">
<li>At attribute creation time. This is the most common case when the
list of possible enumeration values and labels are known at compile
time. The Tango code generator Pogo generates for you the code needed
to pass the enumeration labels to the Tango kernel.</li>
<li>In the user code when the enumeration values and labels are not known
at compile time but retrieved during device startup phase. The user
gives the possible enumeration values to the Tango kernel using the
Attribute class <em>set_properties()</em> method.</li>
</ol>
<p>A Tango client is able to retrieve the enumeration labels in the
attribute configuration returned by instance by a call to the
<em>DeviceProxy::get_attribute_config()</em> method. Using the
<em>DeviceProxy::set_attribute_config()</em> call, a user may change the
enumeration labels but not their number.</p>
<div class="section" id="usage-in-a-tango-class">
<h2>Usage in a Tango class<a class="headerlink" href="#usage-in-a-tango-class" title="Permalink to this headline">¶</a></h2>
<p>Within a Tango class, you set the attribute value with a C++ enum or a
DevShort variable. In case a DevShort variable is used, its value will
be checked according to the enumeration labels list given to Tango
kernel.</p>
<div class="section" id="setting-the-labels-with-enumeration-compile-time-knowledge">
<h3>Setting the labels with enumeration compile time knowledge<a class="headerlink" href="#setting-the-labels-with-enumeration-compile-time-knowledge" title="Permalink to this headline">¶</a></h3>
<p>In such a case, the enumeration labels are given to Tango at the
attribute creation time in the <em>attribute_factory</em> method of the
XXXClass class. Let us take one example</p>
<pre class="code cpp literal-block">
<span class="ln"> 1 </span>  <span class="keyword">enum</span> <span class="keyword">class</span> <span class="name class">Card</span><span class="operator">:</span> <span class="keyword type">short</span>
<span class="ln"> 2 </span>  <span class="punctuation">{</span>
<span class="ln"> 3 </span>      <span class="name">NORTH</span> <span class="operator">=</span> <span class="literal number integer">0</span><span class="punctuation">,</span>
<span class="ln"> 4 </span>      <span class="name">SOUTH</span><span class="punctuation">,</span>
<span class="ln"> 5 </span>      <span class="name">EAST</span><span class="punctuation">,</span>
<span class="ln"> 6 </span>      <span class="name">WEST</span>
<span class="ln"> 7 </span>  <span class="punctuation">};</span>
<span class="ln"> 8 </span>
<span class="ln"> 9 </span>  <span class="keyword type">void</span> <span class="name">XXXClass</span><span class="operator">::</span><span class="name">attribute_factory</span><span class="punctuation">(</span><span class="name">vector</span><span class="operator">&lt;</span><span class="name">Tango</span><span class="operator">::</span><span class="name">Attr</span> <span class="operator">*&gt;</span> <span class="operator">&amp;</span><span class="name">att_list</span><span class="punctuation">)</span>
<span class="ln">10 </span>  <span class="punctuation">{</span>
<span class="ln">11 </span>      <span class="punctuation">.....</span>
<span class="ln">12 </span>      <span class="name">TheEnumAttrib</span>   <span class="operator">*</span><span class="name">theenum</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="name">TheEnumAttrib</span><span class="punctuation">();</span>
<span class="ln">13 </span>      <span class="name">Tango</span><span class="operator">::</span><span class="name">UserDefaultAttrProp</span> <span class="name">theenum_prop</span><span class="punctuation">;</span>
<span class="ln">14 </span>      <span class="name">vector</span><span class="operator">&lt;</span><span class="name">string</span><span class="operator">&gt;</span> <span class="name">labels</span> <span class="operator">=</span> <span class="punctuation">{</span><span class="literal string">&quot;North&quot;</span><span class="punctuation">,</span><span class="literal string">&quot;South&quot;</span><span class="punctuation">,</span><span class="literal string">&quot;East&quot;</span><span class="punctuation">,</span><span class="literal string">&quot;West&quot;</span><span class="punctuation">};</span>
<span class="ln">15 </span>      <span class="name">theenum_prop</span><span class="punctuation">.</span><span class="name">set_enum_labels</span><span class="punctuation">(</span><span class="name">labels</span><span class="punctuation">);</span>
<span class="ln">16 </span>      <span class="name">theenum</span><span class="operator">-&gt;</span><span class="name">set_default_properties</span><span class="punctuation">(</span><span class="name">theenum_prop</span><span class="punctuation">);</span>
<span class="ln">17 </span>      <span class="name">att_list</span><span class="punctuation">.</span><span class="name">push_back</span><span class="punctuation">(</span><span class="name">theenum</span><span class="punctuation">);</span>
<span class="ln">18 </span>      <span class="punctuation">.....</span>
<span class="ln">19 </span>   <span class="punctuation">}</span>
</pre>
<p>line 1-7 : The definition of the enumeration (C++11 in this example)</p>
<p>line 14 : A vector of strings with the enumeration labels is created.
Because there is no way to get the labels from the enumeration
definition, they are re-defined here.</p>
<p>line 15 : This vector is given to the theenum_prop object which
contains the user default properties</p>
<div class="line-block">
<div class="line">line 16 : The user default properties are associated to the attribute</div>
<div class="line">In most cases, all this code will be automatically generated by the
Tango code generator Pogo. It is given here for completness.</div>
</div>
</div>
<div class="section" id="setting-the-labels-without-enumeration-compile-time-knowledge">
<h3>Setting the labels without enumeration compile time knowledge<a class="headerlink" href="#setting-the-labels-without-enumeration-compile-time-knowledge" title="Permalink to this headline">¶</a></h3>
<p>In such a case, the enumeration labels are retrieved by the user in a
way specific to the device and passed to Tango using the Attribute class
<em>set_properties()</em> method. Let us take one example</p>
<pre class="code cpp literal-block">
<span class="ln"> 1 </span>  <span class="keyword type">void</span> <span class="name">MyDev</span><span class="operator">::</span><span class="name">init_device</span><span class="punctuation">()</span>
<span class="ln"> 2 </span>  <span class="punctuation">{</span>
<span class="ln"> 3 </span>      <span class="punctuation">...</span>
<span class="ln"> 4 </span>
<span class="ln"> 5 </span>      <span class="name">Attribute</span> <span class="operator">&amp;</span><span class="name">att</span> <span class="operator">=</span> <span class="name">get_device_attr</span><span class="punctuation">()</span><span class="operator">-&gt;</span><span class="name">get_attr_by_name</span><span class="punctuation">(</span><span class="literal string">&quot;TheEnumAtt&quot;</span><span class="punctuation">);</span>
<span class="ln"> 6 </span>      <span class="name">MultiAttrProp</span><span class="operator">&lt;</span><span class="name">DevEnum</span><span class="operator">&gt;</span> <span class="name">multi_prop</span><span class="punctuation">;</span>
<span class="ln"> 7 </span>      <span class="name">att</span><span class="punctuation">.</span><span class="name">get_properties</span><span class="punctuation">(</span><span class="name">multi_prop</span><span class="punctuation">);</span>
<span class="ln"> 8 </span>
<span class="ln"> 9 </span>      <span class="name">multi_prop</span><span class="punctuation">.</span><span class="name">enum_labels</span> <span class="operator">=</span> <span class="punctuation">{....};</span>
<span class="ln">10 </span>      <span class="name">att</span><span class="punctuation">.</span><span class="name">set_properties</span><span class="punctuation">(</span><span class="name">multi_prop</span><span class="punctuation">);</span>
<span class="ln">11 </span>      <span class="punctuation">....</span>
<span class="ln">12 </span>   <span class="punctuation">}</span>
</pre>
<p>line 5 : Get a reference to the attribute object</p>
<p>line 7 : Retrieve the attribute properties</p>
<p>line 9 : Initialise the attribute labels in the set of attribute
properties</p>
<p>line 10 : Set the attribute properties</p>
</div>
<div class="section" id="setting-the-attribute-value">
<h3>Setting the attribute value<a class="headerlink" href="#setting-the-attribute-value" title="Permalink to this headline">¶</a></h3>
<p>It is possible to set the attribute value using either a classical
DevShort variable or using a variable of the C++ enumeration. The
following example is when you have compile time knowledge of the
enumeration definition. We assume that the enumeration is the same than
the one defined above (Card enumeration)</p>
<pre class="code cpp literal-block">
<span class="ln">1 </span>  <span class="keyword">enum</span> <span class="name">Card</span> <span class="name">points</span><span class="punctuation">;</span>
<span class="ln">2 </span>
<span class="ln">3 </span>  <span class="keyword type">void</span> <span class="name">MyDev</span><span class="operator">::</span><span class="name">read_TheEnum</span><span class="punctuation">(</span><span class="name">Attribute</span> <span class="operator">&amp;</span><span class="name">att</span><span class="punctuation">)</span>
<span class="ln">4 </span>  <span class="punctuation">{</span>
<span class="ln">5 </span>      <span class="punctuation">...</span>
<span class="ln">6 </span>      <span class="name">points</span> <span class="operator">=</span> <span class="name">SOUTH</span><span class="punctuation">;</span>
<span class="ln">7 </span>      <span class="name">att</span><span class="punctuation">.</span><span class="name">set_value</span><span class="punctuation">(</span><span class="operator">&amp;</span><span class="name">points</span><span class="punctuation">);</span>
<span class="ln">8 </span>  <span class="punctuation">}</span>
</pre>
<p>line 1 : One instance of the Card enum is created (named points)</p>
<p>line 6 : The enumeration is initialized</p>
<div class="line-block">
<div class="line">line 7 : The value of the attribute object is set using the
enumeration (by pointer)</div>
<div class="line">To get the same result using a classical DevShort variable, the code
looks like</div>
</div>
<pre class="code cpp literal-block">
<span class="ln">1 </span>  <span class="name">DevShort</span> <span class="name">sh</span><span class="punctuation">;</span>
<span class="ln">2 </span>
<span class="ln">3 </span>  <span class="keyword type">void</span> <span class="name">MyDev</span><span class="operator">::</span><span class="name">read_TheEnum</span><span class="punctuation">(</span><span class="name">Attribute</span> <span class="operator">&amp;</span><span class="name">att</span><span class="punctuation">)</span>
<span class="ln">4 </span>  <span class="punctuation">{</span>
<span class="ln">5 </span>      <span class="punctuation">...</span>
<span class="ln">6 </span>      <span class="name">sh</span> <span class="operator">=</span> <span class="literal number integer">1</span><span class="punctuation">;</span>
<span class="ln">7 </span>      <span class="name">att</span><span class="punctuation">.</span><span class="name">set_value</span><span class="punctuation">(</span><span class="operator">&amp;</span><span class="name">sh</span><span class="punctuation">);</span>
<span class="ln">8 </span>  <span class="punctuation">}</span>
</pre>
<p>line 1 : A DevShort variable is created (named sh)</p>
<p>line 6 : The variable is initialized</p>
<p>line 7 : The value of the attribute object is set using the DevShort
variable (by pointer)</p>
</div>
</div>
<div class="section" id="usage-in-a-tango-client">
<h2>Usage in a Tango client<a class="headerlink" href="#usage-in-a-tango-client" title="Permalink to this headline">¶</a></h2>
<p>Within a Tango client, you insert/extract enumerated attribute value
in/from DeviceAttribute object with a C++ enum or a DevShort variable.
The later case is for generic client which do not have compile time
knowledge of the enumeration. The code looks like</p>
<pre class="code cpp literal-block">
<span class="ln">1 </span>  <span class="name">DeviceAttribute</span> <span class="name">da</span> <span class="operator">=</span> <span class="name">the_dev</span><span class="punctuation">.</span><span class="name">read_attribute</span><span class="punctuation">(</span><span class="literal string">&quot;TheEnumAtt&quot;</span><span class="punctuation">);</span>
<span class="ln">2 </span>  <span class="name">Card</span> <span class="name">ca</span><span class="punctuation">;</span>
<span class="ln">3 </span>  <span class="name">da</span> <span class="operator">&gt;&gt;</span> <span class="name">ca</span><span class="punctuation">;</span>
<span class="ln">4 </span>
<span class="ln">5 </span>  <span class="name">DeviceAttribute</span> <span class="name">db</span> <span class="operator">=</span> <span class="name">the_dev</span><span class="punctuation">.</span><span class="name">read_attribute</span><span class="punctuation">(</span><span class="literal string">&quot;TheEnumAtt&quot;</span><span class="punctuation">);</span>
<span class="ln">6 </span>  <span class="name">DevShort</span> <span class="name">sh</span><span class="punctuation">;</span>
<span class="ln">7 </span>  <span class="name">da</span> <span class="operator">&gt;&gt;</span> <span class="name">sh</span><span class="punctuation">;</span>
</pre>
<p>line 2-3 : The attribute value is extracted in a C++ enumeration
variable</p>
<p>line 6-7 : The attribute value is extracted in a DevShort variable</p>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="memorized-attribute.html" class="btn btn-neutral float-right" title="Memorized attribute" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="attribute-alarms.html" class="btn btn-neutral" title="Attribute alarms" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, Tango Community, Creative Commons Attribution 4.0 International (CC BY 4.0).

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../',
            VERSION:'9.2.5',
            LANGUAGE:'en',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>
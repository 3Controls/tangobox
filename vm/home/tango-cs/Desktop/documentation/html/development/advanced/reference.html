

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Reference part &mdash; Tango Controls 9.2.5 documentation</title>
  

  
  
    <link rel="shortcut icon" href="../../_static/favicon.png"/>
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="../../genindex.html"/>
        <link rel="search" title="Search" href="../../search.html"/>
    <link rel="top" title="Tango Controls 9.2.5 documentation" href="../../index.html"/>
        <link rel="up" title="Advanced" href="index.html"/>
        <link rel="next" title="Tango Core C++ Classes Reference Documentation" href="../cpp-api/index.html"/>
        <link rel="prev" title="The TANGO IDL file : Module Tango" href="IDL.html"/> 

  
  <script src="../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../contents.html" class="icon icon-home"> Tango Controls
          

          
            
            <img src="../../_static/logo_tangocontrols_white.png" class="logo" />
          
          </a>

          
            
            
              <div class="version">
                9.2
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../index.html">Welcome to Tango Controls documentation!</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../authors.html">Authors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../overview/index.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../installation/index.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../getting-started/index.html">Getting Started</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Developer’s Guide</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../overview.html">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../general-guidelines/index.html">General guidelines</a></li>
<li class="toctree-l2"><a class="reference internal" href="../corba.html">10 things you should know about CORBA</a></li>
<li class="toctree-l2"><a class="reference internal" href="../client-api/index.html">Tango Client</a></li>
<li class="toctree-l2"><a class="reference internal" href="../device-api/index.html">Device Servers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../debugging-and-testing/index.html">Debugging and Testing</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html">Advanced</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="threading.html">Threading</a></li>
<li class="toctree-l3"><a class="reference internal" href="transferring-images.html">Transferring images</a></li>
<li class="toctree-l3"><a class="reference internal" href="user-loop.html">Device server with user defined event loop</a></li>
<li class="toctree-l3"><a class="reference internal" href="TangoDeviceServerModel.html">Tango Device Server Model</a></li>
<li class="toctree-l3"><a class="reference internal" href="rest-api.html">Tango REST API</a></li>
<li class="toctree-l3"><a class="reference internal" href="IDL.html">The TANGO IDL file : Module Tango</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Reference part</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../cpp-api/index.html">Tango Core C++ Classes Reference Documentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../contributing/index.html">Contributing</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../tools-and-extensions/index.html">Tools and Extensions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../administration/index.html">Administration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials-and-howtos/index.html">Tutorials and How-Tos</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../reference/index.html">Reference</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../contents.html">Tango Controls</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../contents.html">Docs</a> &raquo;</li>
        
          <li><a href="../index.html">Developer’s Guide</a> &raquo;</li>
        
          <li><a href="index.html">Advanced</a> &raquo;</li>
        
      <li>Reference part</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/development/advanced/reference.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="reference-part">
<h1>Reference part<a class="headerlink" href="#reference-part" title="Permalink to this headline">¶</a></h1>
<p><strong>This chapter is only part of the TANGO device server reference guide.
To get reference documentation about the C++ library classes, see
[TangoRefMan]_ . To get reference documentation about
the Java classes, also see   [TangoRefMan]_ .</strong></p>
<div class="section" id="device-parameter">
<h2>Device parameter<a class="headerlink" href="#device-parameter" title="Permalink to this headline">¶</a></h2>
<p>A black box, a device description field, a device state and status are
associated with each TANGO device.</p>
<div class="section" id="the-device-black-box">
<h3>The device black box<a class="headerlink" href="#the-device-black-box" title="Permalink to this headline">¶</a></h3>
<p>The device black box is managed as a circular buffer. It is possible to
tune the buffer depth via a device property. This property name is</p>
<p>device name-&gt;blackbox_depth</p>
<p>A default value is hard-coded to 50 if the property is not defined. This
black box depth property is retrieved from the Tango property database
during the device creation phase.</p>
</div>
<div class="section" id="the-device-description-field">
<h3>The device description field<a class="headerlink" href="#the-device-description-field" title="Permalink to this headline">¶</a></h3>
<p>There are two ways to intialise the device description field.</p>
<ul>
<li><p class="first">At device creation time. Some constructors of the DeviceImpl class
supports this field as parameter. If these constructor are not used,
the device description field is set to a default value which is <em>A
Tango device</em>.</p>
</li>
<li><p class="first">With a property. A description field defines with this method
overrides a device description defined at construction time. The
property name is</p>
<p>device name-&gt;description</p>
</li>
</ul>
</div>
<div class="section" id="the-device-state-and-status">
<h3>The device state and status<a class="headerlink" href="#the-device-state-and-status" title="Permalink to this headline">¶</a></h3>
<p>Some constructors of the DeviceImpl class allows the initialisation of
device state and/or status or device creation time. If these fields are
not defined, a default value is applied. The default state is
Tango::UNKOWN, the default status is <em>Not Initialised.</em></p>
</div>
<div class="section" id="the-device-polling">
<h3>The device polling<a class="headerlink" href="#the-device-polling" title="Permalink to this headline">¶</a></h3>
<p>Seven device properties allow the polling tunning. These properties are
described in the following table</p>
<table border="1" class="docutils">
<colgroup>
<col width="33%" />
<col width="33%" />
<col width="33%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Property name</th>
<th class="head">property rule</th>
<th class="head">default value</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>poll_ring_depth</td>
<td>Polling buffer depth</td>
<td>10</td>
</tr>
<tr class="row-odd"><td>cmd_poll_ring_depth</td>
<td>Cmd polling buffer depth</td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td>attr_poll_ring_depth</td>
<td>Attr polling buffer depth</td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td>poll_old_factor</td>
<td>Data too old factor</td>
<td>4</td>
</tr>
<tr class="row-even"><td>min_poll_period</td>
<td>Minimun polling period</td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td>cmd_min_poll_period</td>
<td>Min. polling period for cmd</td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td>attr_min_poll_period</td>
<td>Min. polling period for attr</td>
<td>&#160;</td>
</tr>
</tbody>
</table>
<p>The rule of the poll_ring_depth property is obvious. It defines the
polling ring depth for all the device polled command(s) and
attribute(s). Nevertheless, when filling the polling buffer via the
fill_cmd_polling_buffer() (or fill_attr_polling_buffer()) method,
it could be helpfull to define specific polling ring depth for a command
(or an attribute). This is the rule of the cmd_poll_ring_depth and
attr_poll_ring_depth properties. For each polled object with specific
polling depth (command or attribute), the syntax of this property is the
object name followed by the ring depth (ie State,20,Status,15). If one
of these properties is defined, for the specific command or attribute,
it will overwrite the value set by the poll_ring_depth property. The
poll_old_factor property allows the user to tune how long the data
recorded in the polling buffer are valid. Each time some data are read
from the polling buffer, a check is done between the date when the data
were recorded in the polling buffer and the date when the user request
these data. If the interval is greater than the object polling period
multiply by the value of the poll_old_factor factory, an exception is
returned to the caller. These two properties are defined at device level
and therefore, it is not possible to tune this parameter for each polled
object (command or attribute). The last 3 properties are dedicated to
define a polling period minimum threshold. The property
min_poll_period defines in (mS) a device minimum polling period.
Property cmd_min_poll_period defines (in mS) a minimum polling period
for a specific command. The syntax of this property is the command name
followed by the minimum polling period (ie MyCmd,400). Property
attr_min_poll_period defines (in mS) a minimum polling period for a
specific attribute. The syntax of this property is the attribute name
followed by the minimum polling period (ie MyAttr,600). These two
properties has a higher priority than the min_poll_period property. By
default these three properties are not defined mening that there is no
minimun polling period.</p>
<p>Four other properties are used by the Tango core classes to manage the
polling thread. These properties are :</p>
<ul class="simple">
<li>polled_cmd to memorize the name of the device polled command</li>
<li>polled_attr to memorize the name of the device polled attribute</li>
<li>non_auto_polled_cmd to memorize the name of the command which
shoule not be polled automatically at the first request</li>
<li>non_auto_polled_attr to memorize the name of the attribute which
should not be polled automatically at the first request</li>
</ul>
<p>You don’t have to change these properties values by yourself. They are
automatically created/modified/deleted by Tango core classes.</p>
</div>
<div class="section" id="the-device-logging">
<h3>The device logging<a class="headerlink" href="#the-device-logging" title="Permalink to this headline">¶</a></h3>
<p>The Tango Logging Service (TLS) uses device properties to control device
logging at startup (static configuration). These properties are
described in the following table</p>
<table border="1" class="docutils">
<colgroup>
<col width="33%" />
<col width="33%" />
<col width="33%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Property name</th>
<th class="head">property rule</th>
<th class="head">default value</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>logging_level</td>
<td>Initial device logging level</td>
<td>WARN</td>
</tr>
<tr class="row-odd"><td>logging_target</td>
<td>Initial device logging target</td>
<td>No default</td>
</tr>
<tr class="row-even"><td>logging_rft</td>
<td>Logging rolling file threshold</td>
<td>20 Mega bytes</td>
</tr>
<tr class="row-odd"><td>logging_path</td>
<td>Logging file path</td>
<td>/tmp/tango-&lt;logging name&gt; or C:/tango-&lt;logging name&gt; (Windows)</td>
</tr>
</tbody>
</table>
<ul>
<li><p class="first">The logging_level property controls the initial logging level of a
device. Its set of possible values is: OFF, FATAL, ERROR, WARN, INFO
or DEBUG. This property is overwritten by the verbose command line
option (-v).</p>
</li>
<li><p class="first">The logging_target property is a multi-valued property containing
the initial target list. Each entry must have the following format:
target_type::target_name (where target_type is one of the
supported target types and target_name, the name of the target).
Supported target types are: <em>console</em>, <em>file</em> and <em>device</em>. For a
device target, target_name must contain the name of a log consumer
device (as defined in [sec:Tango-log-consumer]). For a file target,
target_name is the name of the file to log to. If omitted the
device’s name is used to build the file name
(domain_family_member.log). Finally, target_name is ignored in the
case of a console target. The TLS does not report any error occurred
while trying to setup the initial targets.</p>
<ul>
<li><div class="first line-block">
<div class="line">Logging_target property example :</div>
<div class="line">logging_target = [ console, file, <a class="reference external" href="file::/home/me/mydevice.log">file::/home/me/mydevice.log</a>,
device::tmp/log/1</div>
<div class="line">In this case, the device will automatically logs to the standard
output, to its default file (which is something like
domain_family_member.log), to a file named mydevice.log and
located in /home/me. Finally, the device logs are also sent to a
log consumer device named tmp/log/1.</div>
</div>
</li>
</ul>
</li>
<li><p class="first">The logging_rft property specifies the rolling file threshold (rft),
of the device’s file targets. This threshold is expressed in Kb. When
the size of a log file reaches the so-called rolling-file-threshold
(rft), it is backuped as <em>current_log_file_name</em> + <em>_1</em> and a new
current_log_file_name is opened. Obviously, there is only one
backup file at a time (i.e. any existing backup is destroyed before
the current log file is backuped). The default threshold is 20 Mb,
the minimum is 500 Kb and the maximum is 1000 Mb.</p>
</li>
<li><p class="first">The logging_path property overwrites the TANGO_LOG_PATH
environment variable. This property can only be applied to a DServer
class device and has no effect on other devices.</p>
</li>
</ul>
</div>
</div>
<div class="section" id="device-attribute">
<h2>Device attribute<a class="headerlink" href="#device-attribute" title="Permalink to this headline">¶</a></h2>
<p>Attribute are configured with two kind of parameters: Parameters
hard-coded in source code and modifiable parameters</p>
<div class="section" id="hard-coded-device-attribute-parameters">
<h3>Hard-coded device attribute parameters<a class="headerlink" href="#hard-coded-device-attribute-parameters" title="Permalink to this headline">¶</a></h3>
<p>Seven attribute parameters are defined at attribute creation time in the
Tango class source code. Obviously, these parameters are not modifiable
except with a new source code compilation. These parameters are</p>
<table border="1" class="docutils">
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Parameter name</th>
<th class="head">Parameter description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>name</td>
<td>Attribute name</td>
</tr>
<tr class="row-odd"><td>data_type</td>
<td>Attribute data type</td>
</tr>
<tr class="row-even"><td>data_format</td>
<td>Attribute data format</td>
</tr>
<tr class="row-odd"><td>writable</td>
<td>Attribute read/write type</td>
</tr>
<tr class="row-even"><td>max_dim_x</td>
<td>Maximum X dimension</td>
</tr>
<tr class="row-odd"><td>max_dim_y</td>
<td>Maximum Y dimension</td>
</tr>
<tr class="row-even"><td>writable_attr_name</td>
<td>Associated write attribute</td>
</tr>
<tr class="row-odd"><td>level</td>
<td>Attribute display level</td>
</tr>
<tr class="row-even"><td>root_attr_name</td>
<td>Root attribute name</td>
</tr>
</tbody>
</table>
<div class="section" id="the-attribute-data-type">
<h4>The Attribute data type<a class="headerlink" href="#the-attribute-data-type" title="Permalink to this headline">¶</a></h4>
<p>Thirteen data types are supported. These data types are</p>
<ul class="simple">
<li>Tango::DevBoolean</li>
<li>Tango::DevShort</li>
<li>Tango::DevLong</li>
<li>Tango::DevLong64</li>
<li>Tango::DevFloat</li>
<li>Tango::DevDouble</li>
<li>Tango::DevUChar</li>
<li>Tango::DevUShort</li>
<li>Tango::DevULong</li>
<li>Tango::DevULong64</li>
<li>Tango::DevString</li>
<li>Tango::DevState</li>
<li>Tango::DevEncoded</li>
</ul>
</div>
<div class="section" id="the-attribute-data-format">
<h4>The attribute data format<a class="headerlink" href="#the-attribute-data-format" title="Permalink to this headline">¶</a></h4>
<p>Three data format are supported for attribute</p>
<table border="1" class="docutils">
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Format</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>Tango::SCALAR</td>
<td>The attribute value is a single number</td>
</tr>
<tr class="row-odd"><td>Tango::SPECTRUM</td>
<td>The attribute value is a one dimension number</td>
</tr>
<tr class="row-even"><td>Tango::IMAGE</td>
<td>The attribute value is a two dimension number</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="the-max-dim-x-and-max-dim-y-parameters">
<h4>The max_dim_x and max_dim_y parameters<a class="headerlink" href="#the-max-dim-x-and-max-dim-y-parameters" title="Permalink to this headline">¶</a></h4>
<p>These two parameters defined the maximum size for attributes of the
SPECTRUM and IMAGE data format.</p>
<table border="1" class="docutils">
<colgroup>
<col width="33%" />
<col width="33%" />
<col width="33%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">data format</th>
<th class="head">max_dim_x</th>
<th class="head">max_dim_y</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>Tango::SCALAR</td>
<td>1</td>
<td>0</td>
</tr>
<tr class="row-odd"><td>Tango::SPECTRUM</td>
<td>User Defined</td>
<td>0</td>
</tr>
<tr class="row-even"><td>Tango::IMAGE</td>
<td>User Defined</td>
<td>User Defined</td>
</tr>
</tbody>
</table>
<p>For attribute of the Tango::IMAGE data format, all the data are also
returned in a one dimension array. The first array is value[0],[0],
array element X is value[0],[X-1], array element X+1 is value[1][0] and
so forth.</p>
</div>
<div class="section" id="the-attribute-read-write-type">
<h4>The attribute read/write type<a class="headerlink" href="#the-attribute-read-write-type" title="Permalink to this headline">¶</a></h4>
<p>Tango supports four kind of read/write attribute which are :</p>
<ul class="simple">
<li>Tango::READ for read only attribute</li>
<li>Tango::WRITE for writable attribute</li>
<li>Tango::READ_WRITE for attribute which can be read and write</li>
<li>Tango::READ_WITH_WRITE for a readable attribute associated to a
writable attribute (For a power supply device, the current really
generated is not the wanted current. To handle this, two attributes
are defined which are <em>generated_current</em> and <em>wanted_current</em>. The
<em>wanted_current</em> is a Tango::WRITE attribute. When the
<em>generated_current</em> attribute is read, it is very convenient to also
get the <em>wanted_current</em> attribute. This is exactly what the
Tango::READ_WITH_WRITE attribute is doing)</li>
</ul>
<p>When read, attribute values are always returned within an array even for
scalar attribute. The length of this array and the meaning of its
elements is detailed in the following table for scalar attribute.</p>
<table border="1" class="docutils">
<colgroup>
<col width="25%" />
<col width="25%" />
<col width="25%" />
<col width="25%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Name</th>
<th class="head">Array length</th>
<th class="head">Array[0]</th>
<th class="head">Array[1]</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>Tango::READ</td>
<td>1</td>
<td>Read value</td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td>Tango::WRITE</td>
<td>1</td>
<td>Last write value</td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td>Tango::READ_WRITE</td>
<td>2</td>
<td>Read value</td>
<td>Last write value</td>
</tr>
<tr class="row-odd"><td>Tango::READ_WITH_WRITE</td>
<td>2</td>
<td>Read value</td>
<td>Associated attribute last write value</td>
</tr>
</tbody>
</table>
<p>When a spectrum or image attribute is read, it is possible to code the
device class in order to send only some part of the attribute data (For
instance only a Region Of Interest for an image) but never more than
what is defined by the attribute configuration parameters max_dim_x
and max_dim_y. The number of data sent is also transferred with the
data and is named <strong>dim_x</strong> and <strong>dim_y</strong>. When a spectrum or image
attribute is written, it is also possible to send only some of the
attribute data but always less than max_dim_x for spectrum and
max_dim_x * max_dim_y for image. The following table describe how
data are returned for spectrum attribute. dim_x is the data size sent
by the server when the attribute is read and dim_x_w is the data size
used during the last attribute write call.</p>
<table border="1" class="docutils">
<colgroup>
<col width="20%" />
<col width="20%" />
<col width="20%" />
<col width="20%" />
<col width="20%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Name</th>
<th class="head">Array length</th>
<th class="head">Array[0-&gt;dim_x-1]</th>
<th class="head">Array[dim_x-&gt; dim_x + dim_x_w -1]</th>
<th class="head">&#160;</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>Tango::READ</td>
<td>dim_x</td>
<td>Read values</td>
<td>&#160;</td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td>Tango::WRITE</td>
<td>dim_x_w</td>
<td>Last write values</td>
<td>&#160;</td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td>Tango::READ_WRITE</td>
<td>dim_x + dim_x_w</td>
<td>Read value</td>
<td>Last write values</td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td>Tango::READ_WITH_WRITE</td>
<td>dim_x + dim_x_w</td>
<td>Read value</td>
<td>Associated attributelast write values</td>
<td>&#160;</td>
</tr>
</tbody>
</table>
<p>The following table describe how data are returned for image attribute.
dim_r is the data size sent by the server when the attribute is read
(dim_x * dim_y) and dim_w is the data size used during the last
attribute write call (dim_x_w * dim_y_w).</p>
<table border="1" class="docutils">
<colgroup>
<col width="25%" />
<col width="25%" />
<col width="25%" />
<col width="25%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Name</th>
<th class="head">Array length</th>
<th class="head">Array[0-&gt;dim_r-1]</th>
<th class="head">Array[dim_r-&gt;dim_r + dim_w -1]</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>Tango::READ</td>
<td>dim_r</td>
<td>Read values</td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td>Tango::WRITE</td>
<td>dim_w</td>
<td>Last write values</td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td>Tango::READ_WRITE</td>
<td>dim_r + dim_w</td>
<td>Read value</td>
<td>Last write values</td>
</tr>
<tr class="row-odd"><td>Tango::READ_WITH_WRITE</td>
<td>dim_r + dim_w</td>
<td>Read value</td>
<td>Associated attributelast write values</td>
</tr>
</tbody>
</table>
<p>Until a write operation has been performed, the last write value is
initialized to <em>0</em> for scalar attribute of the numeriacal type, to <em>Not
Initialised</em> for scalar string attribute and to <em>true</em> for scalar
boolean attribute. For spectrum or image attribute, the last write value
is initialized to an array of one element set to <em>0</em> for numerical type,
to an array of one element set to <em>true</em> for boolean attribute and to an
array of one element set to <em>Not initialized</em> for string attribute</p>
</div>
<div class="section" id="the-associated-write-attribute-parameter">
<h4>The associated write attribute parameter<a class="headerlink" href="#the-associated-write-attribute-parameter" title="Permalink to this headline">¶</a></h4>
<p>This parameter has a meaning only for attribute with a
Tango::READ_WITH_WRITE read/write type. This is the name of the
associated write attribute.</p>
</div>
<div class="section" id="the-attribute-display-level-parameter">
<h4>The attribute display level parameter<a class="headerlink" href="#the-attribute-display-level-parameter" title="Permalink to this headline">¶</a></h4>
<p>This parameter is only an help for graphical application. It is a C++
enumeration starting at 0. The code associated with each attribute
display level is defined in the following table (Tango::DispLevel).</p>
<table border="1" class="docutils">
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">name</th>
<th class="head">Value</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>Tango::OPERATOR</td>
<td>0</td>
</tr>
<tr class="row-odd"><td>Tango::EXPERT</td>
<td>1</td>
</tr>
</tbody>
</table>
<p>This parameter allows a graphical application to support two types of
operation :</p>
<ul class="simple">
<li>An operator mode for day to day operation</li>
<li>An expert mode when tuning is necessary</li>
</ul>
<p>According to this parameter, a graphical application knows if the
attribute is for the operator mode or for the expert mode.</p>
</div>
<div class="section" id="the-root-attribute-name-parameter">
<h4>The root attribute name parameter<a class="headerlink" href="#the-root-attribute-name-parameter" title="Permalink to this headline">¶</a></h4>
<p>In case the attribute is a forwarded one, this parameter is the name of
the associated root attribute. In case of classical attribute, this
string is set to Not specified.</p>
</div>
</div>
<div class="section" id="modifiable-attribute-parameters">
<h3>Modifiable attribute parameters<a class="headerlink" href="#modifiable-attribute-parameters" title="Permalink to this headline">¶</a></h3>
<p>Each attribute has a configuration set of 20 modifiable parameters.
These can be grouped in three different purposes:</p>
<ol class="arabic simple">
<li>General purpose parameters</li>
<li>Alarm related parameters</li>
<li>Event related parameters</li>
</ol>
<div class="section" id="general-purpose-parameters">
<h4>General purpose parameters<a class="headerlink" href="#general-purpose-parameters" title="Permalink to this headline">¶</a></h4>
<p>Eight attribute parameters are modifiable at run-time via a device call
or via the property database.</p>
<table border="1" class="docutils">
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Parameter name</th>
<th class="head">Parameter description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>description</td>
<td>Attribute description</td>
</tr>
<tr class="row-odd"><td>label</td>
<td>Attribute label</td>
</tr>
<tr class="row-even"><td>unit</td>
<td>Attribute unit</td>
</tr>
<tr class="row-odd"><td>standard_unit</td>
<td>Conversion factor to MKSA unit</td>
</tr>
<tr class="row-even"><td>display_unit</td>
<td>The attribute unit in a printable form</td>
</tr>
<tr class="row-odd"><td>format</td>
<td>How to print attribute value</td>
</tr>
<tr class="row-even"><td>min_value</td>
<td>Attribute min value</td>
</tr>
<tr class="row-odd"><td>max_value</td>
<td>Attribute max value</td>
</tr>
<tr class="row-even"><td>enum_labels</td>
<td>Enumerated labels</td>
</tr>
<tr class="row-odd"><td>memorized</td>
<td>Attribute memorization</td>
</tr>
</tbody>
</table>
<p>The <strong>description</strong> parameter describes the attribute. The <strong>label</strong>
parameter is used by graphical application to display a label when this
attribute is used in a graphical application. The <strong>unit</strong> parameter is
the attribute value unit. The <strong>standard_unit</strong> parameter is the
conversion factor to get attribute value in MKSA units. Even if this
parameter is a number, it is returned as a string by the device
<em>get_attribute_config</em> call. The <strong>display_unit</strong> parameter is the
string used by graphical application to display attribute unit to
application user. The <strong>enum_labels</strong> parameter is defined only for
attribute of the DEV_ENUM data type. This is a vector of strings with
one string for each enumeration label. It is an ordered list.</p>
<div class="section" id="the-format-attribute-parameter">
<h5>The format attribute parameter<a class="headerlink" href="#the-format-attribute-parameter" title="Permalink to this headline">¶</a></h5>
<p>This parameter specifies how the attribute value should be printed. It
is not valid for string attribute. This format is a string of C++
streams manipulators separated by the <strong>;</strong> character. The supported
manipulators are :</p>
<ul class="simple">
<li>fixed</li>
<li>scientific</li>
<li>uppercase</li>
<li>showpoint</li>
<li>showpos</li>
<li>setprecision()</li>
<li>setw()</li>
</ul>
<p>Their definition are the same than for C++ streams. An example of format
parameter is</p>
<p><code class="docutils literal"><span class="pre">scientific;uppercase;setprecision(3)</span></code>.</p>
<p>A class called Tango::AttrManip has been written to handle this format
string. Once the attribute format string has been retrieved from the
device, its value can be printed with</p>
<p><code class="docutils literal"><span class="pre">cout</span> <span class="pre">&lt;&lt;</span> <span class="pre">Tango::AttrManip(format)</span> <span class="pre">&lt;&lt;</span> <span class="pre">value</span> <span class="pre">&lt;&lt;</span> <span class="pre">endl;</span></code></p>
</div>
<div class="section" id="the-min-value-and-max-value-parameters">
<h5>The min_value and max_value parameters<a class="headerlink" href="#the-min-value-and-max-value-parameters" title="Permalink to this headline">¶</a></h5>
<p>These two parameters have a meaning only for attribute of the
Tango::WRITE read/write type and for numerical data types. Trying to set
the value of an attribute to something less than or equal to the
min_value parameter is an error. Trying to set the value of the
attribute to something more or equal to the max_value parameter is also
an error. Even if these parameters are numbers, they are returned as
strings by the device <em>get_attribute_config()</em> call.</p>
<p>These two parameters have no meaning for attribute with data type
DevString, DevBoolean or DevState. An exception is thrown in case the
user try to set them for attribute of these 3 data types.</p>
</div>
<div class="section" id="the-memorized-attribute-parameter">
<h5>The memorized attribute parameter<a class="headerlink" href="#the-memorized-attribute-parameter" title="Permalink to this headline">¶</a></h5>
<p>This parameter describes the attribute memorization. It is an
enumeration with the following values:</p>
<ul class="simple">
<li>NOT_KNOWN : The device is too old to return this information.</li>
<li>NONE : The attribute is not memorized</li>
<li>MEMORIZED : The attribute is memorized</li>
<li>MEMORIZED_WRITE_INIT : The attribute is memorized and the memorized
value is applied at device initialization time.</li>
</ul>
</div>
</div>
<div class="section" id="the-alarm-related-configuration-parameters">
<h4>The alarm related configuration parameters<a class="headerlink" href="#the-alarm-related-configuration-parameters" title="Permalink to this headline">¶</a></h4>
<p>Six alarm related attribute parameters are modifiable at run-time via a
device call or via the property database.</p>
<table border="1" class="docutils">
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Parameter name</th>
<th class="head">Parameter description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>min_alarm</td>
<td>Attribute low level alarm</td>
</tr>
<tr class="row-odd"><td>max_alarm</td>
<td>Attribute high level alarm</td>
</tr>
<tr class="row-even"><td>min_warning</td>
<td>Attribute low level warning</td>
</tr>
<tr class="row-odd"><td>max_warning</td>
<td>Attribute high level warning</td>
</tr>
<tr class="row-even"><td>delta_t</td>
<td>delta time for RDS alarm (mS)</td>
</tr>
<tr class="row-odd"><td>delta_val</td>
<td>delta value for RDS alarm (absolute)</td>
</tr>
</tbody>
</table>
<p>These parameters have no meaning for attribute with data type DevString,
DevBoolean or DevState. An exception is thrown in case the user try to
set them for attribute of these 3 data types.</p>
<div class="section" id="the-min-alarm-and-max-alarm-parameters">
<h5>The min_alarm and max_alarm parameters<a class="headerlink" href="#the-min-alarm-and-max-alarm-parameters" title="Permalink to this headline">¶</a></h5>
<p>These two parameters have a meaning only for attribute of the
Tango::READ, Tango::READ_WRITE and Tango::READ_WITH_WRITE read/write
type and for numerical data type. When the attribute is read, if its
value is something less than or equal to the min_alarm parameter or if
it is something more or equal to the max_alarm parameter, the attribute
quality factor will be set to Tango::ATTR_ALARM and if the device state
is Tango::ON, it is switched to Tango::ALARM. Even if these parameters
are numbers, they are returned as strings by the device
<em>get_attribute_config()</em> call.</p>
</div>
<div class="section" id="the-min-warning-and-max-warning-parameters">
<h5>The min_warning and max_warning parameters<a class="headerlink" href="#the-min-warning-and-max-warning-parameters" title="Permalink to this headline">¶</a></h5>
<p>These two parameters have a meaning only for attribute of the
Tango::READ, Tango::READ_WRITE and Tango::READ_WITH_WRITE read/write
type and for numerical data type. When the attribute is read, if its
value is something less than or equal to the min_warning parameter or
if it is something more or equal to the max_warning parameter, the
attribute quality factor will be set to Tango::ATTR_WARNING and if the
device state is Tango::ON, it is switched to Tango::ALARM. Even if these
parameters are numbers, they are returned as strings by the device
<em>get_attribute_config()</em> call.</p>
</div>
<div class="section" id="the-delta-t-and-delta-val-parameters">
<h5>The delta_t and delta_val parameters<a class="headerlink" href="#the-delta-t-and-delta-val-parameters" title="Permalink to this headline">¶</a></h5>
<p>These two parameters have a meaning only for attribute of the
Tango::READ_WRITE and Tango::READ_WITH_WRITE read/write type and for
numerical data type. They specify if and how the RDS alarm is used. When
the attribute is read, if the difference between its read value and the
last written value is something more than or equal to the delta_val
parameter and if at least delta_val milli seconds occurs since the last
write operation, the attribute quality factor will be set to
Tango::ATTR_ALARM and if the device state is Tango::ON, it is switched
to Tango::ALARM. Even if these parameters are numbers, they are returned
as strings by the device <em>get_attribute_config()</em> call.</p>
</div>
</div>
<div class="section" id="the-event-related-configuration-parameters">
<h4>The event related configuration parameters<a class="headerlink" href="#the-event-related-configuration-parameters" title="Permalink to this headline">¶</a></h4>
<p>Six event related attribute parameters are modifiable at run-time via a
device call or via the property database.</p>
<table border="1" class="docutils">
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Parameter name</th>
<th class="head">Parameter description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>rel_change</td>
<td>Relative change triggering change event</td>
</tr>
<tr class="row-odd"><td>abs_change</td>
<td>Absolute change triggering change event</td>
</tr>
<tr class="row-even"><td>period</td>
<td>Period for periodic event</td>
</tr>
<tr class="row-odd"><td>archive_rel_change</td>
<td>Relative change for archive event</td>
</tr>
<tr class="row-even"><td>archive_abs_change</td>
<td>Absolute change for archive event</td>
</tr>
<tr class="row-odd"><td>archive_period</td>
<td>Period for change archive event</td>
</tr>
</tbody>
</table>
<div class="section" id="the-rel-change-and-abs-change-parameters">
<h5>The rel_change and abs_change parameters<a class="headerlink" href="#the-rel-change-and-abs-change-parameters" title="Permalink to this headline">¶</a></h5>
<p>Rel_change is a property with a maximum of 2 values (comma separated).
It specifies the increasing and decreasing relative change of the
attribute value (w.r.t. the value of the previous change event) which
will trigger the event. If the attribute is a spectrum or an image then
a change event is generated if any one of the attribute value’s
satisfies the above criterium. It’s the absolute value of these values
which is taken into account. If only one value is specified then it is
used for the increasing and decreasing change.</p>
<p>Abs_change is a property of maximum 2 values (comma separated). It
specifies the increasing and decreasing absolute change of the attribute
value (w.r.t the value of the previous change event) which will trigger
the event. If the attribute is a spectrum or an image then a change
event is generated if any one of the attribute value’s satisfies the
above criterium. If only one value is specified then it is used for the
increasing and decreasing change. If no values are specified then the
relative change is used.</p>
</div>
<div class="section" id="the-periodic-period-parameter">
<h5>The periodic period parameter<a class="headerlink" href="#the-periodic-period-parameter" title="Permalink to this headline">¶</a></h5>
<p>The minimum time between events (in milliseconds). If no property is
specified then a default value of 1 second is used.</p>
</div>
<div class="section" id="the-archive-rel-change-archive-abs-change-and-archive-period-parameters">
<h5>The archive_rel_change, archive_abs_change and archive_period parameters<a class="headerlink" href="#the-archive-rel-change-archive-abs-change-and-archive-period-parameters" title="Permalink to this headline">¶</a></h5>
<p>archive_rel_change is an array property of maximum 2 values which
specifies the positive and negative relative change w.r.t. the previous
attribute value which will trigger the event. If the attribute is a
spectrum or an image then an archive event is generated if any one of
the attribute value’s satisfies the above criterium. If only one
property is specified then it is used for the positive and negative
change. If no properties are specified then a default fo +-10% is used</p>
<p>archive_abs_change is an array property of maximum 2 values which
specifies the positive and negative absolute change w.r.t the previous
attribute value which will trigger the event. If the attribute is a
spectrum or an image then an archive event is generated if any one of
the attribute value’s satisfies the above criterium. If only one
property is specified then it is used for the positive and negative
change. If no properties are specified then the relative change is used.</p>
<p>archive_period is the minimum time between archive events (in
milliseconds). If no property is specified, no periodic archiving events
are send.</p>
</div>
</div>
</div>
<div class="section" id="setting-modifiable-attribute-parameters">
<h3>Setting modifiable attribute parameters<a class="headerlink" href="#setting-modifiable-attribute-parameters" title="Permalink to this headline">¶</a></h3>
<p>A default value is given to all modifiable attribute parameters by the
Tango core classes. Nevertheless, it is possible to modify these values
in source code at attribute creation time or via the database. Values
retrieved from the database have a higher priority than values given at
attribute creation time. The attribute parameters are therefore
initialized from:</p>
<ol class="arabic simple">
<li>The Database</li>
<li>If nothing in database, from the Tango class default</li>
<li>If nothing in database nor in Tango class default, from the library
default value</li>
</ol>
<p>The default value set by the Tango core library are</p>
<table border="1" class="docutils">
<colgroup>
<col width="27%" />
<col width="33%" />
<col width="39%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Parameter type</th>
<th class="head">Parameter name</th>
<th class="head">Library default value</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td rowspan="8">general purpose</td>
<td>description</td>
<td>No description</td>
</tr>
<tr class="row-odd"><td>label</td>
<td>attribute name</td>
</tr>
<tr class="row-even"><td>unit</td>
<td>One empty string</td>
</tr>
<tr class="row-odd"><td>standard_unit</td>
<td>No standard unit</td>
</tr>
<tr class="row-even"><td>display_unit</td>
<td>No display unit</td>
</tr>
<tr class="row-odd"><td>format</td>
<td>6 characters
with 2 decimal</td>
</tr>
<tr class="row-even"><td>min_value</td>
<td>Not specified</td>
</tr>
<tr class="row-odd"><td>max_value</td>
<td>Not specified</td>
</tr>
<tr class="row-even"><td rowspan="6">alarm parameters</td>
<td>min_alarm</td>
<td>Not specified</td>
</tr>
<tr class="row-odd"><td>max_alarm</td>
<td>Not specified</td>
</tr>
<tr class="row-even"><td>min_warning</td>
<td>Not specified</td>
</tr>
<tr class="row-odd"><td>max_warning</td>
<td>Not specified</td>
</tr>
<tr class="row-even"><td>&amp; delta_t</td>
<td>Not specified</td>
</tr>
<tr class="row-odd"><td>delta_val</td>
<td>Not specified</td>
</tr>
<tr class="row-even"><td rowspan="6">event parameters</td>
<td>rel_change</td>
<td>Not specified</td>
</tr>
<tr class="row-odd"><td>abs_change</td>
<td>Not specified</td>
</tr>
<tr class="row-even"><td>period</td>
<td>1000 (mS)</td>
</tr>
<tr class="row-odd"><td>archive_rel_change</td>
<td>Not specified</td>
</tr>
<tr class="row-even"><td>archive_abs_change</td>
<td>Not specified</td>
</tr>
<tr class="row-odd"><td>archive_period</td>
<td>Not specified</td>
</tr>
</tbody>
</table>
<p>It is possible to set modifiable parameters via the database at two
levels :</p>
<ol class="arabic simple">
<li>At class level</li>
<li>At device level. Each device attribute have all its modifiable
parameters sets to the value defined at class level. If the setting
defined at class level is not correct for one device, it is possible
to re-define it.</li>
</ol>
<p>If we take the example of a class called <em>BumperPowerSupply</em> with three
devices called <em>sr/bump/1</em>, <em>sr/bump/2</em> and <em>sr/bump/3</em> and one
attribute called <em>wanted_current</em>. For the first two bumpers, the
max_value is equal to 500. For the third one, the max_value is only
400. If the max_value parameter is defined at class level with the
value 500, all devices will have 500 as max_value for the
<em>wanted_current</em> attribute. It is necessary to re-defined this
parameter at device level in order to have the max_value for device
sr/bump/3 set to 400.</p>
<p>For the description, label, unit, standard_unit, display_unit and
format parameters, it is possible to return them to their default value
by setting them to an empty string.</p>
</div>
<div class="section" id="resetting-modifiable-attribute-parameters">
<h3>Resetting modifiable attribute parameters<a class="headerlink" href="#resetting-modifiable-attribute-parameters" title="Permalink to this headline">¶</a></h3>
<p>It is possible to reset attribute parameters to their default value at
any moment. This could be done via the network call available through
the DeviceProxy::set_attribute_config() method family. This call takes
attribute parameters as strings. The following table describes which
string has to be used to reset attribute parameters to their default
value. In this table, the user default are the values given within Pogo
in the Properties tab of the attribute edition window (or in in Tango
class code using the Tango::UserDefaultAttrProp class).</p>
<table border="1" class="docutils">
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Input string</th>
<th class="head">Action</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>‘Not specified’</td>
<td>Reset to <strong>library</strong> default</td>
</tr>
<tr class="row-odd"><td>‘’(empty string)</td>
<td>Reset to <strong>user</strong> default if any.
Otherwise, reset to <strong>library</strong> default</td>
</tr>
<tr class="row-even"><td>‘NaN’</td>
<td>Reset to Tango <strong>class</strong> default if any.
Otherwise, reset to <strong>user</strong> default (if any) or to <strong>library</strong>
default</td>
</tr>
</tbody>
</table>
<p>Let’s take one exemple: For one attribute belonging to a device, we have
the following attribute parameters:</p>
<table border="1" class="docutils">
<colgroup>
<col width="25%" />
<col width="25%" />
<col width="25%" />
<col width="25%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Parameter name</th>
<th class="head"><blockquote class="first last">
<div>Def. class</div></blockquote>
</th>
<th class="head"><blockquote class="first last">
<div>Def. user</div></blockquote>
</th>
<th class="head"><blockquote class="first last">
<div>Def. lib</div></blockquote>
</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>standard_unit</td>
<td>&#160;</td>
<td>&#160;</td>
<td><blockquote class="first last">
<div>No standard unit</div></blockquote>
</td>
</tr>
<tr class="row-odd"><td>min_value</td>
<td>&#160;</td>
<td><blockquote class="first last">
<div>5</div></blockquote>
</td>
<td><blockquote class="first last">
<div>Not specified</div></blockquote>
</td>
</tr>
<tr class="row-even"><td>max_value</td>
<td><blockquote class="first last">
<div>50</div></blockquote>
</td>
<td>&#160;</td>
<td><blockquote class="first last">
<div>Not specified</div></blockquote>
</td>
</tr>
<tr class="row-odd"><td>rel_change</td>
<td><blockquote class="first last">
<div>5</div></blockquote>
</td>
<td><blockquote class="first last">
<div>10</div></blockquote>
</td>
<td><blockquote class="first last">
<div>Not specified</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p>The string Not specified sent to each attribute parameter will set
attribute parameter value to No standard unit for standard_unit, Not
specified for min_value, Not specified for max_value and Not specified
as well for rel_change. The empty string sent to each attribute
parameter will result with No stanadard unit for standard_unit, 5 for
min_value, Not specified for max_value and 10 for rel_change. The
string NaN will give No standard unit for standard_unit, 5 for
min_value, 50 for max_value and 5 for rel_change.</p>
<p>C++ specific: Instead of the string Not specified and NaN, the
preprocessor define <strong>AlrmValueNotSpec</strong> and <strong>NotANumber</strong> can be used.</p>
</div>
</div>
<div class="section" id="device-pipe">
<h2>Device pipe<a class="headerlink" href="#device-pipe" title="Permalink to this headline">¶</a></h2>
<p>Pipe are configured with two kind of parameters: Parameters hard-coded
in source code and modifiable parameters</p>
<div class="section" id="hard-coded-device-pipe-parameters">
<h3>Hard-coded device pipe parameters<a class="headerlink" href="#hard-coded-device-pipe-parameters" title="Permalink to this headline">¶</a></h3>
<p>Three pipe parameters are defined at pipe creation time in the Tango
class source code. Obviously, these parameters are not modifiable except
with a new source code compilation. These parameters are</p>
<table border="1" class="docutils">
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Parameter name</th>
<th class="head">Parameter description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>name</td>
<td>Pipe name</td>
</tr>
<tr class="row-odd"><td>writable</td>
<td>Pipe read/write type</td>
</tr>
<tr class="row-even"><td>disp_level</td>
<td>Pipe display level</td>
</tr>
</tbody>
</table>
<div class="section" id="the-pipe-read-write-type">
<h4>The pipe read/write type.<a class="headerlink" href="#the-pipe-read-write-type" title="Permalink to this headline">¶</a></h4>
<p>Tango supports two kinds of read/write pipe which are :</p>
<ul class="simple">
<li>Tango::PIPE_READ for read only pipe</li>
<li>Tango::PIPE_READ_WRITE for pipe which can be read and written</li>
</ul>
</div>
<div class="section" id="the-pipe-display-level-parameter">
<h4>The pipe display level parameter<a class="headerlink" href="#the-pipe-display-level-parameter" title="Permalink to this headline">¶</a></h4>
<p>This parameter is only an help for graphical application. It is a C++
enumeration starting at 0. The code associated with each pipe display
level is defined in the following table (Tango::DispLevel).</p>
<table border="1" class="docutils">
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">name</th>
<th class="head">Value</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>Tango::OPERATOR</td>
<td>0</td>
</tr>
<tr class="row-odd"><td>Tango::EXPERT</td>
<td>1</td>
</tr>
</tbody>
</table>
<p>This parameter allows a graphical application to support two types of
operation :</p>
<ul class="simple">
<li>An operator mode for day to day operation</li>
<li>An expert mode when tuning is necessary</li>
</ul>
<p>According to this parameter, a graphical application knows if the pipe
is for the operator mode or for the expert mode.</p>
</div>
</div>
<div class="section" id="modifiable-pipe-parameters">
<h3>Modifiable pipe parameters<a class="headerlink" href="#modifiable-pipe-parameters" title="Permalink to this headline">¶</a></h3>
<p>Each pipe has a configuration set of 2 modifiable parameters. These
parameters are modifiable at run-time via a device call or via the
property database.</p>
<table border="1" class="docutils">
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Parameter name</th>
<th class="head">Parameter description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>description</td>
<td>Pipe description</td>
</tr>
<tr class="row-odd"><td>label</td>
<td>Pipe label</td>
</tr>
</tbody>
</table>
<p>The <strong>description</strong> parameter describes the pipe. The <strong>label</strong>
parameter is used by graphical application to display a label when this
pipe is used in a graphical application.</p>
</div>
<div class="section" id="setting-modifiable-pipe-parameters">
<h3>Setting modifiable pipe parameters<a class="headerlink" href="#setting-modifiable-pipe-parameters" title="Permalink to this headline">¶</a></h3>
<p>A default value is given to all modifiable pipe parameters by the Tango
core classes. Nevertheless, it is possible to modify these values in
source code at pipe creation time or via the database. Values retrieved
from the database have a higher priority than values given at pipe
creation time. The pipe parameters are therefore initialized from:</p>
<ol class="arabic simple">
<li>The Database</li>
<li>If nothing in database, from the Tango class default</li>
<li>If nothing in database nor in Tango class default, from the library
default value</li>
</ol>
<p>The default value set by the Tango core library are</p>
<table border="1" class="docutils">
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Parameter name</th>
<th class="head">Library default value</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>description</td>
<td>No description</td>
</tr>
<tr class="row-odd"><td>label</td>
<td>pipe name</td>
</tr>
</tbody>
</table>
<p>It is possible to set modifiable parameters via the database at two
levels :</p>
<ol class="arabic simple">
<li>At class level</li>
<li>At device level. Each device pipe have all its modifiable parameters
sets to the value defined at class level. If the setting defined at
class level is not correct for one device, it is possible to
re-define it.</li>
</ol>
<p>This is the same principle than the one used for attribute configuration
modifiable parameters.</p>
</div>
<div class="section" id="resetting-modifiable-pipe-parameters">
<h3>Resetting modifiable pipe parameters<a class="headerlink" href="#resetting-modifiable-pipe-parameters" title="Permalink to this headline">¶</a></h3>
<p>It is possible to reset pipe parameters to their default value at any
moment. This could be done via the network call available through the
DeviceProxy::set_pipe_config() method family. It uses the same
principle than the one used for resetting modifiable attribute pipe
parameters. Refer to their documentation if you want to know details
about this feature.</p>
</div>
</div>
<div class="section" id="device-class-parameter">
<h2>Device class parameter<a class="headerlink" href="#device-class-parameter" title="Permalink to this headline">¶</a></h2>
<p>A device documentation field is also defined at Tango device class
level. It is defined as Tango device class level because each device
belonging to a Tango device class should have the same behaviour and
therefore the same documentation. This field is store in the DeviceClass
class. It is possible to set this field via a class property. This
property name is</p>
<p>class name-&gt;doc_url</p>
<p>and is retrieved when instance of the DeviceClass object is created. A
default value is defined for this field.</p>
</div>
<div class="section" id="id1">
<h2>The device black box<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h2>
<p>This black box is a help tool to ease debugging session for a running
device server. The TANGO core software records every device request in
this black box. A tango client is able to retrieve the black box
contents with a specific CORBA operation availabble for every device.
Each black box entry is returned as a string with the following
information :</p>
<ul class="simple">
<li>The date where the request has been executed by the device. The date
format is dd/mm/yyyy hh24:mi:ss:SS (The last field is the second
hundredth number).</li>
<li>The type of CORBA requests. In case of attributes, the name of the
requested attribute is returned. In case of operation, the operation
type is returned. For “command_inout” operation, the command name is
returned.</li>
<li>The client host name</li>
</ul>
</div>
<div class="section" id="automatically-added-commands">
<h2>Automatically added commands<a class="headerlink" href="#automatically-added-commands" title="Permalink to this headline">¶</a></h2>
<p>As already mentionned in this documentation, each Tango device supports
at least three commands which are State, Status and Init. The following
array details command input and output data type</p>
<table border="1" class="docutils">
<colgroup>
<col width="33%" />
<col width="33%" />
<col width="33%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Command name</th>
<th class="head">Input data type</th>
<th class="head">Output data type</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>State</td>
<td>void</td>
<td>Tango::DevState</td>
</tr>
<tr class="row-odd"><td>Status</td>
<td>void</td>
<td>Tango::DevString</td>
</tr>
<tr class="row-even"><td>Init</td>
<td>void</td>
<td>void</td>
</tr>
</tbody>
</table>
<div class="section" id="the-state-command">
<h3>The State command<a class="headerlink" href="#the-state-command" title="Permalink to this headline">¶</a></h3>
<p>This command gets the device state (stored in its <em>device_state</em> data
member) and returns it to the caller. The device state is a variable of
the Tango_DevState type (packed into a CORBA Any object when it is
returned by a command)</p>
</div>
<div class="section" id="the-status-command">
<h3>The Status command<a class="headerlink" href="#the-status-command" title="Permalink to this headline">¶</a></h3>
<p>This command gets the device status (stored in its <em>device_status</em> data
member) and returns it to the caller. The device status is a variable of
the string type.</p>
</div>
<div class="section" id="the-init-command">
<h3>The Init command<a class="headerlink" href="#the-init-command" title="Permalink to this headline">¶</a></h3>
<p>This commands re-initialise a device keeping the same network
connection. After an Init command executed on a device, it is not
necessary for client to re-connect to the device. This command first
calls the device <em>delete_device()</em> method and then execute its
<em>init_device()</em> method. For C++ device server, all the memory allocated
in the <em>init_device()</em> method must be freed in the <em>delete_device()</em>
method. The language device desctructor automatically calls the
<em>delete_device()</em> method.</p>
</div>
</div>
<div class="section" id="dserver-class-device-commands">
<span id="id2"></span><h2>DServer class device commands<a class="headerlink" href="#dserver-class-device-commands" title="Permalink to this headline">¶</a></h2>
<p>As already explained in [DServer_class], each device server process has
its own Tango device. This device supports the three commands previously
described plus 32 commands which are DevRestart, RestartServer,
QueryClass, QueryDevice, Kill, QueryWizardClassProperty,
QueryWizardDevProperty, QuerySubDevice, the polling related commands
which are StartPolling, StopPolling, AddObjPolling, RemObjPolling,
UpdObjPollingPeriod, PolledDevice and DevPollStatus, the device locking
related commands which are LockDevice, UnLockDevice, ReLockDevices and
DevLockStatus, the event related commands called
EventSubscriptionChange, ZmqEventSubscriptionChange and
EventConfirmSubscription and finally the logging related commands which
are AddLoggingTarget, RemoveLoggingTarget, GetLoggingTarget,
GetLoggingLevel, SetLoggingLevel, StopLogging and StartLogging. The
following table give all commands input and output data types</p>
<table border="1" class="docutils">
<colgroup>
<col width="33%" />
<col width="33%" />
<col width="33%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Command name</th>
<th class="head">Input data type</th>
<th class="head">Output data type</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>State</td>
<td>void</td>
<td>Tango::DevState</td>
</tr>
<tr class="row-odd"><td>Status</td>
<td>void</td>
<td>Tango::DevString</td>
</tr>
<tr class="row-even"><td>Init</td>
<td>void</td>
<td>void</td>
</tr>
<tr class="row-odd"><td>DevRestart</td>
<td>Tango::DevString</td>
<td>void</td>
</tr>
<tr class="row-even"><td>RestartServer</td>
<td>void</td>
<td>void</td>
</tr>
<tr class="row-odd"><td>QueryClass</td>
<td>void</td>
<td>Tango::DevVarStringArray</td>
</tr>
<tr class="row-even"><td>QueryDevice</td>
<td>void</td>
<td>Tango::DevVarStringArray</td>
</tr>
<tr class="row-odd"><td>Kill</td>
<td>void</td>
<td>void</td>
</tr>
<tr class="row-even"><td>QueryWizardClassProperty</td>
<td>Tango::DevString</td>
<td>Tango::DevVarStringArray</td>
</tr>
<tr class="row-odd"><td>QueryWizardDevProperty</td>
<td>Tango::DevString</td>
<td>Tango::DevVarStringArray</td>
</tr>
<tr class="row-even"><td>QuerySubDevice</td>
<td>void</td>
<td>Tango::DevVarStringArray</td>
</tr>
<tr class="row-odd"><td>StartPolling</td>
<td>void</td>
<td>void</td>
</tr>
<tr class="row-even"><td>StopPolling</td>
<td>void</td>
<td>void</td>
</tr>
<tr class="row-odd"><td>AddObjPolling</td>
<td>Tango::DevVarLongStringArray</td>
<td>void</td>
</tr>
<tr class="row-even"><td>RemObjPolling</td>
<td>Tango::DevVarStringArray</td>
<td>void</td>
</tr>
<tr class="row-odd"><td>UpdObjPollingPeriod</td>
<td>Tango::DevVarLongStringArray</td>
<td>void</td>
</tr>
<tr class="row-even"><td>PolledDevice</td>
<td>void</td>
<td>Tango::DevVarStringArray</td>
</tr>
<tr class="row-odd"><td>DevPollStatus</td>
<td>Tango::DevString</td>
<td>Tango::DevVarStringArray</td>
</tr>
<tr class="row-even"><td>LockDevice</td>
<td>Tango::DevVarLongStringArray</td>
<td>void</td>
</tr>
<tr class="row-odd"><td>UnLockDevice</td>
<td>Tango::DevVarLongStringArray</td>
<td>Tango::DevLong</td>
</tr>
<tr class="row-even"><td>ReLockDevices</td>
<td>Tango::DevVarStringArray</td>
<td>void</td>
</tr>
<tr class="row-odd"><td>DevLockStatus</td>
<td>Tango::DevString</td>
<td>Tango::DevVarLongStringArray</td>
</tr>
<tr class="row-even"><td>EventSubscribeChange</td>
<td>Tango::DevVarStringArray</td>
<td>Tango::DevLong</td>
</tr>
<tr class="row-odd"><td>ZmqEventSubscriptionChange</td>
<td>Tango::DevVarStringArray</td>
<td>Tango::DevVarLongStringArray</td>
</tr>
<tr class="row-even"><td>EventConfirmSubscription</td>
<td>Tango::DevVarStringArray</td>
<td>void</td>
</tr>
<tr class="row-odd"><td>AddLoggingTarget</td>
<td>Tango::DevVarStringArray</td>
<td>void</td>
</tr>
<tr class="row-even"><td>RemoveLoggingTarget</td>
<td>Tango::DevVarStringArray</td>
<td>void</td>
</tr>
<tr class="row-odd"><td>GetLoggingTarget</td>
<td>Tango::DevString</td>
<td>Tango::DevVarStringArray</td>
</tr>
<tr class="row-even"><td>GetLoggingLevel</td>
<td>Tango::DevVarStringArray</td>
<td>Tango::DevVarLongStringArray</td>
</tr>
<tr class="row-odd"><td>SetLoggingLevel</td>
<td>Tango::DevVarLongStringArray</td>
<td>void</td>
</tr>
<tr class="row-even"><td>StopLogging</td>
<td>void</td>
<td>void</td>
</tr>
<tr class="row-odd"><td>StartLogging</td>
<td>void</td>
<td>void</td>
</tr>
</tbody>
</table>
<p>The device description field is set to “A device server device”. Device
server started with the -file command line option also supports a
command called QueryEventChannelIOR. This command is used interanally by
the Tango kernel classes when the event system is used with device
server using database on file.</p>
<div class="section" id="id3">
<h3>The State command<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h3>
<p>This device state is always set to ON</p>
</div>
<div class="section" id="id4">
<h3>The Status command<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h3>
<p>This device status is always set to “The device is ON” followed by a new
line character and a string describing polling thread status. This
string is either “The polling is OFF” or “The polling is ON” according
to polling state.</p>
</div>
<div class="section" id="the-devrestart-command">
<h3>The DevRestart command<a class="headerlink" href="#the-devrestart-command" title="Permalink to this headline">¶</a></h3>
<p>The DevRestart command restart a device. The name of the device to be
re-started is the command input parameter. The command destroys the
device by calling its destructor and re-create it from its constructor.</p>
</div>
<div class="section" id="the-restartserver-command">
<h3>The RestartServer command<a class="headerlink" href="#the-restartserver-command" title="Permalink to this headline">¶</a></h3>
<p>The DevRestartServer command restarts all the device pattern(s) embedded
in the device server process. Therefore, all the devices implemented in
the server process are destroyed and re-built <a class="footnote-reference" href="#id7" id="id5">[1]</a>. The network
connection between client(s) and device(s) implemented in the device
server process is destroyed and re-built.</p>
<p>Executing this command allows a complete restart of the device server
without stopping the process.</p>
</div>
<div class="section" id="the-queryclass-command">
<h3>The QueryClass command<a class="headerlink" href="#the-queryclass-command" title="Permalink to this headline">¶</a></h3>
<p>This command returns to the client the list of Tango device class(es)
embedded in the device server. It returns only class(es) implemented by
the device server programmer. The DServer device class name (implemented
by the TANGO core software) is not returned by this command.</p>
</div>
<div class="section" id="the-querydevice-command">
<h3>The QueryDevice command<a class="headerlink" href="#the-querydevice-command" title="Permalink to this headline">¶</a></h3>
<p>This command returns to the client the list of device name for all the
device(s) implemented in the device server process. Each device name is
returned using the following syntax :</p>
<p>&lt;class name&gt;::&lt;device name&gt;</p>
<p>The name of the DServer class device is not returned by this command.</p>
</div>
<div class="section" id="the-kill-command">
<h3>The Kill command<a class="headerlink" href="#the-kill-command" title="Permalink to this headline">¶</a></h3>
<p>This command stops the device server process. In order that the client
receives a last answer from the server, this command starts a thread
which will after a short delay, kills the device server process.</p>
</div>
<div class="section" id="the-querywizardclassproperty-command">
<h3>The QueryWizardClassProperty command<a class="headerlink" href="#the-querywizardclassproperty-command" title="Permalink to this headline">¶</a></h3>
<p>This command returns the list of property(ies) defined for a class
stored in the device server process property wizard. For each property,
its name, a description and a default value is returned.</p>
</div>
<div class="section" id="the-querywizarddevproperty-command">
<h3>The QueryWizardDevProperty command<a class="headerlink" href="#the-querywizarddevproperty-command" title="Permalink to this headline">¶</a></h3>
<p>This command returns the list of property(ies) defined for a device
stored in the device server process property wizard. For each property,
its name, a description and a default value is returned.</p>
</div>
<div class="section" id="the-querysubdevice-command">
<h3>The QuerySubDevice command<a class="headerlink" href="#the-querysubdevice-command" title="Permalink to this headline">¶</a></h3>
<p>This command returns the list of sub-device(s) imported by each device
within the server. A sub-device is a device used ( to execute command(s)
and/or to read/write attribute(s) ) by one of the device server process
devices. There is one element in the returned strings array for each
sub-device. The syntax of each string is the device name, a space and
the sub-device name. In case of device server process starting threads
using a sub-device, it is not possible to link this sub-device to any
process devices. In such a case, the string contains only the sub-device
name</p>
</div>
<div class="section" id="the-startpolling-command">
<h3>The StartPolling command<a class="headerlink" href="#the-startpolling-command" title="Permalink to this headline">¶</a></h3>
<p>This command starts the polling thread</p>
</div>
<div class="section" id="the-stoppolling-command">
<h3>The StopPolling command<a class="headerlink" href="#the-stoppolling-command" title="Permalink to this headline">¶</a></h3>
<p>This command stops the polling thread</p>
</div>
<div class="section" id="the-addobjpolling-command">
<h3>The AddObjPolling command<a class="headerlink" href="#the-addobjpolling-command" title="Permalink to this headline">¶</a></h3>
<p>This command adds a new object in the list of object(s) to be polled.
The command input parameters are embedded within a
Tango::DevVarLongStringArray data type with one long data and three
strings. The input parameters are:</p>
<table border="1" class="docutils">
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Command parameter</th>
<th class="head">Parameter meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>svalue[0]</td>
<td>Device name</td>
</tr>
<tr class="row-odd"><td>svalue[1]</td>
<td>Object type (“command“ or “attribute“)</td>
</tr>
<tr class="row-even"><td>svalue[2]</td>
<td>Object name</td>
</tr>
<tr class="row-odd"><td>lvalue[0]</td>
<td>polling period in mS</td>
</tr>
</tbody>
</table>
<p>The object type string is case independent. The object name string
(command name or attribute name) is case dependant. This command does
not start polling if it is stopped. This command is not allowed in case
the device is locked and the command requester is not the lock owner.</p>
</div>
<div class="section" id="the-remobjpolling-command">
<h3>The RemObjPolling command<a class="headerlink" href="#the-remobjpolling-command" title="Permalink to this headline">¶</a></h3>
<p>This command removes an object of the list of polled objects. The
command input data type is a Tango::DevVarStringArray with three
strings. These strings meaning are :</p>
<table border="1" class="docutils">
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">String</th>
<th class="head">Meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>string[0]</td>
<td>Device name</td>
</tr>
<tr class="row-odd"><td>string[1]</td>
<td>Object type (“command“ or “attribute“)</td>
</tr>
<tr class="row-even"><td>string[2]</td>
<td>Object name</td>
</tr>
</tbody>
</table>
<p>The object type string is case independent. The object name string
(command name or attribute name) is case dependant. This command is not
allowed in case the device is locked and the command requester is not
the lock owner.</p>
</div>
<div class="section" id="the-updobjpollingperiod-command">
<h3>The UpdObjPollingPeriod command<a class="headerlink" href="#the-updobjpollingperiod-command" title="Permalink to this headline">¶</a></h3>
<p>This command changes the polling period for a specified object. The
command input parameters are embedded within a
Tango::DevVarLongStringArray data type with one long data and three
strings. The input parameters are:</p>
<table border="1" class="docutils">
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Command parameter</th>
<th class="head">Parameter meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>svalue[0]</td>
<td>Device name</td>
</tr>
<tr class="row-odd"><td>svalue[1]</td>
<td>Object type (“command“ or “attribute“)</td>
</tr>
<tr class="row-even"><td>svalue[2]</td>
<td>Object name</td>
</tr>
<tr class="row-odd"><td>lvalue[0]</td>
<td>new polling period in mS</td>
</tr>
</tbody>
</table>
<p>The object type string is case independent. The object name string
(command name or attribute name) is case dependant. This command does
not start polling if it is stopped. This command is not allowed in case
the device is locked and the command requester is not the lock owner.</p>
</div>
<div class="section" id="the-polleddevice-command">
<h3>The PolledDevice command<a class="headerlink" href="#the-polleddevice-command" title="Permalink to this headline">¶</a></h3>
<p>This command returns the name of device which are polled. Each string in
the Tango::DevVarStringArray returned by the command is a device name
which has at least one command or attribute polled. The list is
alphabetically sorted.</p>
</div>
<div class="section" id="the-devpollstatus-command">
<h3>The DevPollStatus command<a class="headerlink" href="#the-devpollstatus-command" title="Permalink to this headline">¶</a></h3>
<p>This command returns a polling status for a specific device. The input
parameter is a device name. Each string in the Tango::DevVarStringArray
returned by the command is the polling status for each polled device
objects (command or attribute). For each polled objects, the polling
status is :</p>
<ul class="simple">
<li>The object name</li>
<li>The object polling period (in mS)</li>
<li>The object polling ring buffer depth</li>
<li>The time needed (in mS) for the last command execution or attribute
reading</li>
<li>The time since data in the ring buffer has not been updated. This
allows a check of the polling thread</li>
<li>The delta time between the last records in the ring buffer. This
allows checking that the polling period is respected by the polling
thread.</li>
<li>The exception parameters in case of the last command execution or the
last attribute reading failed.</li>
</ul>
<p>A new line character is inserted between each piece of information.</p>
</div>
<div class="section" id="the-lockdevice-command">
<h3>The LockDevice command<a class="headerlink" href="#the-lockdevice-command" title="Permalink to this headline">¶</a></h3>
<p>This command locks a device for the calling process. The command input
parameters are embedded within a Tango::DevVarLongStringArray data type
with one long data and one string. The input parameters are:</p>
<table border="1" class="docutils">
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Command parameter</th>
<th class="head">Parameter meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>svalue[0]</td>
<td>Device name</td>
</tr>
<tr class="row-odd"><td>lvalue[0]</td>
<td>Lock validity</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="the-unlockdevice-command">
<h3>The UnLockDevice command<a class="headerlink" href="#the-unlockdevice-command" title="Permalink to this headline">¶</a></h3>
<p>This command unlocks a device. The command input parameters are embedded
within a Tango::DevVarLongStringArray data type with one long data and
one string. The input parameters are:</p>
<table border="1" class="docutils">
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Command parameter</th>
<th class="head">Parameter meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>svalue[0]</td>
<td>Device name</td>
</tr>
<tr class="row-odd"><td>lvalue[0]</td>
<td>Force flag</td>
</tr>
</tbody>
</table>
<p>The force flag parameter allows a client to unlock a device already
locked by another process (for admin usage only)</p>
</div>
<div class="section" id="the-relockdevices-command">
<h3>The ReLockDevices command<a class="headerlink" href="#the-relockdevices-command" title="Permalink to this headline">¶</a></h3>
<p>This command re-lock devices. The input argument is the list of devices
to be re-locked. It’s an error to re-lock a device which is not already
locked.</p>
</div>
<div class="section" id="the-devlockstatus-command">
<h3>The DevLockStatus command<a class="headerlink" href="#the-devlockstatus-command" title="Permalink to this headline">¶</a></h3>
<p>This command returns a device locking status to the caller. Its input
parameter is the device name. The output parameters are embedded within
a Tango::DevVarLongStringArray data type with three strings and six
long. These data are</p>
<table border="1" class="docutils">
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Command parameter</th>
<th class="head">Parameter meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>svalue[0]</td>
<td>Locking string</td>
</tr>
<tr class="row-odd"><td>svalue[1]</td>
<td>CPP client host IP address or Not defined</td>
</tr>
<tr class="row-even"><td>svalue[2]</td>
<td>Java VM main class for Java client or Not defined</td>
</tr>
<tr class="row-odd"><td>lvalue[0]</td>
<td>Lock flag (1 if locked, 0 othterwise)</td>
</tr>
<tr class="row-even"><td>lvalue[1]</td>
<td>CPP client host IP address or 0 for Java locker</td>
</tr>
<tr class="row-odd"><td>lvalue[2]</td>
<td>Java locker UUID part 1or 0 for CPP locker</td>
</tr>
<tr class="row-even"><td>lvalue[3]</td>
<td>Java locker UUID part 2 or 0 for CPP locker</td>
</tr>
<tr class="row-odd"><td>lvalue[4]</td>
<td>Java locker UUID part 3 or 0 for CPP locker</td>
</tr>
<tr class="row-even"><td>lvalue[5]</td>
<td>Java locker UUID part 4 or 0 for CPP locker</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="the-eventsubscriptionchange-command-c-server-only">
<h3>The EventSubscriptionChange command (C++ server only)<a class="headerlink" href="#the-eventsubscriptionchange-command-c-server-only" title="Permalink to this headline">¶</a></h3>
<p>This command is used as a piece of the heartbeat system between an event
client and the device server generating the event. There is no reason to
generate events if there is no client which has subscribed to it. It is
used by the <em>DeviceProxy::subscribe_event()</em> method and one of the
event thread on the client side to inform the server to keep on
generating events for the attribute in question. It reloads the
subscription timer with the current time. Events are not generated when
there are no clients subscribed within the last 10 minutes. The input
parameters are:</p>
<table border="1" class="docutils">
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Command parameter</th>
<th class="head">Parameter meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>argin[0]</td>
<td>Device name</td>
</tr>
<tr class="row-odd"><td>argin[1]</td>
<td>Attribute name</td>
</tr>
<tr class="row-even"><td>argin[2]</td>
<td>action (subscribe or unsubsribe)</td>
</tr>
<tr class="row-odd"><td>argin[3]</td>
<td>event name (change, periodic, archive,attr_conf)</td>
</tr>
</tbody>
</table>
<p>The command output data is the simply the Tango release used by the
device server process. This is necessary for compatibility reason.</p>
</div>
<div class="section" id="the-zmqeventsubscriptionchange-command">
<h3>The ZmqEventSubscriptionChange command<a class="headerlink" href="#the-zmqeventsubscriptionchange-command" title="Permalink to this headline">¶</a></h3>
<p>This command is used as a piece of the heartbeat system between an event
client and the device server generating the event when client and/or
device server uses Tango release 8 or above. There is no reason to
generate events if there is no client which has subscribed to it. It is
used by the <em>DeviceProxy::subscribe_event()</em> method and one of the
event thread on the client side to inform the server to keep on
generating events for the attribute in question. It reloads the
subscription timer with the current time. Events are not generated when
there are no clients subscribed within the last 10 minutes. The input
parameters are the same than the one used for the
EventSubscriptionChange command. They are:</p>
<table border="1" class="docutils">
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Command in parameter</th>
<th class="head">Parameter meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>argin[0]</td>
<td>Device name</td>
</tr>
<tr class="row-odd"><td>argin[1]</td>
<td>Attribute name</td>
</tr>
<tr class="row-even"><td>argin[2]</td>
<td>action (subscribe or unsubsribe)</td>
</tr>
<tr class="row-odd"><td>argin[3]</td>
<td>event name (change, periodic, archive,attr_conf)</td>
</tr>
</tbody>
</table>
<p>The command output parameters aer all the necessary data to build one
event connection between a client and the device server process
generating the events. This means:</p>
<table border="1" class="docutils">
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Command out parameter</th>
<th class="head">Parameter meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>svalue[0]</td>
<td>Heartbeat ZMQ socket connect end point</td>
</tr>
<tr class="row-odd"><td>svalue[1]</td>
<td>Event ZMQ socket connect end point</td>
</tr>
<tr class="row-even"><td>lvalue[0]</td>
<td>Tango lib release used by device server</td>
</tr>
<tr class="row-odd"><td>lvalue[1]</td>
<td>Device IDL release</td>
</tr>
<tr class="row-even"><td>lvalue[2]</td>
<td>Subscriber HWM</td>
</tr>
<tr class="row-odd"><td>lvalue[3]</td>
<td>Rate (Multicasting related)</td>
</tr>
<tr class="row-even"><td>lvalue[4]</td>
<td>IVL (Multicasting related)</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="the-eventconfirmsubscription-command">
<h3>The EventConfirmSubscription command<a class="headerlink" href="#the-eventconfirmsubscription-command" title="Permalink to this headline">¶</a></h3>
<p>This command is used by client to regularly notify to device server
process their interest in receiving events. If this command is not
received, after a delay of 600 sec (10 mins), event(s) will not be sent
any more. The input parameters for the EventConfirmSubscription command
must be a multiple of 3. They are 3 parameters for each event confirmed
by this command. Per event, these parameters are:</p>
<table border="1" class="docutils">
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Command in parameter</th>
<th class="head">Parameter meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>argin[x]</td>
<td>Device name</td>
</tr>
<tr class="row-odd"><td>argin[x + 1]</td>
<td>Attribute name</td>
</tr>
<tr class="row-even"><td>argin[x + 2]</td>
<td>Event name</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="the-addloggingtarget-command">
<h3>The AddLoggingTarget command<a class="headerlink" href="#the-addloggingtarget-command" title="Permalink to this headline">¶</a></h3>
<p>This command adds one (or more) logging target(s) to the specified
device(s). The command input parameter is an array of string logically
composed of {device_name, target_type::target_name} groups where the
elements have the following semantic:</p>
<ul class="simple">
<li>device_name is the name of the device which logging behavior is to
be controlled. The wildcard is supported to apply the modification to
all devices encapsulated within the device server (e.g. to ask all
devices to log to the same device target).</li>
<li>target_type::target_name: target_type is one of the supported
target types and target_name, the name of the target. Supported
target types are: <em>console</em>, <em>file</em> and <em>device</em>. For a device
target, target_name must contain the name of a log consumer device
(as defined in [sec:Tango-log-consumer]). For a file target,
target_name is the full path to the file to log to. If omitted the
device’s name is used to build the file name
(domain_family_member.log). Finally, target_name is ignored in the
case of a console target and can be omitted.</li>
</ul>
<p>This command is not allowed in case the device is locked and the command
requester is not the lock owner.</p>
</div>
<div class="section" id="the-removeloggingtarget-command">
<h3>The RemoveLoggingTarget command<a class="headerlink" href="#the-removeloggingtarget-command" title="Permalink to this headline">¶</a></h3>
<p>Remove one (or more) logging target(s) from the specified device(s).The
command input parameter is an array of string logically composed of
{device_name, target_type::target_name} groups where the elements
have the following semantic:</p>
<ul class="simple">
<li>device_name: the name of the device which logging behavior is to be
controlled. The wildcard is supported to apply the modification to
all devices encapsulated within the device server (e.g. to ask all
devices to stop logging to a given device target).</li>
<li>target_type::target_name: target_type is one of the supported
target types and target_name, the name of the target. Supported
target types are: <em>console</em>, <em>file</em> and <em>device</em>. For a device
target, target_name must contain the name of a log consumer device
(as defined in [sec:Tango-log-consumer]). For a file target,
target_name is the full path to the file to log to. If omitted the
device’s name is used to build the file name
(domain_family_member.log). Finally, target_name is ignored in the
case of a console target and can be omitted.</li>
</ul>
<p>The wildcard is supported for target_name. For instance,
RemoveLoggingTarget ([, device::*) removes all the device targets from
all the devices running in the device server. This command is not
allowed in case the device is locked and the command requester is not
the lock owner.</p>
</div>
<div class="section" id="the-getloggingtarget-command">
<h3>The GetLoggingTarget command<a class="headerlink" href="#the-getloggingtarget-command" title="Permalink to this headline">¶</a></h3>
<p>Returns the current target list of the specified device. The command
parameter device_name is the name of the device which logging target
list is requested. The list is returned as a DevVarStringArray
containing target_type::target_name elements.</p>
</div>
<div class="section" id="the-getlogginglevel-command">
<h3>The GetLoggingLevel command<a class="headerlink" href="#the-getlogginglevel-command" title="Permalink to this headline">¶</a></h3>
<p>Returns the logging level of the specified devices. The command input
parameter device_list contains the names of the devices which logging
target list is requested. The wildcard is supported to get the logging
level of all the devices running within the server. The string part of
the result contains the name of the devices and its long part contains
the levels. Obviously, result.lvalue[i] is the current logging level of
the device named result.svalue[i].</p>
</div>
<div class="section" id="the-setlogginglevel-command">
<h3>The SetLoggingLevel command<a class="headerlink" href="#the-setlogginglevel-command" title="Permalink to this headline">¶</a></h3>
<p>Changes the logging level of the specified devices. The string part of
the command input parameter contains the device names while its long
part contains the logging levels. The set of possible values for levels
is: 0=OFF, 1=FATAL, 2=ERROR, 3=WARNING, 4=INFO, 5=DEBUG.</p>
<p>The wildcard is supported to assign all devices the same logging level.
For instance, SetLoggingLevel ([3]) set the logging level of all the
devices running within the server to WARNING. This command is not
allowed in case the device is locked and the command requester is not
the lock owner.</p>
</div>
<div class="section" id="the-stoplogging-command">
<h3>The StopLogging command<a class="headerlink" href="#the-stoplogging-command" title="Permalink to this headline">¶</a></h3>
<p>For all the devices running within the server, StopLogging saves their
current logging level and set their logging level to OFF.</p>
</div>
<div class="section" id="the-startlogging-command">
<h3>The StartLogging command<a class="headerlink" href="#the-startlogging-command" title="Permalink to this headline">¶</a></h3>
<p>For each device running within the server, StartLogging restores their
logging level to the value stored during a previous StopLogging call.</p>
</div>
</div>
<div class="section" id="dserver-class-device-properties">
<h2>DServer class device properties<a class="headerlink" href="#dserver-class-device-properties" title="Permalink to this headline">¶</a></h2>
<p>This device has two properties related to polling threads pool
management plus another one for the choice of polling algorithm. These
properties are described in the following table</p>
<table border="1" class="docutils">
<colgroup>
<col width="33%" />
<col width="33%" />
<col width="33%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Property name</th>
<th class="head">property rule</th>
<th class="head">default value</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>polling_threads_pool_size</td>
<td>Max number of thread in the polling pool</td>
<td>1</td>
</tr>
<tr class="row-odd"><td>polling_threads_pool_conf</td>
<td>Polling threads pool configuration</td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td>polling_before_9</td>
<td>Choice of the polling algorithm</td>
<td>false</td>
</tr>
</tbody>
</table>
<p>The rule of the polling_threads_pool_size is to define the maximun
number of thread created for the polling threads pool size. The rule of
the polling_threads_pool_conf is to define which thread in the pool
is in charge of all the polled object(s) of which device. This property
is an array of strings with one string per used thread in the pool. The
content of the string is simply a device name list with device name
splitted by a comma. Example of polling_threads_pool_conf property
for 3 threads used:</p>
<pre class="code cpp literal-block">
<span class="ln">1 </span>  <span class="name">dserver</span><span class="operator">/&lt;</span><span class="name">ds</span> <span class="name">exec</span> <span class="name">name</span><span class="operator">&gt;/&lt;</span><span class="name">inst</span><span class="punctuation">.</span> <span class="name">name</span><span class="operator">&gt;/</span><span class="name">polling_threads_pool_conf</span><span class="operator">-&gt;</span> <span class="name">the</span><span class="operator">/</span><span class="name">dev</span><span class="operator">/</span><span class="literal number oct">01</span>
<span class="ln">2 </span>                    <span class="name">the</span><span class="operator">/</span><span class="name">dev</span><span class="operator">/</span><span class="literal number oct">02</span><span class="punctuation">,</span><span class="name">the</span><span class="operator">/</span><span class="name">dev</span><span class="operator">/</span><span class="literal number oct">06</span>
<span class="ln">3 </span>                    <span class="name">the</span><span class="operator">/</span><span class="name">dev</span><span class="operator">/</span><span class="literal number oct">03</span>
</pre>
<p>Thread number 2 is in charge of 2 devices. Note that there is an entry
in this list only for the used threads in the pool.</p>
<p>The rule of the polling_before_9 property is to select the polling
algorithm which was used in Tango device server process before Tango
release 9.</p>
</div>
<div class="section" id="tango-log-consumer">
<h2>Tango log consumer<a class="headerlink" href="#tango-log-consumer" title="Permalink to this headline">¶</a></h2>
<div class="section" id="the-available-log-consumer">
<h3>The available Log Consumer<a class="headerlink" href="#the-available-log-consumer" title="Permalink to this headline">¶</a></h3>
<p>One implementation of a log consumer associated to a graphical user
interface is available within Tango. It is a standalone java application
called <strong>LogViewer</strong> based on the publicly available chainsaw
application from the log4j package. It supports two way of running which
are:</p>
<ul class="simple">
<li>The static mode: In this mode, LogViewer is started with a parameter
which is the name of the log consumer device implemented by the
application. All messages sent by devices with a logging target type
set to <em>device</em> and with a logging target name set to the same device
name than the device name passed as application parameter will be
displayed (if the logging level allows it).</li>
<li>The dynamic mode: In this mode, the name of the log consumer device
implemented by the application is build at application startup and is
dynamic. The user with the help of the graphical interface chooses
device(s) for which he want to see log messages.</li>
</ul>
</div>
<div class="section" id="the-log-consumer-interface">
<h3>The Log Consumer interface<a class="headerlink" href="#the-log-consumer-interface" title="Permalink to this headline">¶</a></h3>
<p>A Tango Log Consumer device is nothing but a tango device supporting the
following tango command :</p>
<p>void log (Tango::DevVarStringArray details)</p>
<p>where details is an array of string carrying the log details. Its
structure is:</p>
<ul class="simple">
<li>details[0] : the timestamp in millisecond since epoch (01.01.1970)</li>
<li>details[1] : the log level</li>
<li>details[2] : the log source (i.e. device name)</li>
<li>details[3] : the log message</li>
<li>details[4] : the log NDC (contextual info) - Not used but reserved</li>
<li>details[5] : the thread identifier (i.e. the thread from which the
log request comes from)</li>
</ul>
<p>These log details can easily be extended. Any tango device supporting
this command can act as a device target for other devices.</p>
</div>
</div>
<div class="section" id="control-system-specific">
<h2>Control system specific<a class="headerlink" href="#control-system-specific" title="Permalink to this headline">¶</a></h2>
<p>It is possible to define a few control system parameters. By control
system, we mean for each set of computers having the same database
device server (the same TANGO_HOST environment variable)</p>
<div class="section" id="the-device-class-documentation-default-value">
<h3>The device class documentation default value<a class="headerlink" href="#the-device-class-documentation-default-value" title="Permalink to this headline">¶</a></h3>
<p>Each control system may have it’s own default device class documentation
value. This is defined via a class property. The property name is</p>
<p>Default-&gt;doc_url</p>
<p>It’s retrieved if the device class itself does not define any doc_url
property. If the Default-&gt;doc_url property is also not defined, a
hard-coded default value is provided.</p>
</div>
<div class="section" id="the-services-definition">
<h3>The services definition<a class="headerlink" href="#the-services-definition" title="Permalink to this headline">¶</a></h3>
<p>The property used to defined control system services is named
<strong>Services</strong> and belongs to the free object <strong>CtrlSystem</strong>. This
property is an array of strings. Each string defines a service available
within the control system. The syntax of each service definition is</p>
<p>Service name/Instance name:service device name</p>
</div>
<div class="section" id="tuning-the-event-system-buffers-hwm">
<h3>Tuning the event system buffers (HWM)<a class="headerlink" href="#tuning-the-event-system-buffers-hwm" title="Permalink to this headline">¶</a></h3>
<p>Starting with Tango release 8, ZMQ is used for the event based
communication between clients and device server processes. ZMQ
implementation provides asynchronous communication in the sense that the
data to be transmitted is first stored in a buffer and then really sent
on the network by dedicated threads. The size of this buffers (on client
and device server side) is called High Water Mark (HWM) and is tunable.
This is tunable at several level.</p>
<ol class="arabic simple">
<li>The library set a default value of <strong>1000</strong> for both buffers (client
and device server side)</li>
<li>Control system properties used to tune these size are named
<strong>DSEventBufferHwm</strong> (device server side) and <strong>EventBufferHwm</strong>
(client side). They both belongs to the free object <strong>CtrlSystem</strong>.
Each property is the max number of events storable in these buffer.</li>
<li>At client or device server level using the library calls
<em>Util::set_ds_event_buffer_hwm()</em> documented in
<a class="reference internal" href="../../reference/bibliography.html#tangorefman" id="id6">[TangoRefMan]</a> or
<em>ApiUtil::set_event_buffer_hwm()</em> documented in
<code class="xref cpp cpp-class docutils literal"><span class="pre">Tango::ApiUtil</span></code></li>
<li>Using environment variables TANGO_DS_EVENT_BUFFER_HWM or
TANGO_EVENT_BUFFER_HWM</li>
</ol>
</div>
<div class="section" id="allowing-nan-when-writing-attributes-floating-point">
<h3>Allowing NaN when writing attributes (floating point)<a class="headerlink" href="#allowing-nan-when-writing-attributes-floating-point" title="Permalink to this headline">¶</a></h3>
<p>A property named <strong>WAttrNaNAllowed</strong> belonging to the free object
<strong>CtrlSystem</strong> allows a Tango control system administrator to allow or
disallow NaN numbers when writing attributes of the DevFloat or
DevDouble data type. This is a boolean property and by default, it’s
value is taken as false (Meaning NaN values are rejected).</p>
</div>
<div class="section" id="tuning-multicasting-event-propagation">
<h3>Tuning multicasting event propagation<a class="headerlink" href="#tuning-multicasting-event-propagation" title="Permalink to this headline">¶</a></h3>
<p>Starting with Tango 8.1, it is possible to transfer event(s) between
devices and clients using a multicast protocol. The properties
<strong>MulticastEvent</strong>, <strong>MulticastRate</strong>, <strong>MulticastIvl</strong> and
<strong>MulticastHops</strong> also belonging to the free object <strong>CtrlSystem</strong> allow
the user to configure which events has to be sent using multicasting and
with which parameters. See chapter Advanced features/Using multicast
protocol to transfer events to get details about these properties.</p>
</div>
<div class="section" id="summary-of-ctrlsystem-free-object-properties">
<h3>Summary of CtrlSystem free object properties<a class="headerlink" href="#summary-of-ctrlsystem-free-object-properties" title="Permalink to this headline">¶</a></h3>
<p>The following table summarizes properties defined at control system
level and belonging to the free object CtrlSystem</p>
<dl class="docutils">
<dt>|c|c|c| Property name &amp; property rule &amp; default value</dt>
<dd>Services &amp; List of defined services &amp; No default
DsEventBufferHwm &amp; DS event buffer high water mark &amp; 1000
EventBufferHwm &amp; Client event buffer high water mark &amp; 1000
WAttrNaNAllowed &amp; Allow NaN when writing attr. &amp; false
MulticastEvent &amp; List of multicasting events &amp; No default
MulticastRate &amp; Rate for multicast event transport &amp; 80
MulticastIvl &amp; Time to keep data for re-transmission &amp; 20
MulticastHops &amp; Max number of eleemnts to cross &amp; 5</dd>
</dl>
</div>
</div>
<div class="section" id="c-specific">
<h2>C++ specific<a class="headerlink" href="#c-specific" title="Permalink to this headline">¶</a></h2>
<div class="section" id="the-tango-master-include-file-tango-h">
<h3>The Tango master include file (tango.h)<a class="headerlink" href="#the-tango-master-include-file-tango-h" title="Permalink to this headline">¶</a></h3>
<p>Tango has a master include file called</p>
<p>tango.h</p>
<p>This master include file includes the following files :</p>
<ul class="simple">
<li>Tango configuration include file : <strong>tango_config.h</strong></li>
<li>CORBA include file : <strong>idl/tango.h</strong></li>
<li>Some network include files for WIN32 : <strong>winsock2.h</strong> and
<strong>mswsock.h</strong></li>
<li>C++ streams include file :<ul>
<li><strong>iostream</strong>, <strong>sstream</strong> and <strong>fstream</strong></li>
</ul>
</li>
<li>Some standard C++ library include files : <strong>memory, string</strong> and
<strong>vector</strong></li>
<li>A long list of other Tango include files</li>
</ul>
</div>
<div class="section" id="tango-specific-pre-processor-define">
<h3>Tango specific pre-processor define<a class="headerlink" href="#tango-specific-pre-processor-define" title="Permalink to this headline">¶</a></h3>
<p>The tango.h previously described also defined some pre-processor macros
allowing Tango release to be checked at compile time. These macros are:</p>
<ul class="simple">
<li>TANGO_VERSION_MAJOR</li>
<li>TANGO_VERSION_MINOR</li>
<li>TANGO_VERSION_PATCH</li>
</ul>
<p>For instance, with Tango release 8.1.2, TANGO_VERSION_MAJOR will be
set to 8 while TANGO_VERSION_MINOR will be 1 and TANGO_VERSION_PATCH
will be 2.</p>
</div>
<div class="section" id="tango-specific-types">
<h3>Tango specific types<a class="headerlink" href="#tango-specific-types" title="Permalink to this headline">¶</a></h3>
<div class="section" id="operating-system-free-type">
<h4>Operating system free type<a class="headerlink" href="#operating-system-free-type" title="Permalink to this headline">¶</a></h4>
<p>Some data type used in the TANGO core software have been defined. They
are described in the following table.</p>
<table border="1" class="docutils">
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Type name</th>
<th class="head">C++ name</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>TangoSys_MemStream</td>
<td>stringstream</td>
</tr>
<tr class="row-odd"><td>TangoSys_OMemStream</td>
<td>ostringstream</td>
</tr>
<tr class="row-even"><td>TangoSys_Pid</td>
<td>int</td>
</tr>
<tr class="row-odd"><td>TangoSys_Cout</td>
<td>ostream</td>
</tr>
</tbody>
</table>
<p>These types are defined in the tango_config.h file</p>
</div>
<div class="section" id="template-command-model-related-type">
<h4>Template command model related type<a class="headerlink" href="#template-command-model-related-type" title="Permalink to this headline">¶</a></h4>
<p>As explained in [Command fact], command created with the template
command model uses static casting. Many type definition have been
written for these casting.</p>
<table border="1" class="docutils">
<colgroup>
<col width="33%" />
<col width="33%" />
<col width="33%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Class name</th>
<th class="head">Command allowed method (if any)</th>
<th class="head">Command execute method</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>TemplCommand</td>
<td>Tango::StateMethodPtr</td>
<td>Tango::CmdMethPtr</td>
</tr>
<tr class="row-odd"><td>TemplCommandIn</td>
<td>Tango::StateMethodPtr</td>
<td>Tango::CmdMethPtr_xxx</td>
</tr>
<tr class="row-even"><td>TemplCommandOut</td>
<td>Tango::StateMethodPtr</td>
<td>Tango::xxx_CmdMethPtr</td>
</tr>
<tr class="row-odd"><td>TemplCommandInOut</td>
<td>Tango::StateMethodPtr</td>
<td>Tango::xxx_CmdMethPtr_yyy</td>
</tr>
</tbody>
</table>
<p>The <strong>Tango::StateMethPtr</strong> is a pointer to a method of the DeviceImpl
class which returns a boolean and has one parameter which is a reference
to a const CORBA::Any obect.</p>
<p>The <strong>Tango::CmdMethPtr</strong> is a pointer to a method of the DeviceImpl
class which returns nothing and needs nothing as parameter.</p>
<p>The <strong>Tango::CmdMethPtr_xxx</strong> is a pointer to a method of the
DeviceImpl class which returns nothing and has one parameter. xxx must
be set according to the method parameter type as described in the next
table</p>
<table border="1" class="docutils">
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Tango type</th>
<th class="head">short cut (xxx)</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>Tango::DevBoolean</td>
<td>Bo</td>
</tr>
<tr class="row-odd"><td>Tango::DevShort</td>
<td>Sh</td>
</tr>
<tr class="row-even"><td>Tango::DevLong</td>
<td>Lg</td>
</tr>
<tr class="row-odd"><td>Tango::DevFloat</td>
<td>Fl</td>
</tr>
<tr class="row-even"><td>Tango::DevDouble</td>
<td>Db</td>
</tr>
<tr class="row-odd"><td>Tango::DevUshort</td>
<td>US</td>
</tr>
<tr class="row-even"><td>Tango::DevULong</td>
<td>UL</td>
</tr>
<tr class="row-odd"><td>Tango::DevString</td>
<td>Str</td>
</tr>
<tr class="row-even"><td>Tango::DevVarCharArray</td>
<td>ChA</td>
</tr>
<tr class="row-odd"><td>Tango::DevVarShortArray</td>
<td>ShA</td>
</tr>
<tr class="row-even"><td>Tango::DevVarLongArray</td>
<td>LgA</td>
</tr>
<tr class="row-odd"><td>Tango::DevVarFloatArray</td>
<td>FlA</td>
</tr>
<tr class="row-even"><td>Tango::DevVarDoubleArray</td>
<td>DbA</td>
</tr>
<tr class="row-odd"><td>Tango::DevVarUShortArray</td>
<td>USA</td>
</tr>
<tr class="row-even"><td>Tango::DevVarULongArray</td>
<td>ULA</td>
</tr>
<tr class="row-odd"><td>Tango::DevVarStringArray</td>
<td>StrA</td>
</tr>
<tr class="row-even"><td>Tango::DevVarLongStringArray</td>
<td>LSA</td>
</tr>
<tr class="row-odd"><td>Tango::DevVarDoubleStringArray</td>
<td>DSA</td>
</tr>
<tr class="row-even"><td>Tango::DevState</td>
<td>Sta</td>
</tr>
</tbody>
</table>
<p>For instance, a pointer to a method which takes a
Tango::DevVarStringArray as input parameter must be statically casted to
a Tango::CmdMethPtr_StrA, a pointer to a method which takes a
Tango::DevLong data as input parameter must be statically casted to a
Tango::CmdMethPtr_Lg.</p>
<p>The <strong>Tango::xxx_CmdMethPtr</strong> is a pointer to a method of the
DeviceImpl class which returns data of one of the Tango type and has no
input parameter. xxx must be set according to the method return data
type following the same rules than those described in the previous
table. For instance, a pointer to a method which returns a
Tango::DevDouble data must be statically casted to a
Tango::Db_CmdMethPtr.</p>
<p>The <strong>Tango::xxx_CmdMethPtr_yyy</strong> is a pointer to a method of the
DeviceImpl class which returns data of one of the Tango type and has one
input parameter of one of the Tango data type. xxx and yyy must be set
according to the method return data type and parameter type following
the same rules than those described in the previous table. For instance,
a pointer to a method which returns a Tango::DevDouble data and which
takes a Tango::DevVarLongStringArray must be statically casted to a
Tango::Db_CmdMethPtr_LSA.</p>
<p>All those type are defined in the tango_const.h file.</p>
</div>
</div>
<div class="section" id="tango-device-state-code">
<h3>Tango device state code<a class="headerlink" href="#tango-device-state-code" title="Permalink to this headline">¶</a></h3>
<p>The Tango::DevState type is a C++ enumeration starting at 0. The code
associated with each state is defined in the following table.</p>
<table border="1" class="docutils">
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">State name</th>
<th class="head">Value</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>Tango::ON</td>
<td>0</td>
</tr>
<tr class="row-odd"><td>Tango::OFF</td>
<td>1</td>
</tr>
<tr class="row-even"><td>Tango::CLOSE</td>
<td>2</td>
</tr>
<tr class="row-odd"><td>Tango::OPEN</td>
<td>3</td>
</tr>
<tr class="row-even"><td>Tango::INSERT</td>
<td>4</td>
</tr>
<tr class="row-odd"><td>Tango::EXTRACT</td>
<td>5</td>
</tr>
<tr class="row-even"><td>Tango::MOVING</td>
<td>6</td>
</tr>
<tr class="row-odd"><td>Tango::STANDBY</td>
<td>7</td>
</tr>
<tr class="row-even"><td>Tango::FAULT</td>
<td>8</td>
</tr>
<tr class="row-odd"><td>Tango::INIT</td>
<td>9</td>
</tr>
<tr class="row-even"><td>Tango::RUNNING</td>
<td>10</td>
</tr>
<tr class="row-odd"><td>Tango::ALARM</td>
<td>11</td>
</tr>
<tr class="row-even"><td>Tango::DISABLE</td>
<td>12</td>
</tr>
<tr class="row-odd"><td>Tango::UNKNOWN</td>
<td>13</td>
</tr>
</tbody>
</table>
<p>A strings array called <strong>Tango::DevStateName</strong> can be used to get the
device state as a string. Use the Tango device state code as index into
the array to get the correct string.</p>
</div>
<div class="section" id="tango-data-type">
<h3>Tango data type<a class="headerlink" href="#tango-data-type" title="Permalink to this headline">¶</a></h3>
<p>A “define” has been created for each Tango data type. This is summarized
in the following table</p>
<table border="1" class="docutils">
<colgroup>
<col width="33%" />
<col width="33%" />
<col width="33%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Type name</th>
<th class="head">Type code</th>
<th class="head">Value</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>Tango::DevBoolean</td>
<td>Tango::DEV_BOOLEAN</td>
<td>1</td>
</tr>
<tr class="row-odd"><td>Tango::DevShort</td>
<td>Tango::DEV_SHORT</td>
<td>2</td>
</tr>
<tr class="row-even"><td>Tango::DevLong</td>
<td>Tango::DEV_LONG</td>
<td>3</td>
</tr>
<tr class="row-odd"><td>Tango::DevFloat</td>
<td>Tango::DEV_FLOAT</td>
<td>4</td>
</tr>
<tr class="row-even"><td>Tango::DevDouble</td>
<td>Tango::DEV_DOUBLE</td>
<td>5</td>
</tr>
<tr class="row-odd"><td>Tango::DevUShort</td>
<td>Tango::DEV_USHORT</td>
<td>6</td>
</tr>
<tr class="row-even"><td>Tango::DevULong</td>
<td>Tango::DEV_ULONG</td>
<td>7</td>
</tr>
<tr class="row-odd"><td>Tango::DevString</td>
<td>Tango::DEV_STRING</td>
<td>8</td>
</tr>
<tr class="row-even"><td>Tango::DevVarCharArray</td>
<td>Tango::DEVVAR_CHARARRAY</td>
<td>9</td>
</tr>
<tr class="row-odd"><td>Tango::DevVarShortArray</td>
<td>Tango::DEVVAR_SHORTARRAY</td>
<td>10</td>
</tr>
<tr class="row-even"><td>Tango::DevVarLongArray</td>
<td>Tango::DEVVAR_LONGARRAY</td>
<td>11</td>
</tr>
<tr class="row-odd"><td>Tango::DevVarFloatArray</td>
<td>Tango::DEVVAR_FLOATARRAY</td>
<td>12</td>
</tr>
<tr class="row-even"><td>Tango::DevVarDoubleArray</td>
<td>Tango::DEVVAR_DOUBLEARRAY</td>
<td>13</td>
</tr>
<tr class="row-odd"><td>Tango::DevVarUShortArray</td>
<td>Tango::DEVVAR_USHORTARRAY</td>
<td>14</td>
</tr>
<tr class="row-even"><td>Tango::DevVarULongArray</td>
<td>Tango::DEVVAR_ULONGARRAY</td>
<td>15</td>
</tr>
<tr class="row-odd"><td>Tango::DevVarStringArray</td>
<td>Tango::DEVVAR_STRINGARRAY</td>
<td>16</td>
</tr>
<tr class="row-even"><td>Tango::DevVarLongStringArray</td>
<td>Tango::DEVVAR_LONGSTRINGARRAY</td>
<td>17</td>
</tr>
<tr class="row-odd"><td>Tango::DevVarDoubleStringArray</td>
<td>Tango::DEVVAR_DOUBLESTRINGARRAY</td>
<td>18</td>
</tr>
<tr class="row-even"><td>Tango::DevState</td>
<td>Tango::DEV_STATE</td>
<td>19</td>
</tr>
<tr class="row-odd"><td>Tango::ConstDevString</td>
<td>Tango::CONST_DEV_STRING</td>
<td>20</td>
</tr>
<tr class="row-even"><td>Tango::DevVarBooleanArray</td>
<td>Tango::DEVVAR_BOOLEANARRAY</td>
<td>21</td>
</tr>
<tr class="row-odd"><td>Tango::DevUChar</td>
<td>Tango::DEV_UCHAR</td>
<td>22</td>
</tr>
<tr class="row-even"><td>Tango::DevLong64</td>
<td>Tango::DEV_LONG64</td>
<td>23</td>
</tr>
<tr class="row-odd"><td>Tango::DevULong64</td>
<td>Tango::DEV_ULONG64</td>
<td>24</td>
</tr>
<tr class="row-even"><td>Tango::DevVarLong64Array</td>
<td>Tango::DEVVAR_LONG64ARRAY</td>
<td>25</td>
</tr>
<tr class="row-odd"><td>Tango::DevVarULong64Array</td>
<td>Tango::DEVVAR_ULONG64ARRAY</td>
<td>26</td>
</tr>
<tr class="row-even"><td>Tango::DevInt</td>
<td>Tango::DEV_INT</td>
<td>27</td>
</tr>
<tr class="row-odd"><td>Tango::DevEncoded</td>
<td>Tango::DEV_ENCODED</td>
<td>28</td>
</tr>
<tr class="row-even"><td>Tango::DevEnum</td>
<td>Tango::DEV_ENUM</td>
<td>29</td>
</tr>
<tr class="row-odd"><td>Tango::DevPipeBlob</td>
<td>Tango::DEV_PIPE_BLOB</td>
<td>30</td>
</tr>
<tr class="row-even"><td>Tango::DevVarStateArray</td>
<td>Tango::DEVVAR_STATEARRAY</td>
<td>31</td>
</tr>
</tbody>
</table>
<p>For command which do not take input parameter, the type code
Tango::DEV_VOID (value = 0) has been defined.</p>
<p>A strings array called <strong>Tango::CmdArgTypeName</strong> can be used to get the
data type as a string. Use the Tango data type code as index into the
array to get the correct string.</p>
</div>
<div class="section" id="tango-command-display-level">
<h3>Tango command display level<a class="headerlink" href="#tango-command-display-level" title="Permalink to this headline">¶</a></h3>
<p>Like attribute, Tango command has a display level. The Tango::DispLevel
type is a C++ enumeration starting at 0. The code associated with each
command display level is already described in page</p>
<p>As for attribute, this parameter allows a graphical application to
support two types of operation :</p>
<ul class="simple">
<li>An operator mode for day to day operation</li>
<li>An expert mode when tuning is necessary</li>
</ul>
<p>According to this parameter, a graphical application knows if the
command is for the operator mode or for the expert mode.</p>
</div>
</div>
<div class="section" id="device-server-process-option-and-environment-variables">
<h2>Device server process option and environment variables<a class="headerlink" href="#device-server-process-option-and-environment-variables" title="Permalink to this headline">¶</a></h2>
<div class="section" id="classical-device-server">
<h3>Classical device server<a class="headerlink" href="#classical-device-server" title="Permalink to this headline">¶</a></h3>
<p>The synopsis of a device server process is</p>
<p>ds_name instance_name [OPTIONS]</p>
<p>The supported options are :</p>
<ul>
<li><div class="first line-block">
<div class="line"><strong>-h, -? -help</strong></div>
<div class="line">Print the device server synopsis and a list of instance name
defined in the database for this device server. An instance name in
not mandatory in the command line to use this option</div>
</div>
</li>
<li><div class="first line-block">
<div class="line"><strong>-v[trace level]</strong></div>
<div class="line">Set the verbose level. If no trace level is given, a default value
of 4 is used</div>
</div>
</li>
<li><div class="first line-block">
<div class="line"><strong>-file=&lt;file name path&gt;</strong></div>
<div class="line">Start a device server using an ASCII file instead of the Tango
database.</div>
</div>
</li>
<li><div class="first line-block">
<div class="line"><strong>-nodb</strong></div>
<div class="line">Start a device server without using the database.</div>
</div>
</li>
<li><div class="first line-block">
<div class="line"><strong>-dlist &lt;device name list&gt;</strong></div>
<div class="line">Give the device name list. This option is supported only with the
-nodb option.</div>
</div>
</li>
<li><div class="first line-block">
<div class="line"><strong>ORB options</strong> (started with -ORBxxx)</div>
<div class="line">Options directly passed to the underlying ORB. Should be rarely
used except the -ORBendPoint option for device server not using the
database</div>
</div>
</li>
</ul>
</div>
<div class="section" id="device-server-process-as-windows-service">
<h3>Device server process as Windows service<a class="headerlink" href="#device-server-process-as-windows-service" title="Permalink to this headline">¶</a></h3>
<p>When used as a Windows service, a Tango device server supports several
new options. These options are :</p>
<ul>
<li><div class="first line-block">
<div class="line"><strong>-i</strong></div>
<div class="line">Install the service</div>
</div>
</li>
<li><div class="first line-block">
<div class="line"><strong>-s</strong></div>
<div class="line">Install the service and choose the automatic startup mode</div>
</div>
</li>
<li><div class="first line-block">
<div class="line"><strong>-u</strong></div>
<div class="line">Un-install the service</div>
</div>
</li>
<li><div class="first line-block">
<div class="line"><strong>-dbg</strong></div>
<div class="line">Run in console mode to debug service. The service must have been
installed prior to use it.</div>
</div>
</li>
</ul>
<p>Note that these options must be used after the device server instance
name.</p>
</div>
<div class="section" id="environment-variables">
<h3>Environment variables<a class="headerlink" href="#environment-variables" title="Permalink to this headline">¶</a></h3>
<p>A few environment variables can be used to tune a Tango control system.
TANGO_HOST is the most important one but on top it, some Tango features
like Tango logging service or controlled access (if used) can be tuned
using environment variable. If these environment variables are not
defined, the software searches in the file <strong>$HOME/.tangorc</strong> for its
value. If the file is not defined or if the environment variable is also
not defined in this file, the software searches in the file
<strong>/etc/tangorc</strong> for its value. For Windows, the file is
<strong>$TANGO_ROOT/tangorc</strong> TANGO_ROOT being the mandatory environment
variable of the Windows binary distribution.</p>
<div class="section" id="tango-host">
<h4>TANGO_HOST<a class="headerlink" href="#tango-host" title="Permalink to this headline">¶</a></h4>
<p>This environment variable is the anchor of the system. It specifies
where the Tango database server is running. Most of the time, its syntax
is</p>
<p>TANGO_HOST=&lt;host&gt;:&lt;port&gt;</p>
<p>host is the name of the computer where the database server is running
and port is th eport number on which it is litenning. If you want to
have a Tango control system which has several database servers (but only
one database) in order to survive a database server crashes, use the
following syntax</p>
<p>TANGO_HOST=&lt;host_1&gt;:&lt;port_1&gt;,&lt;host_2&gt;:&lt;port_2&gt;,&lt;host_3&gt;:&lt;port_3&gt;</p>
<p>Obviously, host_1 is the name of the computer where the first database
server is running, port_1 is the port number on which this server is
listenning. host_2 is the name of the computer where the second
database server is running and port_2 is its port number. All access to
database will automatically switch from one server to another one in the
list if the one which was used has died.</p>
</div>
<div class="section" id="tango-logging-service-tango-log-path">
<h4>Tango Logging Service (TANGO_LOG_PATH)<a class="headerlink" href="#tango-logging-service-tango-log-path" title="Permalink to this headline">¶</a></h4>
<p>The TANGO_LOG_PATH environment variable can be used to specify the log
files location. If not set it defaults to /tmp/tango-&lt;user logging name&gt;
under Unix and C:/tango-&lt;user logging name&gt; under Windows. For a given
device-server, the files are actually saved into $TANGO_LOG_PATH/{
server_name}/{ server_instance_name}. This means that all the devices
running within the same process log into the same directory.</p>
</div>
<div class="section" id="the-database-and-controlled-access-server-mysql-user-mysql-password-mysql-host-and-mysql-database">
<h4>The database and controlled access server (MYSQL_USER, MYSQL_PASSWORD, MYSQL_HOST and MYSQL_DATABASE)<a class="headerlink" href="#the-database-and-controlled-access-server-mysql-user-mysql-password-mysql-host-and-mysql-database" title="Permalink to this headline">¶</a></h4>
<p>The Tango database server and the controlled access server (if used)
need to connect to the MySQL database. They are using four environment
variables called MYSQL_USER, MYSQL_PASSWORD to know which
user/password they must use to access the database, MYSQL_HOST in case
the MySQL database is running on another host and MYSQL_DATABASE to
specify the name of the database to connect to. The MYSQL_HOST
environment variable allows you to specify the host and port number
where MySQL is running. Its syntax is</p>
<p>host:port</p>
<p>The port definition is optional. If it is not specified, the default
MySQL port will be used. If these environment variables are not defined,
they will connect to the DBMS using the root login on localhost with the
MySQL default port number (3306). The MYSQL_DATABASE environment
variable has to be used in case your are using the same Tango Database
device server executable code to connect to several Tango databases each
of them having a different name.</p>
</div>
<div class="section" id="the-controlled-access">
<h4>The controlled access<a class="headerlink" href="#the-controlled-access" title="Permalink to this headline">¶</a></h4>
<p>Even if a controlled access system is running, it is possible to by-pass
it if in the environment of the client application the environment
variable SUPER_TANGO is defined to true.</p>
</div>
<div class="section" id="the-event-buffer-size">
<h4>The event buffer size<a class="headerlink" href="#the-event-buffer-size" title="Permalink to this headline">¶</a></h4>
<p>If required, the event buffer used by the ZMQ software could be tuned
using environment variables. These variables are named
TANGO_DS_EVENT_BUFFER_HWM for the event buffer on a device server
side and TANGO_EVENT_BUFFER_HWM for the event buffer on the client
size. Both of them are a number which is the maximum number of events
which could be stored in these buffers.</p>
<table class="docutils footnote" frame="void" id="id7" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id5">[1]</a></td><td>Their black-box is also destroyed and re-built</td></tr>
</tbody>
</table>
</div>
</div>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../cpp-api/index.html" class="btn btn-neutral float-right" title="Tango Core C++ Classes Reference Documentation" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="IDL.html" class="btn btn-neutral" title="The TANGO IDL file : Module Tango" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, Tango Community, Creative Commons Attribution 4.0 International (CC BY 4.0).

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../',
            VERSION:'9.2.5',
            LANGUAGE:'en',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>